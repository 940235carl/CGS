<html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #info {
            position: absolute;
            top: 0px;
            width: 100%;
            padding: 10px;
            text-align: center;
            color: #ffff00
        }

        body {
            overflow: hidden;
        }

    </style>
</head>
<body>
<audio loop crossorigin="anonymous" id="walk" preload="auto" style="display: none">
		<source src="sound/No Party For Cao Dong [The Specter].mp3" type="audio/mpeg">
</audio>
<audio crossorigin="anonymous" id="monitor" preload="auto" style="display: none">
  <source src="sound/Put_down.ogg" type="audio/mpeg">
</audio>
<audio loop crossorigin="anonymous" id="Step" preload="auto" style="display: none">
  <source src="sound/Deep_steps.ogg" type="audio/mpeg">
</audio>
<audio loop crossorigin="anonymous" id="Step2" preload="auto" style="display: none">
  <source src="sound/Deep_steps.ogg" type="audio/mpeg">
</audio>
<audio loop crossorigin="anonymous" id="alert" preload="auto" style="display: none">
  <source src="sound/nationalalert.mp3" type="audio/mpeg">
</audio>
<audio crossorigin="anonymous" id="button" preload="auto" style="display: none">
  <source src="sound/BUTTON.mp3" type="audio/mpeg">
</audio>
<audio crossorigin="anonymous" id="error" preload="auto" style="display: none">
  <source src="sound/error.wav" type="audio/mpeg">
</audio>
<audio loop crossorigin="anonymous" id="envir" preload="auto" style="display: none">
  <source src="sound/Ennard BOSS.mp3" type="audio/mpeg">
</audio>
<audio crossorigin="anonymous" id="correct" preload="auto" style="display: none">
  <source src="sound/poka01.mp3" type="audio/mpeg">
</audio>
<audio crossorigin="anonymous" id="change" preload="auto" style="display: none">
  <source src="sound/changesound.mp3" type="audio/mpeg">
</audio>
<script src="https://jyunming-chen.github.io/tutsplus/js/KeyboardState.js"></script>
<script type=module>
    
    import * as THREE from 'https://raw.githack.com/mrdoob/three.js/dev/build/three.module.js';
    import { OrbitControls } from 'https://raw.githack.com/mrdoob/three.js/dev/examples/jsm/controls/OrbitControls.js';
    import { MTLLoader } from 'https://raw.githack.com/mrdoob/three.js/dev/examples/jsm/loaders/MTLLoader.js';
    import { OBJLoader } from 'https://raw.githack.com/mrdoob/three.js/dev/examples/jsm/loaders/OBJLoader.js';
    import { DDSLoader } from 'https://raw.githack.com/mrdoob/three.js/master/examples/jsm/loaders/DDSLoader.js';
    import { Gyroscope } from 'https://raw.githack.com/mrdoob/three.js/dev/examples/jsm/misc/Gyroscope.js';
    import { PositionalAudioHelper } from 'https://raw.githack.com/mrdoob/three.js/dev/examples/jsm/helpers/PositionalAudioHelper.js';

    var Islocal = 1; ///圖片路徑  1 = 路徑     else = imgur

    var keyboard = new KeyboardState();
    var camera, camera2, scene, sceneHUD, renderer, cameraHUD, sceneRTT, renderTarget;
    var leftdoor, rightdoor, windowdoor;
    var Rleftdoor, Rrightdoor, Rwindowdoor;
    var wallheight = 100,  windowsize = 40;
    var lightstate1 = 0,  lightstate2 = 0,  lightstate3 = 0;
    var light1, light11, light12, light2, light21, light22, light3;
    var Rlight1, Rlight11, Rlight12, Rlight2, Rlight21, Rlight22, Rlight3;
    var rightwallstate = 1,  leftwallstate = 1,  windowdoorstate = 1;
    var mouse = new THREE.Vector2();
    var raycaster = new THREE.Raycaster();
    var rightlightpickables = [],  leftlightpickables = [],  rightdoorpickables = [],  leftdoorpickables = [],  windowdoorpickables = [],  windowlightpickables = [],  camerapickables = [],
      rightmappickables = [],  leftmappickables = [], cam1pickables = [], cam2pickables = [], cam3pickables = [], cam4pickables = [], cam5pickables = [];
    var num0pickables = [],num1pickables = [], num2pickables = [], num3pickables = [], num4pickables = [], num5pickables = [], num6pickables = [], num7pickables = [], num8pickables = [], num9pickables = [];
    var numaction, numaction2, numflag = 0, alert = 0, numstr = [], numcount, num30action0, num30action1, num30action2, num30action3, num30action4, num30action5, num30action6, num30action7, num30action8, num30action9;
    var num30erroraction0, num30erroraction1, num30erroraction2, num30erroraction3, num30erroraction4, num30erroraction5, num30erroraction6, num30erroraction7, num30erroraction8, num30erroraction9;
    var rotationy = 0, viewpoint = 1;
    var quickswitch = 0,  switchflag = 0;
    var test = new THREE.Vector3(0, 0, 0);
    var headvector = new THREE.Vector3(0, 0, 0);
    var playervector = new THREE.Vector3(0, 0, 0);
    var breturndegree = new THREE.Vector3(0, 0, 0);
    var returndegree = new THREE.Vector3(10, 0, 0);
    var hudmap, outcameraflag = 0, car, Rcar;
    var dininglight, stagelight, kitchenlight, storeroomlight, restroomlight, counterlight, roomlight;
    var Rdininglight, Rstagelight, Rkitchenlight, Rstoreroomlight, Rrestroomlight, Rcounterlight, Rroomlight;
    var Progressnow, progresstimesum = 0;
    var cameraauto = 0 , cameraautoflag = 0;
    var camerabox, camerastick, mapaction, CAM = 6, progresstext1, progresstext2, progresstext3, starttext, startflag = 1, isranged = 0, keyboarding = 0, gamestart = 0, progressline, controling = 0, standup = 1, undertable = 0, canentertable = 0, iscanceled = 0;
    var condict=0;
    var numchance, successflag = 0;
    var movingstep=1, block=1,mov=0, rdoor=false,ldoor=false,movcor=0,wdoor=false; // ghost moving variable

		var controls, stats, clock, ghost, ghost2, gui, t = 0, t2 = 0,t3 = 0, gControl, steps, keys = [], backkeys = [] ,intkey = [], backintkey = [], move, buildMove;//鬼
		var T = 0.7, T2= 4.0,T3= 0.3,ready = 0; 
		var clock = new THREE.Clock(),playerclock = new THREE.Clock(),backclock = new THREE.Clock(),jcclock = new THREE.Clock();
    var progressclock
		var ts = clock.getElapsedTime(), ts2 = clock.getElapsedTime(),ts3 = clock.getElapsedTime();
    var headflag = 0,playerpositionbox, playerT = 448/112, playerintKey = [], playerintKey2 = [], playerintKey3 = [], jckeys = [], jcintkey = [] , playerlarm, playerrarm, playerts = clock.getElapsedTime(), playerstate = 0, canceltext, cancelingtext;
    var thebox,sound,audioElement,helper,thebox2,helper2,sound2,Step,Step2,alerts,sound3,monitors,button,error,envir,correct,change;//soundbox
    playerclock = new THREE.Clock();

		var on=0;
    var meshMaterial;
    var obs = [];
    var obsize = 0;
    /////////////////  local to world
    var mainz=new THREE.Vector3(0,0,0),mainx=new THREE.Vector3(0,0,0),mainy=new THREE.Vector3(0,0,0);

    /////////////////////// semaphone
    var gyro,fin=0,ran=0,infloor,com=0,release=0,stop=0,inclose=0,keyflag=1,look=0,open=0,catchs=0,goin=0;
    var rotest,asdd;/////////// random number

    //////////////////////////// alert box
    var cylinder,box,angle=0,spotlight,group,bool=0,beam,group2;
    
    ///////////////////// agent
    var agent,targets;
		var length = 12, width = 8;
		var shape = new THREE.Shape();
		shape.moveTo( 0,0 );
		shape.lineTo( 0, width );
		shape.lineTo( length, width );
		shape.lineTo( length, 0 );
		shape.lineTo( 0, 0 );


    class Obstacle {
    constructor (center,size) {
      this.center = center.clone();  
      this.mesh = new THREE.Mesh (new THREE.CylinderGeometry(size,size,25,32),
        new THREE.MeshBasicMaterial());
      this.mesh.position.copy (center);
      this.size = size;
      scene.add (this.mesh)
      //console.log(this.center);
    }
    
  }

		var extrudeSettings = {
			steps: 2,
			depth: 10,
			bevelEnabled: true,
			bevelThickness: 1,
			bevelSize: 1,
			bevelOffset: -4,
			bevelSegments: 1
		};
		

    var jcpose3={
				
				jcbodyRotate: 0.1317,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -0.7778,
				jcrightHand2X: 0.001,
        jcrightHandZ: -0.1492,
				jcrightHand2Z: 0.301,
        jcleftHandX: -0.7778,
				jcleftHand2X: 0.001,
        jcleftHandZ: 0.1492,
				jcleftHand2Z: -0.001,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.7645
		}
		
		var jcpose4={
				
				jcbodyRotate: 0.2838,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -0.7778,
				jcrightHand2X: 0.001,
        jcrightHandZ: -0.2833,
				jcrightHand2Z: 0.001,
        jcleftHandX: -0.7778,
				jcleftHand2X: -0.501,
        jcleftHandZ: 0.2833,
				jcleftHand2Z: -0.001,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.4645
		}
		
		var jcpose5={
				
				jcbodyRotate: 0.3279,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -0.7778,
				jcrightHand2X: -0.5834,
        jcrightHandZ: -0.5852,
				jcrightHand2Z: 0.701,
        jcleftHandX: -0.7778,
				jcleftHand2X: -0.5834,
        jcleftHandZ: 0.5852,
				jcleftHand2Z: -0.701,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.5645
		}
		
		var jcpose6={
				
				jcbodyRotate: 0.4200,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -1.1864,
				jcrightHand2X: -0.7834,
        jcrightHandZ: -0.5852,
				jcrightHand2Z: 0.901,
        jcleftHandX: -1.1864,
				jcleftHand2X: -0.5834,
        jcleftHandZ: 0.5852,
				jcleftHand2Z: -0.901,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.7645
		}
		
		var jcpose7={
				
				jcbodyRotate: 0.4200,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -0.6864,
				jcrightHand2X: -0.5834,
        jcrightHandZ: -0.4852,
				jcrightHand2Z: 1.001,
        jcleftHandX: -0.6864,
				jcleftHand2X: -0.7834,
        jcleftHandZ: 0.4852,
				jcleftHand2Z: -1.001,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.5645
		}
		
		var jcpose8={
				
				jcbodyRotate: 0.4200,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -1.1864,
				jcrightHand2X: -0.3834,
        jcrightHandZ: -0.3852,
				jcrightHand2Z: 1.001,
        jcleftHandX: -1.164,
				jcleftHand2X: -0.8834,
        jcleftHandZ: 0.3852,
				jcleftHand2Z: -1.001,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.7645
		}
		
		var jcpose9={
				
				jcbodyRotate: 0.4200,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -0.5864,
				jcrightHand2X: -0.8834,
        jcrightHandZ: -0.2852,
				jcrightHand2Z: 1.001,
        jcleftHandX: -0.5864,
				jcleftHand2X: -0.9834,
        jcleftHandZ: 0.2852,
				jcleftHand2Z: -1.001,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.5645
		}
		
		var jcpose10={
				
				jcbodyRotate: 0.4200,
        jcbodyHeight: 0.001,
        jcbodyRotateY: 1.1191,
				jcrightHandX: -0.8864,
				jcrightHand2X: -0.8834,
        jcrightHandZ: -0.3852,
				jcrightHand2Z: 1.001,
        jcleftHandX: -0.8864,
				jcleftHand2X: -0.9834,
        jcleftHandZ: 0.3852,
				jcleftHand2Z: -1.001,
        jcrightLegX: 0.001,
				jcrightLeg2X: 0.001,
        jcrightLegZ: 0.001,
				jcrightLeg2Z: 0.001,
        jcleftLegX: 0.001,
				jcleftLeg2X: 0.001,
        jcleftLegZ: 0.001,
				jcleftLeg2Z: 0.001,
				jchead2:1.7645
		}
		
		var pose3={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: -0.1876,
      rightHand2X: -1.1864,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.1302,
      leftHand2X: -0.8217,
      leftHandZ: 0.908,
      leftHand2Z: 0.001,
      rightLegX: -0.5054,
      rightLeg2X: 0.221,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: 0.1302,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose4={
				
      bodyRotate: 0.001,
			bodyRotate: 0.001,
			bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.0394,
      rightHand2X: -1.1864,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.1102,
      leftHand2X: -1.1864,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.5054,
      rightLeg2X: 0.3572,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: 0.1302,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose5={
				
    bodyRotate: 0.001,
    bodyRotate: 0.001,
    bodyHeight: 0.001,
    bodyRotateY: 0.001,
    rightHandX: 0.0594,
    rightHand2X: -1.1864,
    rightHandZ: -0.7529,
    rightHand2Z: 0.001,
    leftHandX: 0.0902,
    leftHand2X: -1.1864,
    leftHandZ: 0.7529,
    leftHand2Z: 0.001,
    rightLegX: -0.26,
    rightLeg2X: 0.4026,
    rightLegZ: 0.001,
    rightLeg2Z: 0.001,
    leftLegX: 0.1302,
    leftLeg2X: 0.001,
    leftLegZ: 0.001,
    leftLeg2Z: 0.001,
    head2: 1.5375,
    head3: 0.001
		
		}
		
		var pose6={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.0794,
      rightHand2X: -1.141,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.0702,
      leftHand2X: -1.1864,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.06,
      rightLeg2X: 0.4026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: 0.1302,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose7={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 1.008,
      bodyRotateY: 0.001,
      rightHandX: 0.0994,
      rightHand2X: -1.121,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: -0.1867,
      leftHand2X: -1.1864,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.06,
      rightLeg2X: 0.4026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: -0.433,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001
		}
		
		var pose8={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.1194,
      rightHand2X: -1.101,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.0702,
      leftHand2X: -1.1864,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.06,
      rightLeg2X: 0.2026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: -0.633,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose9={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.0994,
      rightHand2X: -1.101,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.0902,
      leftHand2X: -1.026,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.16,
      rightLeg2X: 0.2026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: -0.7054,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose10={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.0794,
      rightHand2X: -1.101,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.902,
      leftHand2X: -1.026,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.26,
      rightLeg2X: 0.2026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: -0.56,
      leftLeg2X: 0.221,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose11={
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.0594,
      rightHand2X: -1.121,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.1102,
      leftHand2X: -0.926,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.36,
      rightLeg2X: 0.2026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: -0.36,
      leftLeg2X: 0.4572,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose12={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 0.001,
      bodyRotateY: 0.001,
      rightHandX: 0.0394,
      rightHand2X: -1.141,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.1302,
      leftHand2X: -0.8,
      leftHandZ: 0.7529,
      leftHand2Z: 0.001,
      rightLegX: -0.46,
      rightLeg2X: 0.2026,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: -0.26,
      leftLeg2X: 0.5026,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001

		}
		
		var pose13={
				
      bodyRotate: 0.001,
      bodyRotate: 0.001,
      bodyHeight: 1.008,
      bodyRotateY: 0.001,
      rightHandX: -0.1876,
      rightHand2X: -1.1864,
      rightHandZ: -0.7529,
      rightHand2Z: 0.001,
      leftHandX: 0.1302,
      leftHand2X: -0.8217,
      leftHandZ: 0.908,
      leftHand2Z: 0.001,
      rightLegX: -0.5054,
      rightLeg2X: 0.221,
      rightLegZ: 0.001,
      rightLeg2Z: 0.001,
      leftLegX: 0.1302,
      leftLeg2X: 0.001,
      leftLegZ: 0.001,
      leftLeg2Z: 0.001,
      head2: 1.5375,
      head3: 0.001
		}
	
		
		var backpose3={

      backbodyRotate: 0.001,
      backbodyHeight: 1.008,
      backbodyRotateY: 0.001,
      backrightHandX: -0.3692,
      backrightHand2X: -0.8232,
      backrightHandZ: -0.6187,
      backrightHand2Z: 0.001,
      backleftHandX: -0.1422,
      backleftHand2X: -1.0601,
      backleftHandZ: 0.7264,
      backleftHand2Z: 0.001,
      backrightLegX: -0.46,
      backrightLeg2X: 0.3118,
      backrightLegZ: -0.1492,
      backrightLeg2Z: 0.001,
      backleftLegX: 0.0394,
      backleftLeg2X: 0.0636,
      backleftLegZ: 0.0681,
      backleftLeg2Z: 0.001,
      backhead2: 1.5375,
			backhead3: 0.8
		
		}
		
		var backpose4={
      backbodyRotate: 0.001,
      backbodyHeight: 1.008,
      backbodyRotateY: 0.001,
      backrightHandX: -0.3692,
      backrightHand2X: -0.8232,
      backrightHandZ: -0.6187,
      backrightHand2Z: 0.001,
      backleftHandX: -0.1422,
      backleftHand2X: -1.0601,
      backleftHandZ: 0.7264,
      backleftHand2Z: 0.001,
      backrightLegX: -0.46,
      backrightLeg2X: 0.3118,
      backrightLegZ: -0.1492,
      backrightLeg2Z: 0.001,
      backleftLegX: 0.0394,
      backleftLeg2X: 0.0636,
      backleftLegZ: 0.0681,
      backleftLeg2Z: 0.001,
      backhead2: 1.5375,
			backhead3: 0.001
		
		}
		
		var backpose5={
      backbodyRotate: 0.001,
      backbodyHeight: 1.008,
      backbodyRotateY: 0.001,
      backrightHandX: -0.3692,
      backrightHand2X: -0.8232,
      backrightHandZ: -0.6187,
      backrightHand2Z: 0.001,
      backleftHandX: -0.1422,
      backleftHand2X: -1.0601,
      backleftHandZ: 0.7264,
      backleftHand2Z: 0.001,
      backrightLegX: -0.46,
      backrightLeg2X: 0.3118,
      backrightLegZ: -0.1492,
      backrightLeg2Z: 0.001,
      backleftLegX: 0.0394,
      backleftLeg2X: 0.0636,
      backleftLegZ: 0.0681,
      backleftLeg2Z: 0.001,
      backhead2: 1.5375,
			backhead3: -0.8
		}
		/*
		var backpose6={
      backbodyRotate: 0.001,
      backbodyHeight: 1.008,
      backbodyRotateY: 0.001,
      backrightHandX: -0.3692,
      backrightHand2X: -0.8232,
      backrightHandZ: -0.6187,
      backrightHand2Z: 0.001,
      backleftHandX: -0.1422,
      backleftHand2X: -1.0601,
      backleftHandZ: 0.7264,
      backleftHand2Z: 0.001,
      backrightLegX: -0.46,
      backrightLeg2X: 0.3118,
      backrightLegZ: -0.1492,
      backrightLeg2Z: 0.001,
      backleftLegX: 0.0394,
      backleftLeg2X: 0.0636,
      backleftLegZ: 0.0681,
      backleftLeg2Z: 0.001,
      backhead2: 1.5375,
      backhead3: -0.4131
		
		}
    */
    /*
    var backpose7={
      backbodyRotate: 0.001,
      backbodyHeight: 1.008,
      backbodyRotateY: 0.001,
      backrightHandX: -0.3692,
      backrightHand2X: -0.8232,
      backrightHandZ: -0.6187,
      backrightHand2Z: 0.001,
      backleftHandX: -0.1422,
      backleftHand2X: -1.0601,
      backleftHandZ: 0.7264,
      backleftHand2Z: 0.001,
      backrightLegX: -0.46,
      backrightLeg2X: 0.3118,
      backrightLegZ: -0.1492,
      backrightLeg2Z: 0.001,
      backleftLegX: 0.0394,
      backleftLeg2X: 0.0636,
      backleftLegZ: 0.0681,
      backleftLeg2Z: 0.001,
      backhead2: 1.5375,
      backhead3: -1.4
    }
		*/
		
		
		var keys = [
			//[0.45, pose0],
			//[0.65, pose1],
			//[0.0, pose2],
			[0.15, pose3],
			[0.22, pose4],
			[0.29, pose5],
			[0.36, pose6],
			[0.43, pose7],
			[0.50, pose8],
			[0.57, pose9],
			[0.64, pose10],
			[0.71, pose11],
			[0.78, pose12],
			[0.85, pose13],
			[1, pose13]
		];
		
		var backkeys = [
      [0.001, backpose3],
      [0.3, backpose4],
      [0.7, backpose5],
      [1, backpose3]
    ];
    
    var jckeys = [
			//[0.45, pose0],
			//[0.65, pose1],
			//[0.0, pose2],
			[0.35, jcpose3],
			[0.45, jcpose4],
			[0.55, jcpose5],
			[0.65, jcpose6],
			[0.75, jcpose7],
			[0.85, jcpose8],
			[0.95, jcpose9],
			[1, jcpose10]
		];

    class Ghost{
            constructor(gg,texture,RTT,pos) {
                    
            this.ghostin=0.0;
            this.time=0.0;
            this.mov;
            
            this.ghost = new THREE.Object3D();
                    
            this.body = new THREE.Object3D();
            this.body.position.set(0,52,0);
            this.body.add(new THREE.Mesh(new THREE.CylinderGeometry(3.5, 3.5, 34, 10),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg));
            
            this.body2= new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 15, 10),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.body2.position.set(0,1,0);
            this.body2.rotation.z=20.44;
            
            this.body4= new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 15, 10),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.body4.position.set(0,-4,0);
            this.body4.rotation.z=20.44;
            
            this.body5= new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 15, 10),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.body5.position.set(0,-10,0);
            this.body5.rotation.z=20.44;
            
            this.body6= new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 26, 10),gg);
            this.body6.position.set(0,5,0);
            this.body6.rotation.z=20.44;
            

            
            this.body3= new THREE.Mesh(new THREE.BoxGeometry( 10, 5, 22 ),gg);
            this.body3.position.set(0,-20,0);
            this.body3.rotation.y=20.5;
          
                    this.ring= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring.position.set(0.3,-1,0);
            this.ring.rotation.x=20.4;
            
            this.ring2= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring2.position.set(0.3,-4.5,0);
            this.ring2.rotation.x=20.4;
            
            this.ring3= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring3.position.set(0.3,-2,0);
            this.ring3.rotation.x=20.4;
            
            this.ring4= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring4.position.set(0.3,-5.5,0);
            this.ring4.rotation.x=20.4;
            
            this.ring5= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring5.position.set(0.3,-9,0);
            this.ring5.rotation.x=20.4;
            
            this.ring6= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring6.position.set(-0.3,-1,0);
            this.ring6.rotation.x=20.4;
            
            this.ring7= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring7.position.set(-0.3,-4.5,0);
            this.ring7.rotation.x=20.4;
            
            this.ring8= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring8.position.set(-0.3,-2,0);
            this.ring8.rotation.x=20.4;
            
            this.ring9= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring9.position.set(-0.3,-5.5,0);
            this.ring9.rotation.x=20.4;
            
            this.ring10= new THREE.Mesh(new THREE.TorusGeometry( 3.5, 1, 16, 100 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.ring10.position.set(-0.3,-9,0);
            this.ring10.rotation.x=20.4;
            
            this.foot = new THREE.Mesh(new THREE.BoxGeometry( 10.2, 4, 13 ),gg);
                    this.foot.position.set(0.5,-9.4,0);
            //this.foot.rotation.x=6.5;
            this.foot.rotation.y=9.6;
            
            this.foot2 = new THREE.Mesh(new THREE.BoxGeometry( 10.2, 4, 13 ),gg);
                    this.foot2.position.set(-0.5,-9.4,0);
            //this.foot.rotation.x=6.5;
            this.foot2.rotation.y=15.7;
            
            this.palm = new THREE.Mesh(new THREE.BoxGeometry( 6, 5, 10 ),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.palm.position.set(0.5,-12,1.-1);
            
            this.palm2 = new THREE.Mesh(new THREE.BoxGeometry( 6, 5, 10 ),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.palm2.position.set(0.5,-12,1.-1);
            
            
            this.toe = new THREE.Mesh(new THREE.CylinderGeometry(2.3, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.toe.position.set(-1.6,-10,8);
            this.toe.rotation.x=-7.8;
            this.toe.rotation.y=-6.8;
            
            this.toe2 = new THREE.Mesh(new THREE.CylinderGeometry(2.3, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.toe2.position.set(1.5,-10,8);
            this.toe2.rotation.x=-7.8;
            this.toe2.rotation.z=-6.1;
            
            this.toe3 = new THREE.Mesh(new THREE.CylinderGeometry(2.3, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.toe3.position.set(5,-10,8);
            this.toe3.rotation.x=-7.8;
            this.toe3.rotation.z=-6;
            
            this.toe4 = new THREE.Mesh(new THREE.CylinderGeometry(2.3, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.toe4.position.set(-3.5,-10,8);
            this.toe4.rotation.x=-7.8;
            this.toe4.rotation.y=-6.8;
            
            this.toe5 = new THREE.Mesh(new THREE.CylinderGeometry(2.3, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.toe5.position.set(0,-10,8);
            this.toe5.rotation.x=-7.8;
            this.toe5.rotation.z=-6.3;
            
            this.toe6 = new THREE.Mesh(new THREE.CylinderGeometry(2.3, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
                    this.toe6.position.set(2.9,-10,8);
            this.toe6.rotation.x=-7.8;
            this.toe6.rotation.z=-6.2;
            
            
            
            this.head = new THREE.Mesh(new THREE.SphereGeometry(11, 24, 8, 6, 4.5, 0, 3.1),gg);
            this.head.position.set(0,5,0);
            this.head.rotation.x=-78.4;
            //this.head.rotation.y=-55;
            this.head.rotation.z=-29.8;
            //this.head.rotation.y=-18;
            
            this.head2 = new THREE.Mesh(new THREE.SphereGeometry(12, 24, 8, 6, 2.9, 0, 3.1),gg);
            this.head2.position.set(0,5,3);
            this.head2.rotation.x=-80;
            //this.head.rotation.y=-55;
            this.head2.rotation.z=-29.8;
            
            this.head3 = new THREE.Mesh(new THREE.CylinderGeometry( 4, 4, 1, 32 ),gg);
            this.head3.position.set(0,11,0);
            //this.head3.rotation.x=10;
            
            this.eye1 = new THREE.Mesh(new THREE.CylinderGeometry(1, 1, 6, 8), new THREE.MeshBasicMaterial ({color:'red'}),gg);
            this.eye1.position.set(6.8,7,5);
            this.eye1.rotation.x=20.5;
            
            this.eye2 = new THREE.Mesh(new THREE.CylinderGeometry(1, 1, 6, 8),new THREE.MeshBasicMaterial ({color:'red'}),gg);
            this.eye2.position.set(-6,7,5);
            this.eye2.rotation.x=20.5;
            
            this.eye3 = new THREE.Mesh(new THREE.CylinderGeometry(3, 2, 6, 8),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.eye3.position.set(6.8,7,4);
            this.eye3.rotation.x=20.5;
            
            this.eye4 = new THREE.Mesh(new THREE.CylinderGeometry(3, 2, 6, 8),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.eye4.position.set(-6,7,4);
            this.eye4.rotation.x=20.5;
            
            this.bone = new THREE.Mesh(new THREE.BoxGeometry( 13, 4, 4 ),new THREE.MeshPhongMaterial({map:texture,color:'#2d3138'}),gg);
            this.bone.position.set(0.5,7,2);
            this.bone.rotation.x=20.5;
            
            
            this.ear1 = new THREE.Mesh(new THREE.ExtrudeGeometry( shape, extrudeSettings ),gg);
            this.ear1.position.set(-1,15,1);
            this.ear1.rotation.x=11;
            this.ear1.rotation.y=0.4;
                    
            this.ear2 = new THREE.Mesh(new THREE.ExtrudeGeometry( shape, extrudeSettings ),gg);
            this.ear2.position.set(-9,10,1);
            this.ear2.rotation.x=11;
            this.ear2.rotation.y=-6.8;
            
            this.ear3 = new THREE.Mesh(new THREE.ExtrudeGeometry( shape, extrudeSettings ),gg);
            this.ear3.position.set(2,19,-3);
            this.ear3.rotation.x=-6;
            this.ear3.rotation.y=-6;

            
            this.ear4 = new THREE.Mesh(new THREE.ExtrudeGeometry( shape, extrudeSettings ),gg);
            this.ear4.position.set(-16,19,-3);
            this.ear4.rotation.x=-6;
            this.ear4.rotation.y=-6.3;
            
            
            //this.nose = new THREE.Mesh(new THREE.ConeGeometry( 5, 10, 5 ),gg);
            //this.nose.position.set(0.5,19,11);
            //this.nose.rotation.x=8;
            
            //this.lip= new THREE.Mesh(new THREE.BoxGeometry( 10, 3, 6 ),gg);
            //this.lip.position.set(1,15,12);
            
            //this.lip2= new THREE.Mesh(new THREE.BoxGeometry( 10, 3, 6 ),gg);
            //this.lip2.position.set(1,9,11);
            
            
            this.teeth= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth.position.set(6.5,1,5);
            //this.teeth.rotation.y=-8.7;

            
            this.teeth2= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth2.position.set(3,-1,9);
            //this.teeth2.rotation.y=-9.2;
            
            this.teeth3= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth3.position.set(-2,-1,9);
            
            this.teeth4= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth4.position.set(-6,0.5,5.5);
            

            this.teeth5= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth5.position.set(-8.5,0.5,7);
            
            this.teeth6= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth6.position.set(-5,-0.5,10);
            
            this.teeth7= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth7.position.set(0.5,-0.5,11);
            
            this.teeth8= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth8.position.set(6,0.5,10);
            
            this.teeth9= new THREE.Mesh(new THREE.CylinderGeometry(0.5, 1, 2, 6),new THREE.MeshPhongMaterial({color:'#fafbfc'}),gg);
            this.teeth9.position.set(9,1.4,7);
            
            
            this.finger = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger.position.set(-4,-15,1.5);
            
            this.finger2 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger2.position.set(1,-15,-4);

            this.finger3 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger3.position.set(4,-15,0);
            
            this.finger4 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger4.position.set(1,-15,4);
            
            
            this.finger5 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger5.position.set(4,-15,1.5);
            
            this.finger6 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger6.position.set(-1,-15,-4);

            this.finger7 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger7.position.set(-4,-15,0);
            
            this.finger8 = new THREE.Mesh(new THREE.CylinderGeometry(2, 1, 6, 32),new THREE.MeshPhongMaterial({map:texture,color:'#747d8f'}),gg);
            this.finger8.position.set(-1,-15,4);
            
            
            
            
            this.rightLeg = new THREE.Object3D();
            this.rightLeg.position.set(-7,-22,0);

            let rightLegMesh = new THREE.Mesh(new THREE.CylinderGeometry(4.5, 3, 13, 32),gg);
            rightLegMesh.position.set(0,-5.0,0);
            this.rightLeg.add(rightLegMesh);
          ////////////////////////////////////////////////////
            this.rightLeg2 = new THREE.Object3D();
            this.rightLeg2.position.set(0,-13.0,0);

            let rightLegMesh2 = new THREE.Mesh(new THREE.CylinderGeometry(3, 4.5, 13, 32),gg);
            rightLegMesh2.position.set(0,-5.0,0);
            this.rightLeg2.add(rightLegMesh2);




            this.leftLeg = new THREE.Object3D();
            this.leftLeg.position.set(7,-22,0);

            let leftLegMesh = new THREE.Mesh(new THREE.CylinderGeometry(4.5, 3, 13, 32),gg);
            leftLegMesh.position.set(0,-5.0,0);
            this.leftLeg.add(leftLegMesh);
          /////////////////////////////////////////////////////
            this.leftLeg2 = new THREE.Object3D();
            this.leftLeg2.position.set(0,-13.0,0);

            let leftLegMesh2 = new THREE.Mesh(new THREE.CylinderGeometry(3, 4.5, 13, 32),gg);
            leftLegMesh2.position.set(0,-5.0,0);
            this.leftLeg2.add(leftLegMesh2);
            

            this.leftHand = new THREE.Object3D();
            this.leftHand.position.set(12,5,0);


            let leftHandMesh = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 13, 32),gg);     
            //leftHandMesh.position.set(0,0,0);
            this.leftHand.add(leftHandMesh);
          
          /////////////////////////////////////////////////////
            this.leftHand2 = new THREE.Object3D();
            this.leftHand2.position.set(0,-6.5,0);

            let leftHandMesh2 = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 13, 32),gg);
            leftHandMesh2.position.set(0,-6.5,0);
            this.leftHand2.add(leftHandMesh2);
      
      
            this.rightHand = new THREE.Object3D();
            this.rightHand.position.set(-12,5,0);

            let rightHandMesh = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 13, 32),gg);
            //rightHandMesh.position.set(0,0,0);
            this.rightHand.add(rightHandMesh);
            
            //////////////////////////////////////////////////
            this.rightHand2 = new THREE.Object3D();
            this.rightHand2.position.set(0,-6.5,0);

            let rightHandMesh2 = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 13, 32),gg);
            rightHandMesh2.position.set(0,-6.5,0);
            this.rightHand2.add(rightHandMesh2);

            var loader = new THREE.TextureLoader();
            if(Islocal != 1) var map = loader.load("https://i.imgur.com/5JmiXFo.jpg");
            else map = loader.load('beam.jpg');
            this.beam = new THREE.Mesh(new THREE.CylinderGeometry(3,30,100,20),new THREE.MeshBasicMaterial({transparent:true, opacity: 0.2, color: '#eb3131', map: map}));
            this.beam.position.set(6.8,10,55);
            this.beam.rotation.x=-20.5;

            /////////////////////// LIGHT
            this.light = new THREE.SpotLight(0xeb3131,1,500,Math.PI/3,0.21,2);
            this.light.position.set(0,21,-10);
            this.light.target = this.beam;

            /////////////////////////////////////////////
            this.beam2 = new THREE.Mesh(new THREE.CylinderGeometry(3,30,100,20),new THREE.MeshBasicMaterial({transparent:true, opacity: 0.2, color: '#eb3131', map: map}));
            this.beam2.position.set(-6,10,55);
            this.beam2.rotation.x=-20.5;

            //////////////////////// LIGHT
            this.light2 = new THREE.SpotLight(0xeb3131,1,500,Math.PI/3,0.21,2);
            this.light2.position.set(this.beam2.position.x,this.beam.position.y,this.beam.position.z-70);
            this.light2.target = this.beam2;

            this.body.add(this.palm,this.palm2,this.head, this.rightLeg,this.rightLeg2, this.leftLeg,this.leftLeg2, this.leftHand,this.leftHand2, this.rightHand, this.rightHand2, this.ear1, this.ear2,this.finger,this.finger2,this.finger3,this.finger4,this.finger5, this.finger6, this.finger7, this.finger8,this.body2,this.body3,this.teeth,this.eye1,this.eye2,this.body4,this.body5,this.body6,this.ring,this.ring2,this.ring3,this.ring4,this.ring5,this.ring6,this.ring7,this.ring8,this.ring9,this.ring10,this.head2,this.head3,this.teeth,this.teeth2,this.teeth3,this.teeth4,this.teeth5,this.teeth6,this.teeth7,this.teeth8,this.teeth9,this.ear3,this.ear4,this.bone,this.foot,this.foot2,this.toe,this.toe2,this.toe3,this.toe4,this.toe5,this.toe6,this.eye3,this.eye4,this.palm);
            this.leftHand.add(this.leftHand2,this.ring,this.ring2);
            this.rightHand.add(this.rightHand2,this.ring6,this.ring7);
            this.leftLeg.add(this.leftLeg2,this.foot,this.toe,this.toe2,this.toe3);
            this.leftLeg2.add(this.foot,this.toe,this.toe2,this.toe3);
            this.rightLeg.add(this.rightLeg2,this.foot2,this.toe4,this.toe5,this.toe6);
            this.rightLeg2.add(this.foot2,this.toe4,this.toe5,this.toe6);
            
			      this.head3.add(this.bone,this.head,this.head2,this.eye1,this.eye2,this.eye3,this.eye4,this.ear1,this.ear2,this.ear3,this.ear4,this.teeth,this.teeth2,this.teeth3,this.teeth4,this.teeth5,this.teeth6,this.teeth7,this.teeth8,this.teeth9,this.beam,this.beam2,this.light,this.light2);
            
            this.ghost.add(this.body);

            //this.body6.add(this.leftHand);
            
            this.leftHand2.add(this.finger, this.finger2, this.finger3, this.finger4,this.ring3,this.ring4,this.ring5,this.palm);
            this.rightHand2.add(this.finger5, this.finger6, this.finger7, this.finger8,this.ring8,this.ring9,this.ring10,this.palm2);
            
            //this.lip.add(this.teeth,this.teeth2,this.teeth3,this.teeth4);
            //this.lip2.add(this.teeth5,this.teeth6,this.teeth7,this.teeth8);

            if(RTT == 0) scene.add(this.ghost);
            else sceneRTT.add(this.ghost);
        
            this.pos = pos;
            this.vel = new THREE.Vector3();
            this.force = new THREE.Vector3();
            this.target = new THREE.Vector3();
            this.size = 3;  // half width
            this.MAXSPEED = 60;
            this.ARRIVAL_R = 30;
            // for orientable agent
            this.angle = Math.PI/2;
      }

      setpos(x,y,z){
        this.pos.x = x;
        this.pos.y = y;
        this.pos.z = z;
      }

      getbodyY(){
        return this.body.position.y;
      }

      changebodyY(xy){
          this.body.position.y=xy;
      }

      changebodyY2(xy){
          this.body.position.y+=xy;
      }

      rotationY(y){
        this.body.rotation.y+=y;
        if(this.body.rotation.y>(Math.PI*2)) this.body.rotation.y-=(Math.PI*2);
        //console.log(this.body.rotation.y);
        //if(this.body.rotation.y>3.14) this.body.rotation.y%=3.14;
      }

      rotationX(x){
        this.body.rotation.y-=x;
        if(this.body.rotation.y<0.0) this.body.rotation.y+=(Math.PI*2);
        //console.log(this.body.rotation.y);
        /*
        if(this.body.rotation.y<-3.14){
          this.body.rotation.y%=3.14;
        }*/
      }

      addgyro(gyro){
        this.ghost.add(gyro);
      }

      forward(z){
        this.ghost.position.x+=z;
      }

      getrotaY(){
        return this.body.rotation.y;
      }

      changerotationY(x){
        this.body.rotation.y=x;
      }

      getworld(x,y,z){
        return this.head3.localToWorld(new THREE.Vector3(x,y,z));
      }
      ////////////////////////// agent update

      update(dt) {
          //console.log(this.pos);
          this.accumulateForce();
         // this.vel.add(this.force.clone().multiplyScalar(dt));
            
          // collision
          let minD = 1e10;
          var gh;
          for(var i=0;i<obsize;i++){
            let d = this.pos.distanceTo(obs[i].center);
            if(d < minD){
              minD = d;
              gh = i;
              //console.log('i = '+ i );
            }
          }

          let vhat = this.vel.clone().normalize();
          let point = obs[gh].center.clone().sub (this.pos); // c-p
          let proj  = point.dot(vhat);
          const REACH = 60;
          const K = 5;
          if (proj > 0 && proj < REACH) {
            let perp = new THREE.Vector3();
            perp.subVectors (point, vhat.clone().setLength(proj));
            let overlap = obs[gh].size + this.size - perp.length();
            if (overlap > 0) {
              perp.setLength (K*overlap);
              perp.negate();
              this.force.add (perp);
              console.log ("hit:", perp);
            }
          }
          
          this.vel.add(this.force.clone().multiplyScalar(dt));

            
            // velocity modulation
            let diff = this.target.clone().sub(this.pos)
            let dst = diff.length();
            if (dst < this.ARRIVAL_R) {
              this.vel.setLength(dst);
            }
            
            
            this.pos.add(this.vel.clone().multiplyScalar(dt));
            this.ghost.position.copy(this.pos);
            this.body.lookAt(this.vel);
            // for orientable agent
            // non PD version
            if (this.vel.length() > 0.1) {
                this.angle = Math.atan2 (this.vel.x, this.vel.z);
                this.body.rotation.y = this.angle;
            }
        }
        setTarget(target) {
            this.target.copy(target);
        }
        targetInducedForce(targetPos) {
            return targetPos.clone().sub(this.pos).normalize().multiplyScalar(this.MAXSPEED).sub(this.vel);
        }

        accumulateForce() {
          // seek
           this.force.copy(this.targetInducedForce(this.target));
        }


    }




    var playerpose1 = {
      theta1: 1,
      theta2: 1.1
    }
    var playerpose2 = {
      theta1: 1.2,
      theta2: 1
    }
    var playerpose3 = {
      theta1: 0.9,
      theta2: 1.3
    }
    var playerpose4 = {
      theta1: 1.2,
      theta2: 1.1
    }
    var playerpose5 = {
      theta1: 1.4,
      theta2: 0.9
    }
    var playerpose6 = {
      theta1: 1,
      theta2: 1
    }
    var playerpose7 = {
      theta1: 0.9,
      theta2: 1.2
    }
    var playerpose8 = {
      theta1: 1.2,
      theta2: 1
    }
    var playerpose9 = {
      theta1: 1,
      theta2: 1
    }
    var playerpose10 = {
      theta1: 1,
      theta2: 1.2
    }


    var playerkeys = [

      [0, playerpose1],
      [0.1, playerpose2],
      [0.2, playerpose3],
      [0.3, playerpose4],
      [0.4, playerpose5],
      [0.5, playerpose6],
      [0.6, playerpose7],
      [0.7, playerpose8],
      [0.8,playerpose9],
      [0.9,playerpose10],
      [1, playerpose1]
      
    ];

    function playerkeyframe(playert) {
      var s = ((playert - playerts) % playerT) / playerT;

      for (var i = 1; i < playerkeys.length; i++) {
        if (playerkeys[i][0] > s) break;
      }
      // take i-1
      var ii = i - 1;
      var a = (s - playerkeys[ii][0]) / (playerkeys[ii + 1][0] - playerkeys[ii][0]);
      playerintKey = [playerkeys[ii][1].theta1 * (1 - a) + playerkeys[ii + 1][1].theta1 * a,
                playerkeys[ii][1].theta2 * (1 - a) + playerkeys[ii + 1][1].theta2 * a        
      ];

    }



    var playerpose21 = {
      theta1: 0,
      theta2: 0
    }
    var playerpose22 = {
      theta1: 1.3,
      theta2: -1.3
    }
    var playerpose23 = {
      theta1: 0,
      theta2: 0
    }
    var playerpose24 = {
      theta1: -1.3,
      theta2: 1.3
    }
    var playerpose25 = {
      theta1: 0,
      theta2: 0
    }
    var playerpose26 = {
      theta1: 1.3,
      theta2: -1.3
    }
    var playerpose27 = {
      theta1: 0,
      theta2: 0
    }
    var playerpose28 = {
      theta1: -1.3,
      theta2: 1.3
    }
    var playerpose29 = {
      theta1: 0,
      theta2: 0
    }


    var playerkeys2 = [

      [0, playerpose21],
      [0.125, playerpose22],
      [0.25, playerpose23],
      [0.375, playerpose24],
      [0.5, playerpose25],
      [0.675, playerpose26],
      [0.75, playerpose27],
      [0.875, playerpose28],
      [1, playerpose29]
      
    ];

    function playerkeyframe2(playert) {
      var s = ((playert - playerts) % playerT) / playerT;

      for (var i = 1; i < playerkeys2.length; i++) {
        if (playerkeys2[i][0] > s) break;
      }
      // take i-1
      var ii = i - 1;
      var a = (s - playerkeys2[ii][0]) / (playerkeys2[ii + 1][0] - playerkeys2[ii][0]);
      playerintKey2 = [playerkeys2[ii][1].theta1 * (1 - a) + playerkeys2[ii + 1][1].theta1 * a,
                playerkeys2[ii][1].theta2 * (1 - a) + playerkeys2[ii + 1][1].theta2 * a        
      ];

    }



    var playerpose31 = {
      theta1: 0,
      theta2: 0
    }
    var playerpose32 = {
      theta1: 0,
      theta2: 0
    }


    var playerkeys3 = [

      [0, playerpose31],
      [1, playerpose32],
    ];

    function playerkeyframe3(playert) {
      var s = ((playert - playerts) % playerT) / playerT;

      for (var i = 1; i < playerkeys3.length; i++) {
        if (playerkeys3[i][0] > s) break;
      }
      // take i-1
      var ii = i - 1;
      var a = (s - playerkeys3[ii][0]) / (playerkeys3[ii + 1][0] - playerkeys3[ii][0]);
      playerintKey3 = [playerkeys3[ii][1].theta1 * (1 - a) + playerkeys3[ii + 1][1].theta1 * a,
                playerkeys3[ii][1].theta2 * (1 - a) + playerkeys3[ii + 1][1].theta2 * a        
      ];

    }





      init();
      animate();






      function init() {


        scene = new THREE.Scene();
        clock = new THREE.Clock();
        ////////////////////// SOUND source
        Step2 = document.getElementById('Step2');
        Step = document.getElementById('Step');
        alerts = document.getElementById('alert');
        monitors =document.getElementById('monitor');
        button = document.getElementById('button');
        error = document.getElementById('error');
        envir = document.getElementById('envir');
        correct = document.getElementById('correct');
        change = document.getElementById('change');

        envir.volume = 0.1;
        envir.play();

        document.addEventListener("keydown", onDocumentKeyDown, false);
        renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x888888);
        document.body.appendChild(renderer.domElement);

        camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 2000);
        camera.position.y = 200;
        camera.position.z = 40;

        camera2 = new THREE.PerspectiveCamera(50,100/50,1,2000);
        //camera2.position.z = -500;
        camera2.position.y = -1000;
        //camera2.lookAt(0, 40, -540);

        sceneRTT = new THREE.Scene();
        
        renderTarget = new THREE.WebGLRenderTarget(
          1024, 1024, {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.NearestFilter,
            format: THREE.RGBFormat
          }
        );

			var texture = new THREE.TextureLoader().load("gh.jpg");
			texture.wrapS = THREE.RepeatWrapping;
			texture.wrapT = THREE.RepeatWrapping;
			texture.repeat.set( 4, 4 );
            
			
			makesteerbox();
			var mesh = new THREE.MeshPhongMaterial({map:texture,color:'#470fa8',side: THREE.DoubleSide}); 

      ghost = new Ghost(mesh,texture, 1,new THREE.Vector3(-165,0,-900));
      ghost2 = new Ghost(mesh,texture, 0,new THREE.Vector3(-500,0,-900));
    
      targets = new THREE.Mesh(new THREE.CircleGeometry(10,20),new THREE.MeshBasicMaterial({transparent:true}));
      targets.position.set(-150,0,-400);

      ghost.setTarget(targets.position);

			ghost.ghost.rotation.order = 'XYZ';

      ghost2.ghost.position.set(-500,0,-900);
      ghost.ghost.position.set(-45,0,-1050);
      ghost.changebodyY(95);
           
      ////////////////////////////// gyro
      /*
			gyro = new Gyroscope();
      gyro.add (camera);
      ghost.addgyro(gyro);
      */      

      let screenplane = new THREE.PlaneBufferGeometry(78, 38);
      let quad = new THREE.Mesh(screenplane,
        new THREE.MeshBasicMaterial({
        map: renderTarget.texture,
          side: THREE.DoubleSide
        }));
      scene.add(quad);

      quad.position.set(0,55,-89.9);



      cameraHUD = new THREE.OrthographicCamera(-10, 10, 10, -10, -10, 1600);
      cameraHUD.position.z = 1580;

      sceneHUD = new THREE.Scene();
      //camera.lookAt(0,200,-100);
      //////////////////OOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOrbit here////////////////////////////////////
      //let controls = new OrbitControls(camera, renderer.domElement);

      ////////////////////////////////////////////////////////////////
      //var gridXZ = new THREE.GridHelper(200, 20, 'red', 'white');
      //scene.add(gridXZ);
      dininglight = new THREE.PointLight(0xffffff, 1, 300);               /////300
      dininglight.position.set(-150, 100, -650);
      scene.add(dininglight);
      Rdininglight = new THREE.PointLight(0xffffff, 1, 300);             /////300
      Rdininglight.position.set(-150, 100, -650);
      sceneRTT.add(Rdininglight);
      

      stagelight = new THREE.PointLight(0xffffff, 1, 200);
      stagelight.position.set(-50, 100, -1000);
      scene.add(stagelight);
      Rstagelight = new THREE.PointLight(0xffffff, 1, 200);
      Rstagelight.position.set(-50, 100, -1000);
      sceneRTT.add(Rstagelight);
      
      kitchenlight = new THREE.PointLight(0xffffff, 1, 220);
      kitchenlight.position.set(-650, 100, -750);
      scene.add(kitchenlight);
      Rkitchenlight = new THREE.PointLight(0xffffff, 1, 220);
      Rkitchenlight.position.set(-650, 100, -750);
      sceneRTT.add(Rkitchenlight);

      storeroomlight = new THREE.PointLight(0xffffff, 1, 150);
      storeroomlight.position.set(-480, 100, -460);
      scene.add(storeroomlight);
      Rstoreroomlight = new THREE.PointLight(0xffffff, 1, 150);
      Rstoreroomlight.position.set(-480, 100, -460);
      sceneRTT.add(Rstoreroomlight);

      restroomlight = new THREE.PointLight(0xffffff, 1, 140);
      restroomlight.position.set(250, 100, -500);
      scene.add(restroomlight);
      Rrestroomlight = new THREE.PointLight(0xffffff, 1, 140);
      Rrestroomlight.position.set(250, 100, -500);
      sceneRTT.add(Rrestroomlight);

      counterlight = new THREE.PointLight(0xffffff, 1, 140);
      counterlight.position.set(370, 100, -820);
      scene.add(counterlight);
      Rcounterlight = new THREE.PointLight(0xffffff, 1, 140);
      Rcounterlight.position.set(370, 100, -820);
      sceneRTT.add(Rcounterlight);

      ///////////////////////////////////////////////////////  floor
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/DrvlmNW.jpg');
      else var texture = new THREE.TextureLoader().load('tex/woodenfloor.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });

      var geometry = new THREE.PlaneGeometry(205, 205, 32);
      var plane = new THREE.Mesh(geometry, texMat);
      plane.rotation.x = -Math.PI / 2;
      scene.add(plane);
      var Rplane = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rplane);
      Rplane.rotation.x = -Math.PI / 2;
      //upfloor
      


      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/DrvlmNW.jpg');
      else var texture = new THREE.TextureLoader().load('tex/upfloor.jpeg');

      texture.repeat.set(2, 2);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;

      var plane = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane.rotation.x = +Math.PI / 2;
      scene.add(plane);
      plane.position.set(0,100,0);
      /////////////////////////////////////////   light
      roomlight = new THREE.PointLight(0xffffff, 1, 150);         
      roomlight.position.set(0, 50, 0);                     /////150
      scene.add(roomlight);
      Rroomlight = new THREE.PointLight(0xffffff, 1, 150);
      Rroomlight.position.set(0, 50, 0);                    /////150
      sceneRTT.add(Rroomlight);
      /////right light
      light1 = new THREE.PointLight(0xffffff, 1, 65);
      light1.position.set(150, 50, -20);
      scene.add(light1);
      Rlight1 = new THREE.PointLight(0xffffff, 1, 65);
      Rlight1.position.set(150, 50, -20);
      sceneRTT.add(Rlight1);

      light11 = new THREE.PointLight(0xffffff, 1, 65);
      light11.position.set(150, 50, -140);
      scene.add(light11);
      Rlight11 = new THREE.PointLight(0xffffff, 1, 65);
      Rlight11.position.set(150, 50, -140);
      sceneRTT.add(Rlight11);

      light12 = new THREE.PointLight(0xffffff, 1, 65);
      light12.position.set(150, 50, -260);
      scene.add(light12);
      Rlight12 = new THREE.PointLight(0xffffff, 1, 65);
      Rlight12.position.set(150, 50, -260);
      sceneRTT.add(Rlight12);
      /////left light
      light2 = new THREE.PointLight(0xffffff, 1, 65);
      light2.position.set(-150, 50, -20);
      scene.add(light2);
      Rlight2 = new THREE.PointLight(0xffffff, 1, 65);
      Rlight2.position.set(-150, 50, -20);
      sceneRTT.add(Rlight2);

      light21 = new THREE.PointLight(0xffffff, 1, 65);
      light21.position.set(-150, 50, -140);
      scene.add(light21);
      Rlight21 = new THREE.PointLight(0xffffff, 1, 65);
      Rlight21.position.set(-150, 50, -140);
      sceneRTT.add(Rlight21);

      light22 = new THREE.PointLight(0xffffff, 1, 65);
      light22.position.set(-150, 50, -260);
      scene.add(light22);
      Rlight22 = new THREE.PointLight(0xffffff, 1, 65);
      Rlight22.position.set(-150, 50, -260);
      sceneRTT.add(Rlight22);
      /////window light
      light3 = new THREE.PointLight(0xffffff, 1, 1);
      light3.position.set(0, wallheight + windowsize / 2 + windowsize / 2 - 6, 100 + 25 / 2 + 5);
      scene.add(light3);
      Rlight3 = new THREE.PointLight(0xffffff, 1, 1);
      Rlight3.position.set(0, wallheight + windowsize / 2 + windowsize / 2 - 6, 100 + 25 / 2 + 5);
      sceneRTT.add(Rlight3);

      /////////////////////////////////////////////////////////////////
      /*var testlight = new THREE.PointLight(0xffffff, 1 , 2000);
      testlight.position.set(0, 50, 200);
      scene.add(testlight);*/

      var geometry = new THREE.BoxGeometry(200, wallheight , 5);
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/iU1gtzm.png');
      else var texture = new THREE.TextureLoader().load('tex/wall01.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      var initwall1 = new THREE.Mesh(geometry, texMat);
      initwall1.position.set(0, wallheight / 2 , 100);
      scene.add(initwall1);
      var Rinitwall1 = new THREE.Mesh(geometry, texMat);
      Rinitwall1.position.set(0, wallheight / 2 , 100);
      sceneRTT.add(Rinitwall1);
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/L6OkHzh.png');
      else var texture = new THREE.TextureLoader().load('tex/wall02.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var initwall2 = new THREE.Mesh(geometry, texMat);
      initwall2.position.set(0, wallheight / 2 - 10, -100);
      scene.add(initwall2);
      var Rinitwall2 = new THREE.Mesh(geometry, texMat);
      Rinitwall2.position.set(0, wallheight / 2 - 10, -100);
      sceneRTT.add(Rinitwall2);

      // set door size
      var doorsize = 40;
      makewall(doorsize, wallheight);
      openrightdoor();
      openleftdoor();

      
      maketable();

      ///var windowsize = 40;
      makewindow(wallheight, windowsize);
      openwindowdoor();

      //makebuttoms(wallheight, doorsize);

      ////view point
      document.addEventListener('mousemove', onDocumentMouseMove, false);
      //set camera to look front



      /////outside
      makeoutside();

      
      makeboxes();

      
  
      makediningroom();


      ///test OBJ
      
      //                modelname size  x   y   z  rotationx  y  z 
        readModel('plant', 40, 80, 20, 80, 0, 0, 0);
        readModel('plant', 40, -80, 20, 80, 0, 0.2, 0);
        readModel('Fridge', 70, -550, 35, -935, -Math.PI/2, 0, 0);
        readModel('Fridge', 70, -580, 35, -935, -Math.PI/2, 0, 0);
        readModel('Fridge', 70, -610, 35, -935, -Math.PI/2, 0, 0);
        readModel('528 Bucket', 20, -580, 8.1, -525, 0, 0, 0);
        readModel('Broom', 50, -584, 25, -505, 0, 0, 0);
        readModel('Empty box', 50, -564, 12, -455, 0, 0, 0);
        readModel('Empty box', 50, -564, 42, -385, 0, 0.7, 0);
        readModel('box', 30, -564, 15, -385, 0, -0.7, 0);
        readModel('Door_01', 100, -388, 50, -526, -Math.PI/2, 0, 0.4);
        readModel('Table_01', 80, 0, 16.5, 75, -Math.PI/2, 0, 0);
        //readModel('tmp', 30, -60, 26, -62, Math.PI/4 + 0.1, Math.PI/4 + 0.15, 0);


        RTTreadModel('plant', 40, 80, 20, 80, 0, 0, 0);
        RTTreadModel('plant', 40, -80, 20, 80, 0, 0.2, 0);
        RTTreadModel('Fridge', 70, -550, 35, -935, -Math.PI/2, 0, 0);
        RTTreadModel('Fridge', 70, -580, 35, -935, -Math.PI/2, 0, 0);
        RTTreadModel('Fridge', 70, -610, 35, -935, -Math.PI/2, 0, 0);
        RTTreadModel('528 Bucket', 20, -580, 8.1, -525, 0, 0, 0);
        RTTreadModel('Broom', 50, -584, 25, -505, 0, 0, 0);
        RTTreadModel('Empty box', 50, -564, 12, -455, 0, 0, 0);
        RTTreadModel('Empty box', 50, -564, 42, -385, 0, 0.7, 0);
        RTTreadModel('box', 30, -564, 15, -385, 0, -0.7, 0);
        RTTreadModel('Door_01', 100, -388, 50, -526, -Math.PI/2, 0, 0.4);
        RTTreadModel('Table_01', 80, 0, 16.5, 75, -Math.PI/2, 0, 0);

      makemap();

      
      
      camera.position.set(0,40,0);
      camera.lookAt(0, 40, -120);

      
      nineshit();

      
      var geometry = new THREE.BoxGeometry( 1, 1, 1 );
      var material = new THREE.MeshBasicMaterial( {color: 0xffffff} );
      playerpositionbox = new THREE.Mesh( geometry, material );

      var loader = new THREE.FontLoader();
      loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
        var text = 'Press "E" to start backup';
          var geometry = new THREE.TextGeometry(text, {
            font: font,
            size: 0.6,
            height: 0.01,
            curveSegments: 12
          });
                      

      var material = new THREE.MeshBasicMaterial({color: 0xffffff, side: THREE.DoubleSide});
      starttext = new THREE.Mesh( geometry, material );
      sceneHUD.add(starttext);
      starttext.position.set(200, 0, 100);
      })

      loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
        var text = 'Press "E" to cancel backup';
          var geometry = new THREE.TextGeometry(text, {
            font: font,
            size: 0.6,
            height: 0.01,
            curveSegments: 12
          });
                

      var material = new THREE.MeshBasicMaterial({color: 0xffffff, side: THREE.DoubleSide});
      canceltext = new THREE.Mesh( geometry, material );
      sceneHUD.add (canceltext);
      canceltext.position.set(200, 0, 100);
      })

      loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
        var text = 'Canceling';
          var geometry = new THREE.TextGeometry(text, {
            font: font,
            size: 0.6,
            height: 0.01,
            curveSegments: 12
          });
                

      var material = new THREE.MeshBasicMaterial({color: 0xffffff, side: THREE.DoubleSide});
      cancelingtext = new THREE.Mesh( geometry, material );
      sceneHUD.add(cancelingtext);
      cancelingtext.position.set(200, 0, 100);
      })
      

      playerlarm = makeArm();
      playerpositionbox.add (playerlarm);
      playerlarm.position.set (1.26*5+0.62*5, 7.57*5, 0);
      playerlarm.rotation.z = -Math.PI/2;
      ///////////////////////////
      playerrarm = makeArm();
      playerpositionbox.add (playerrarm);
      playerrarm.position.set (-(1.26*5+0.62*5), 7.57*5, 0);
      playerrarm.rotation.z = -Math.PI/2;

      playerlarm.rotation.order = 'ZYX';
      playerrarm.rotation.order = 'ZYX';

      scene.add( playerpositionbox );
      playerpositionbox.position.set(0,0,0);

      //////////////////////////////////////////////// create positional audio helper
      var listener = new THREE.AudioListener();
      listener.crossOrigin = "anonymous";
      camera.add(listener);

      
      sound = new THREE.PositionalAudio( listener );
      sound.setMediaElementSource( Step );
      sound.setRefDistance( 120 );
      sound.setDirectionalCone( 120, 270, 0.05 );

      //helper = new PositionalAudioHelper( sound, 10 );
      //sound.add(helper);
      
      var box = new THREE.BoxGeometry(1,1,1);
      thebox = new THREE.Mesh(box,new THREE.MeshNormalMaterial());
      thebox.rotation.y=-(Math.PI/2);

      thebox.add(sound);
      thebox.position.set(-100,40,-40);
      scene.add(thebox);
      //audioElement.play();

      sound2 = new THREE.PositionalAudio( listener );
      sound2.setMediaElementSource( Step2 );
      sound2.setRefDistance( 120 );
      sound2.setDirectionalCone( 120, 270, 0.05 );

      //helper2 = new PositionalAudioHelper( sound, 10 );
      //sound2.add(helper2);

      thebox2 = new THREE.Mesh(box,new THREE.MeshNormalMaterial());
      thebox2.rotation.y= Math.PI/2;
      thebox2.add(sound2);
      thebox2.position.set(100,40,-40);
      scene.add(thebox2);
      

      ////////////////////////////////////////// alert box
      var geometry = new THREE.CylinderGeometry(1.8,1.8,5,32);
      var material = new THREE.MeshBasicMaterial({color:'#eb347a',opacity:0.7,transparent:true});
      cylinder = new THREE.Mesh(geometry,material);
      //scene.add(box);
      
      var geometry2 = new THREE.BoxGeometry(1.5,1.5,1.5);
      var material = new THREE.MeshBasicMaterial({color:'#eb347a'});
      
      box = new THREE.Mesh(geometry2,material);
      
      spotlight = new THREE.SpotLight(0xeb347a,10,80);
      group = new THREE.Group();
      group.add(box,spotlight);
      
      cylinder.position.set(0,1,0);
      spotlight.position.set(0,2,-1);
      box.position.set(0,2.5,0);
      //spotlight.angle=Math.PI/2;
      
      var loader = new THREE.TextureLoader();
      var map = loader.load("https://i.imgur.com/5JmiXFo.jpg");

      beam = new THREE.Mesh (new THREE.CylinderGeometry(3,1,7, 20), new THREE.MeshBasicMaterial({transparent:true, opacity: 0.3, color: '#eb347a', map: map}));
      
      group.add(beam);
      beam.rotation.x=Math.PI/2;
      beam.position.set(0,2.5,4.5);
      //beam.lookAt(group);
      spotlight.target=beam;
      group.position.set(80,35,-80);
      //scene.add(group);
      
      var box2 = new THREE.Mesh(new THREE.CylinderGeometry(2.2,2.2,1,32),new THREE.MeshBasicMaterial({color:'black'}));
      box2.position.set(0,0.5,0);
      group2 = new THREE.Group();
      group2.add(cylinder,box2);
      group2.position.set(80,35,-80);
      scene.add(group2);

      sound3 = new THREE.PositionalAudio(listener);
      sound3.setMediaElementSource( alerts );
      sound3.setRefDistance( 80 );
      sound3.setDirectionalCone( 90, 180, 0.05 );

      group.add(sound3);
      //////////////////////////////////////////////////////////////
      /*
      camera2.position.y = 0;
      CAM = 2;
      var geometry = new THREE.BoxGeometry( 1, 1, 1 );
      var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
      camerabox = new THREE.Mesh( geometry, material );
      sceneRTT.add( camerabox );

      camerabox.add(camera2);
      camerabox.rotation.order ="YXZ"
      camerabox.rotation.y -= 1;
      camerabox.rotation.x -= 0.5;
      


      var geometry = new THREE.BoxGeometry( 1, 1, 1 );
      var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
      camerastick = new THREE.Mesh( geometry, material );
      sceneRTT.add( camerastick );

      camerastick.add(camerabox);


      camerastick.position.set(-320,100,-770);
      */

     
      
      renderer.autoClear = false;
      window.addEventListener('resize', onWindowResize, false);

      //document.addEventListener("keydown", onDocumentKeyDown, false);
      camera.lookAt(ghost.ghost.position);

    }


    /////////////////////////////////  ghost moving function


    function jumpscare(){
                
          var pos = camera.localToWorld(new THREE.Vector4(0,0,-40,0));
          ghost2.ghost.position.set(pos.x,pos.y,pos.z);	
          ready=1;
    }


    ////////////////////////////////////////////////////////////////////////////////////
    ////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////// animate
    function animate() {

      ////////// fin:用來解決rotation的互斥　condict:狀態(1:在舞台上 2:要下舞台 3:開始在餐廳遊走) 
      //infloor:十標點(十個點位) 1為剛下台判斷
      //(-400,-900) 2
      //(-400,-600) 3
      //(-200,-600) 4
      //(-200,-400) 5
      //(-150,-400) 6 //// important
      //( 150,-400) 7 //// important
      //( 230,-400) 9
      //( 230,-900) 8
      //(-400,-720) 10
      //(-200,-720) 11
      if(condict==1){
        //console.log(ghost.getrotaY());
        if(ghost.getrotaY()<1.49&&fin==0){
          ghost.rotationY(0.01);
        }
        else{
          fin=1;
          if(ghost.ghost.position.x>=65){
            if(ghost.getrotaY()>0.01) ghost.rotationX(0.01);
            else if(ghost.ghost.position.z<-1000) ghost.ghost.position.z+=0.2 ;
            else if(ghost.getbodyY()>50.0){
                ghost.changebodyY2(-0.2);
                ghost.ghost.position.z+=0.3;
            }
            else if(ghost.ghost.position.z<-900) ghost.ghost.position.z+=0.2 ;
            else{
              condict=3;
              fin=0;
              infloor=1;
              ghost.setpos(ghost.ghost.position.x,ghost.ghost.position.y,ghost.ghost.position.z);
            }
          }
          else{
            ghost.forward(2);
          }
        }

        if(alert==1){
          if(rotest>50){
              condict=4;
              ran=0;
              ghost.ghost.position.set(-150,0,-400);
              infloor=6;
              camerastick.position.set(0,-1,0);
          }
          else{
            condict=5;
            ran=0;
            ghost.ghost.position.set(150,0,-400);
            infloor=7;
            camerastick.position.set(0,-1,0);
          }
        }
      }
      else if(condict==2){
        //console.log(ghost.getrotaY());
        if((ghost.getrotaY()<0.1||ghost.getrotaY()>4.7)&&fin==0) ghost.rotationX(0.01);
        else{
            fin=1;
            if(ghost.ghost.position.x<=-165){
              if(ghost.getrotaY()<6.27) ghost.rotationY(0.01);
              else if(ghost.ghost.position.z<-1000) ghost.ghost.position.z+=0.5 ;
              else if(ghost.getbodyY()>50.0){
                  ghost.changebodyY2(-0.2);
                  ghost.ghost.position.z+=0.3;
              }
              else if(ghost.ghost.position.z<-900) ghost.ghost.position.z+=0.5 ;
              else{
                condict=3;
                fin=0;
                ghost.setpos(ghost.ghost.position.x,ghost.ghost.position.y,ghost.ghost.position.z);
                infloor=1;
              }
          }
          else{
            ghost.forward(-2);
          }
        }

        if(alert==1){
          if(rotest>50){
              condict=4;
              ran=0;
              ghost.ghost.position.set(-150,0,-400);
              infloor=6;
              camerastick.position.set(0,-1,0);
          }
          else{
            condict=5;
            ran=0;
            ghost.ghost.position.set(150,0,-400);
            infloor=7;
            camerastick.position.set(0,-1,0);
          }
        }
      }
      else if(condict==3){
        /////////////////////// agent
        ghost.update(0.01);
        if(targets.position.distanceTo(ghost.ghost.position) < 20 && (infloor==6||infloor==7)){
            if(infloor==6) condict=4;
            else if(infloor==7) condict=5;
        }
        else if(targets.position.distanceTo(ghost.ghost.position) < 20 && catchs==2){
          asdd = Math.random()*9+1;
          if(asdd<=5){
            targets.position.set(-150,0,-400);
            infloor=6;
            catchs=0;
          }
          else{
            targets.position.set(150,0,-400);
            infloor=7;
            catchs=0;
          }
        }
        else if(targets.position.distanceTo(ghost.ghost.position) < 20 && catchs<2){
          asdd = Math.random()*9+1;
          if(asdd<=1) targets.position.set(-400,0,-900);
          else if(asdd>1&&asdd<=2){
              targets.position.set(-400,0,-600);
              infloor=2;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          else if(asdd>2&&asdd<=3){
              targets.position.set(-200,0,-600);
              infloor=3;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          else if(asdd>3&&asdd<=4){
              targets.position.set(-200,0,-400);
              infloor=4;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          else if(asdd>4&&asdd<=5){ 
              targets.position.set(-150,0,-400);
              infloor=6;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          else if(asdd>5&&asdd<=6){ 
              targets.position.set(150,0,-400);
              infloor=7;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          else if(asdd>6&&asdd<=7){ 
              targets.position.set(230,0,-400);
              infloor=5;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          else if(asdd>7&&asdd<=8){ 
              targets.position.set(230,0,-900);
              infloor=8;
              if(catchs==0) catchs=1;
              else catchs=2;;
          }
          else{
              targets.position.set(-400,0,-720);
              infloor=9;
              if(catchs==0) catchs=1;
              else catchs=2;
          }
          ghost.setTarget(targets.position);
        }

        if(alert==1){
          if(rotest>50){
              condict=4;
              ran=0;
              ghost.ghost.position.set(-150,0,-400);
              camerastick.position.set(0,-1,0);
          }
          else{
            condict=5;
            ran=0;
            ghost.ghost.position.set(150,0,-400);
            release=0;
            camerastick.position.set(0,-1,0);
          }
        }
        
      }
      console.log(catchs);
      ////////////////////////////////// 10號點 (-150,400)  7號點 (150close
      if(condict==4){
        thebox.lookAt(ghost2.ghost.position.x,40,ghost2.ghost.position.z);
        thebox2.lookAt(100,40,-40);
        if(release==0){
            ghost2.ghost.position.set(-150,0,-400);
            ghost2.changerotationY(0.0);
            ghost2.changebodyY(45);
            release=1;
            Step.play();
            goin=1;
        }
          if((ghost2.getrotaY()>0.05&&ghost2.getrotaY()<6.25)&&com==0) {
            ghost.rotationX(0.02);
          }
          else if(ghost2.ghost.position.z<=-20){
            ghost.ghost.position.z+=1;
            ghost2.ghost.position.z+=1;
            thebox.rotation.y+=0.005;
            com=1;
          }
          else if((ghost2.getrotaY()>1.51||ghost2.getrotaY()<1.48)&&com==1){
            ghost.rotationY(0.02);
            ghost2.rotationY(0.02);
          }
          else if(ghost2.ghost.position.x<=-70.0){
            ghost.ghost.position.x+=1;
            ghost2.ghost.position.x+=1;
          }
          else{
            condict=6;
            com=0;
            thebox.lookAt(-100,40,-40);
            Step.pause();
            release=0;
          }  
      }
      else if(condict==5){
        //thebox2.lookAt(ghost2.ghost.position);
        thebox.lookAt(-100,40,-40);
        thebox2.lookAt(ghost2.ghost.position.x,40,ghost2.ghost.position.z);
        if(release==0){
            ghost2.ghost.position.set(150,0,-400);
            ghost2.changebodyY(45);
            ghost2.changerotationY(0.0);
            release=1;
            Step2.play();
            goin=2;
        }
        if(ghost2.getrotaY()>0.05&&ghost2.getrotaY()<6.25&&com==0){
            ghost.rotationY(0.02);
        }
        else if(ghost2.ghost.position.z<=-20){
            ghost.ghost.position.z+=1;
            ghost2.ghost.position.z+=1;
            //helper2.update();
            com=1;
        }
        else if((ghost2.getrotaY()<4.7||ghost2.getrotaY()>4.8)&&com==1){
            ghost.rotationX(0.02);
            ghost2.rotationX(0.02);
        }
        else if(ghost2.ghost.position.x>=70.0){
           ghost.ghost.position.x-=1;
           ghost2.ghost.position.x-=1;
        }
        else{
          condict=6;
          com=0;
          thebox2.lookAt(100,40,-40);
          Step2.pause();
          release=0;
        }          
      }
      ////////////////////////////////////////////////////////////////////// search people
      if(condict==6){
        if(inclose==0){
          setTimeout(closecheck,0);
          keyflag=2;   ////////// set keyframe
          inclose=1;   ////////// state select
        }
        else if(inclose==1){
          if(ghost2.ghost.position.x>0.0){
            mainy = ghost2.getworld(0,0,100);
            if(playerpositionbox.position.x >(mainy.x-80) &&playerpositionbox.position.z<mainy.z){
              //console.log('yesssss');
              //ghost2.head3.rotation.y=0.0;
              inclose=2;
            }
          }         
          else{
            mainy = ghost2.getworld(0,0,100);
            if(playerpositionbox.position.x <(mainy.x+80) &&playerpositionbox.position.z<mainy.z){
              //console.log('yesssss');
              inclose=2;
            }
          }
        }
        else if(inclose==2){
          //console.log('hello');
          keyflag=3;
        }
        else if(inclose==3){
          keyflag=1;
          if(ran==0){
            ran=1;
            rotest = Math.floor(Math.random()*100+1);
            if(goin==1) Step.play();
            else Step2.play();
          }
          if(rotest>50){
            if((ghost2.getrotaY()>1.51||ghost2.getrotaY()<1.48)&&com==0){
                ghost.rotationY(0.02);
                ghost2.rotationY(0.02);
            }
            else if(ghost2.ghost.position.x<=150){
              ghost.ghost.position.x+=1;
              ghost2.ghost.position.x+=1;
              com=1;
              if(playerpositionbox.position.z<40){
                 inclose=2;
              }
            }
            else if((ghost2.getrotaY()>3.16||ghost2.getrotaY()<3.05)){
              ghost.rotationY(0.02);
              ghost2.rotationY(0.02);
            }
            else if(ghost2.ghost.position.z>=-400){
              ghost.ghost.position.z-=1;
              ghost2.ghost.position.z-=1;
            }
            else{
              condict=3;
              infloor=0;
              ghost.setpos(ghost.ghost.position.x,0,ghost.ghost.position.z);
              com=0;
              ran=0;
              inclose=0;
              ghost2.ghost.position.set(300,300,300);
              Step.pause();
            }
          }
          else{
            if((ghost2.getrotaY()<4.7||ghost2.getrotaY()>4.8)&&com==0){
                ghost.rotationX(0.02);
                ghost2.rotationX(0.02);
            }
            else if(ghost2.ghost.position.x>=-150){
              ghost.ghost.position.x-=1;
              ghost2.ghost.position.x-=1;
              com=1;
              if(playerpositionbox.position.z<40){
                inclose=2;
              }
            }
            else if((ghost2.getrotaY()>3.14||ghost2.getrotaY()<3.05)){
              ghost.rotationX(0.02);
              ghost2.rotationX(0.02);
            }
            else if(ghost2.ghost.position.z>=-400){
              ghost.ghost.position.z-=1;
              ghost2.ghost.position.z-=1;
            }
            else{
              condict=3;
              ghost.setpos(ghost.ghost.position.x,0,ghost.ghost.position.z);
              infloor=0;
              com=0;
              ran=0;
              inclose=0;
              ghost2.ghost.position.set(300,300,300);
              Step2.pause();
            }
          }
        }
      }
      //console.log(playerpositionbox.position);
      //////////////////////////////////////// alert box
      angle = 0.2;
      if(alert==1){
        group.rotation.y+=angle;
        if(open==0){
            playalert();
            scene.add(group);
            open=1;
            setTimeout(changealert,10000);
        }
      }
      else{
        if(open==1){
            pausealert();
            scene.remove(group);
            open=0;
        }
      }

      //console.log(infloor);
      //console.log(condict);
      /////////////////////////////////////////////////////////////////////// set origin position
      requestAnimationFrame(animate);
      //render();
  
      if(gamestart == 1){
        if(Math.floor(progresstimesum * 10 / 36) != Progressnow && Progressnow <= 100){
          Progressnow = Math.floor(progresstimesum * 10 / 36);
          progress();
        }
      }
      if(stop == 0)camerarotation(rotationy);
      if(stop == 1 && numflag == 0 && Progressnow != 101){
        numchance = Math.random()*1000;
        if(numchance > 985 && numchance < 994){
          progressclock.stop();
          numflag = Math.floor(Math.random()*10+1);
          if(numflag == 1) numaction.position.set(-4.5, -2.25, 2.55);
          else if(numflag == 2) numaction.position.set(0, -2.25, 2.55);
          else if(numflag == 3) numaction.position.set(4.5, -2.25, 2.55);
          else if(numflag == 4) numaction.position.set(-4.5, 2.25, 2.55);
          else if(numflag == 5) numaction.position.set(0, 2.25, 2.55);
          else if(numflag == 6) numaction.position.set(4.5, 2.25, 2.55);
          else if(numflag == 7) numaction.position.set(-4.5, 6.75, 2.55);
          else if(numflag == 8) numaction.position.set(0, 6.75, 2.55);
          else if(numflag == 9) numaction.position.set(4.5, 6.75, 2.55);
          else if(numflag == 10) numaction.position.set(0, -6.75, 2.55);
        }
        else if(numchance > 994){
          numflag = Math.floor(Math.random()*10+11);
          if(numflag == 11) numaction2.position.set(-4.5, -2.25, 2.55);
          else if(numflag == 12) numaction2.position.set(0, -2.25, 2.55);
          else if(numflag == 13) numaction2.position.set(4.5, -2.25, 2.55);
          else if(numflag == 14) numaction2.position.set(-4.5, 2.25, 2.55);
          else if(numflag == 15) numaction2.position.set(0, 2.25, 2.55);
          else if(numflag == 16) numaction2.position.set(4.5, 2.25, 2.55);
          else if(numflag == 17) numaction2.position.set(-4.5, 6.75, 2.55);
          else if(numflag == 18) numaction2.position.set(0, 6.75, 2.55);
          else if(numflag == 19) numaction2.position.set(4.5, 6.75, 2.55);
          else if(numflag == 20) numaction2.position.set(0, -6.75, 2.55);
          setTimeout(numflagev,2000);
        }
        else if(numchance > 980 && numchance < 985){
          progressclock.stop();
          numflag = 30;
          numcount = 0;
          numstr[0] = (parseInt(Math.floor(Math.random()*10) / 1));
          numstr[1] = (parseInt(Math.floor(Math.random()*10) / 1));
          numstr[2] = (parseInt(Math.floor(Math.random()*10) / 1));
          numstr[3] = (parseInt(Math.floor(Math.random()*10) / 1));
          numstr[4] = (parseInt(Math.floor(Math.random()*10) / 1));


          var loader = new THREE.FontLoader();
          loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
          var text = "" + numstr[0] + "" + numstr[1] + "" + numstr[2] + "" + numstr[3] + "" + numstr[4]; 
            
          var geometry = new THREE.TextGeometry(text, {
            font: font,
            size: 3.9,
            height: 2.8,
            curveSegments: 12
          });
                  
          scene.remove(progresstext3);
          var material = new THREE.MeshBasicMaterial({color: 0xfc0303, side: THREE.DoubleSide});
          progresstext3 = new THREE.Mesh( geometry, material );
          scene.add( progresstext3 );
          progresstext3.position.set(-75, 37, -70);
          progresstext3.rotation.y += Math.PI/4;
          });
          
        }
      }
      if(numcount == 5){
        progressclock.start();
        correct.play();
        numflag = 0;
        num30action0.position.set(1005, 2.5, 0.1);
        num30action1.position.set(1005, 2.5, 0.1);
        num30action2.position.set(1005, 2.5, 0.1);
        num30action3.position.set(1005, 2.5, 0.1);
        num30action4.position.set(1005, 2.5, 0.1);
        num30action5.position.set(1005, 2.5, 0.1);
        num30action6.position.set(1005, 2.5, 0.1);
        num30action7.position.set(1005, 2.5, 0.1);
        num30action8.position.set(1005, 2.5, 0.1);
        num30action9.position.set(1005, 2.5, 0.1);
        numcount = 0;
        var loader = new THREE.FontLoader();
          loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
          var text = ""; 
            
          var geometry = new THREE.TextGeometry(text, {
            font: font,
            size: 3.9,
            height: 2.8,
            curveSegments: 12
          });
                  
          scene.remove(progresstext3);
          var material = new THREE.MeshBasicMaterial({color: 0xfc0303, side: THREE.DoubleSide});
          progresstext3 = new THREE.Mesh( geometry, material );
          scene.add( progresstext3 );
          progresstext3.position.set(-75, 37, -70);
          progresstext3.rotation.y += Math.PI/4;
          });
      }
      if(Progressnow == 101 && successflag == 0){
        successflag = 1;
        var loader = new THREE.FontLoader();
        loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
        var text = "SUCCESS"; 
            
        var geometry = new THREE.TextGeometry(text, {
          font: font,
          size: 3.9,
          height: 2.8,
          curveSegments: 12
        });
                  
        scene.remove(progresstext3);
        var material = new THREE.MeshBasicMaterial({color: 0x3db851, side: THREE.DoubleSide});
        progresstext3 = new THREE.Mesh( geometry, material );
        scene.add( progresstext3 );
        -78.2, 43, -66.8
        progresstext3.position.set(-77, 37, -68);
        progresstext3.rotation.y += Math.PI/4;
        });
      }
      var dt = clock.getDelta();
      update(dt);
      //windowflashing();
      //rightflashing();
      //leftflashing();
      cameraautorotation();
      //camera.lookAt(ghost.ghost.position);
      
      renderer.setClearColor(0x000000);
      renderer.setRenderTarget (renderTarget);
      renderer.clear(true);
      renderer.render(sceneRTT, camera2);
      renderer.setRenderTarget (null);
      renderer.clear(true);
      // render texture to screne
      renderer.setClearColor(0x888888);
      renderer.render(scene, camera);
      renderer.render(sceneHUD, cameraHUD);

      if(playerstate == 1){
        //playerkeyframe(playerclock.getElapsedTime());
        //playerlarm.rotation.y = playerintKey[0]
        //playerrarm.rotation.y = playerintKey[1]
      }
      else if(playerstate == 2){
        playerkeyframe2(playerclock.getElapsedTime());
        playerlarm.rotation.y = playerintKey2[0]
        playerrarm.rotation.y = playerintKey2[1]
      }
      else if(playerstate == 0){
        playerkeyframe3(playerclock.getElapsedTime());
        playerlarm.rotation.y = playerintKey3[0]
        playerrarm.rotation.y = playerintKey3[1]
      }
      if(keyboarding == 0) playerstate = 0;
      
      if(playerpositionbox.position.x <= -30 && camera.position.x >= -65 && startflag == 1){
        camera.getWorldDirection(playervector);
        if(playerpositionbox.position.z >= -45 && camera.position.z <= -30 && startflag == 1 && controling == 0 && standup == 1 && playervector.x < -0.534 && playervector.x > -0.7729 && playervector.z < -0.6344 && playervector.z > -0.8454 ){
          starttext.position.set(-4.5, -7, 100);
          isranged = 1;
        }   
        else{
          starttext.position.set(200, 0, 100);
          isranged = 0;
        }
      }
      else {
          starttext.position.set(200, 0, 100);
          isranged = 0;
      }
      if(playerpositionbox.position.x <= -30 && camera.position.x >= -65 && iscanceled == 1){
        if(playerpositionbox.position.z >= -45 && camera.position.z <= -30 && iscanceled == 1){
          cancelingtext.position.set(-2, -7, 100);
        }   
        else{
          cancelingtext.position.set(200, 0, 100);
        }
      }
      else {
        cancelingtext.position.set(200, 0, 100);
      }

      if(stop == 1 && numflag == 0 || stop == 1 && numflag > 10 && numflag < 30){
        progresstimesum += progressclock.getDelta()*10;
        //console.log("pgc = "+progressclock.getDelta());
        //console.log("progresstimesum = "+progresstimesum);
      }

      backkeyframe(backclock.getElapsedTime());

      t += clock.getDelta();
      t %= 30.6;
      keyframe(t);

      
    if(keyflag==1){
      ghost.rightHand.rotation.x = intkey[3];
      ghost2.rightHand.rotation.x = intkey[3];
      ghost.rightHand.rotation.z = intkey[4];
      ghost2.rightHand.rotation.z = intkey[4];
              
      ghost.rightHand2.rotation.x = intkey[5];
      ghost2.rightHand2.rotation.x = intkey[5];
      ghost.rightHand2.rotation.z = intkey[6];
      ghost2.rightHand2.rotation.z = intkey[6];
              
      ghost.leftHand.rotation.x = intkey[7];
      ghost2.leftHand.rotation.x = intkey[7];
      ghost.leftHand.rotation.z = intkey[8];
      ghost2.leftHand.rotation.z = intkey[8];
              
      ghost.leftHand2.rotation.x = intkey[9];
      ghost2.leftHand2.rotation.x = intkey[9];
      ghost.leftHand2.rotation.z = intkey[10];
      ghost2.leftHand2.rotation.z = intkey[10];
      
      ghost.rightLeg.rotation.x = intkey[11];
      ghost2.rightLeg.rotation.x = intkey[11];
      ghost.rightLeg.rotation.z = intkey[12];
      ghost2.rightLeg.rotation.z = intkey[12];
      
      ghost.rightLeg2.rotation.x = intkey[13];
      ghost2.rightLeg2.rotation.x = intkey[13];
      ghost.rightLeg2.rotation.z = intkey[14];
      ghost2.rightLeg2.rotation.z = intkey[14];
      
      ghost.leftLeg.rotation.x = intkey[15];
      ghost2.leftLeg.rotation.x = intkey[15];
      ghost.leftLeg.rotation.z = intkey[16];
      ghost2.leftLeg.rotation.z = intkey[16];
      
      ghost.leftLeg2.rotation.x = intkey[17];
      ghost2.leftLeg2.rotation.x = intkey[17];
      ghost.leftLeg2.rotation.z = intkey[18];
      ghost2.leftLeg2.rotation.z = intkey[18];

      ghost.head2.rotation.x = intkey[19];
      ghost2.head2.rotation.x = intkey[19];

      ghost.head3.rotation.y = intkey[20];
      ghost2.head3.rotation.y = intkey[20];
    }
    else if(keyflag==2){
      ghost.rightHand.rotation.x = backintkey[3];
      ghost2.rightHand.rotation.x = backintkey[3];
      ghost.rightHand.rotation.z = backintkey[4];
      ghost2.rightHand.rotation.z = backintkey[4];
              
      ghost.rightHand2.rotation.x = backintkey[5];
      ghost2.rightHand2.rotation.x = backintkey[5];
      ghost.rightHand2.rotation.z = backintkey[6];
      ghost2.rightHand2.rotation.z = backintkey[6];
              
      ghost.leftHand.rotation.x = backintkey[7];
      ghost2.leftHand.rotation.x = backintkey[7];
      ghost.leftHand.rotation.z = backintkey[8];
      ghost2.leftHand.rotation.z = backintkey[8];
              
      ghost.leftHand2.rotation.x = backintkey[9];
      ghost2.leftHand2.rotation.x = backintkey[9];
      ghost.leftHand2.rotation.z = backintkey[10];
      ghost2.leftHand2.rotation.z = backintkey[10];
      
      ghost.rightLeg.rotation.x = backintkey[11];
      ghost2.rightLeg.rotation.x = backintkey[11];
      ghost.rightLeg.rotation.z = backintkey[12];
      ghost2.rightLeg.rotation.z = backintkey[12];
      
      ghost.rightLeg2.rotation.x = backintkey[13];
      ghost2.rightLeg2.rotation.x = backintkey[13];
      ghost.rightLeg2.rotation.z = backintkey[14];
      ghost2.rightLeg2.rotation.z = backintkey[14];
      
      ghost.leftLeg.rotation.x = backintkey[15];
      ghost2.leftLeg.rotation.x = backintkey[15];
      ghost.leftLeg.rotation.z = backintkey[16];
      ghost2.leftLeg.rotation.z = backintkey[16];
      
      ghost.leftLeg2.rotation.x = backintkey[17];
      ghost2.leftLeg2.rotation.x = backintkey[17];
      ghost.leftLeg2.rotation.z = backintkey[18];
      ghost2.leftLeg2.rotation.z = backintkey[18];

      ghost.head2.rotation.x = backintkey[19];
      ghost2.head2.rotation.x = backintkey[19];

      ghost.head3.rotation.y = backintkey[20];
      ghost2.head3.rotation.y = backintkey[20];
    }
    else{
        t3 += jcclock.getDelta();
        t3 %= 30.6;
				jckeyframe(t3);

				ghost.ghost.rotation.x = jcintkey[0];
        ghost2.ghost.rotation.x = jcintkey[0];
        ghost.ghost.position.y = jcintkey[1]-5;
        ghost2.ghost.position.y = jcintkey[1]-5;
				
				ghost.ghost.rotation.y = jcintkey[2]+0.068;
        ghost2.ghost.rotation.y = jcintkey[2]+0.068;
	
        ghost.rightHand.rotation.x = jcintkey[3];
        ghost2.rightHand.rotation.x = jcintkey[3];
				ghost.rightHand.rotation.z = jcintkey[4];
        ghost2.rightHand.rotation.z = jcintkey[4];
				
				ghost.rightHand2.rotation.x = jcintkey[5];
        ghost2.rightHand2.rotation.x = jcintkey[5];
				ghost.rightHand2.rotation.z = jcintkey[6];
        ghost2.rightHand2.rotation.z = jcintkey[6];
				
				ghost.leftHand.rotation.x = jcintkey[7];
        ghost2.leftHand.rotation.x = jcintkey[7];
				ghost.leftHand.rotation.z = jcintkey[8];
        ghost2.leftHand.rotation.z = jcintkey[8];
				
				ghost.leftHand2.rotation.x = jcintkey[9];
        ghost2.leftHand2.rotation.x = jcintkey[9];
				ghost.leftHand2.rotation.z = jcintkey[10];
        ghost2.leftHand2.rotation.z = jcintkey[10];
				
				ghost.rightLeg.rotation.x = jcintkey[11];
        ghost2.rightLeg.rotation.x = jcintkey[11];
				ghost.rightLeg.rotation.z = jcintkey[12];
        ghost2.rightLeg.rotation.z = jcintkey[12];
				
				ghost.rightLeg2.rotation.x = jcintkey[13];
        ghost2.rightLeg2.rotation.x = jcintkey[13];
				ghost.rightLeg2.rotation.z = jcintkey[14];
        ghost2.rightLeg2.rotation.z = jcintkey[14];
				
				ghost.leftLeg.rotation.x = jcintkey[15];
        ghost2.leftLeg.rotation.x = jcintkey[15];
        ghost.leftLeg.rotation.z = jcintkey[16];
        ghost2.leftLeg.rotation.z = jcintkey[16];
				
				ghost.leftLeg2.rotation.x = jcintkey[17];
        ghost2.leftLeg2.rotation.x = jcintkey[17];
				ghost.leftLeg2.rotation.z = jcintkey[18];
        ghost2.leftLeg2.rotation.z = jcintkey[18];
				
				ghost.head2.rotation.x = jcintkey[19];
        ghost2.head2.rotation.x = jcintkey[19];
    }
    }


    //////////////////////////////////////////////////////////////////
    /////////////////////////////////////////////////////////////////////  animate end
    //////////////////////////////////////////////////////////////////

    ////////////////////////////////////// play alert
    function playalert(){
      alerts.play();
    }

    function pausealert(){
      alerts.pause();
    }

    function changealert(){
      alert = !alert;
    }

    ///////////////////////////////////// close check
    function closecheck(){
        if(ghost2.ghostin>6){
          ghost2.ghostin=0;
          inclose=3;
          clearTimeout(closecheck);
        }
        else{
          ghost2.ghostin++;
          setTimeout(closecheck,1000);
        }
        
        if(keyflag==3){
          jumpscare();
          clearTimeout(closecheck);
        }
        
    }


    function render() {
      renderer.clear(true);
      renderer.render(scene, camera);
      //renderer.render(sceneHUD, cameraHUD);
      camera.lookAt(ghost.ghost.position);
    }

    function progress(){
      var loader = new THREE.FontLoader();
      loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
        if(Math.floor(progresstimesum * 10 / 36) < 10){
          var text = "    " + Math.floor(progresstimesum * 10 / 36) + "%";
        }
        else if(Math.floor(progresstimesum * 10 / 36) < 100){
          var text = "  " + Math.floor(progresstimesum * 10 / 36) + "%";
        }
        else var text = '100%';
          var geometry = new THREE.TextGeometry(text, {
            font: font,
            size: 4,
            height: 2.8,
            curveSegments: 12
          });
                
      scene.remove(progresstext1);
      var material = new THREE.MeshBasicMaterial({color: 0x3db851, side: THREE.DoubleSide});
      progresstext1 = new THREE.Mesh( geometry, material );
      scene.add( progresstext1 );
      progresstext1.position.set(-75, 49, -70);
      progresstext1.rotation.y += Math.PI/4;
      });

      

      loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
      var text = "";
      if(Progressnow <= 100){
        for(var i = 0; i < Math.floor(Progressnow * 14 / 100); i++){
          text += "l";
        }
      }
      else text = "llllllllllllll";
      var geometry = new THREE.TextGeometry(text, {
        font: font,
        size: 3.9,
        height: 2.8,
        curveSegments: 12
      });
            
      scene.remove(progresstext2);
      var material = new THREE.MeshBasicMaterial({color: 0x3db851, side: THREE.DoubleSide});
      progresstext2 = new THREE.Mesh( geometry, material );
      scene.add( progresstext2 );
      progresstext2.position.set(-78.2, 43, -66.8);
      progresstext2.rotation.y += Math.PI/4;
      });



    }


    function cameraautorotation(){
      if(CAM == 1){
        if(cameraautoflag == 0){
          cameraauto -= 0.002;
          camerastick.rotation.y -= 0.002;
          if(cameraauto < -0.5) cameraautoflag = 1;
        }
        else if(cameraautoflag == 1){
          cameraauto += 0.002;
          camerastick.rotation.y += 0.002;
          if(cameraauto > 0.5) cameraautoflag = 0;
        }
      }
      else if(CAM == 2){
        if(cameraautoflag == 0){
          cameraauto -= 0.001;
          camerastick.rotation.y -= 0.001;
          if(cameraauto < 0) cameraautoflag = 1;
        }
        else if(cameraautoflag == 1){
          cameraauto += 0.001;
          camerastick.rotation.y += 0.001;
          if(cameraauto > 0.2) cameraautoflag = 0;
        }
      }
      else if(CAM == 3){
        if(cameraautoflag == 0){
          cameraauto -= 0.001;
          camerastick.rotation.y -= 0.001;
          if(cameraauto < -0.7) cameraautoflag = 1;
        }
        else if(cameraautoflag == 1){
          cameraauto += 0.001;
          camerastick.rotation.y += 0.001;
          if(cameraauto > 0) cameraautoflag = 0;
        }
      }
      else if(CAM == 4){
        if(cameraautoflag == 0){
          cameraauto -= 0.001;
          camerastick.rotation.y -= 0.001;
          if(cameraauto < -0.8) cameraautoflag = 1;
        }
        else if(cameraautoflag == 1){
          cameraauto += 0.001;
          camerastick.rotation.y += 0.001;
          if(cameraauto > 0) cameraautoflag = 0;
        }
      }
      else if(CAM == 5){
        if(cameraautoflag == 0){
          cameraauto -= 0.001;
          camerastick.rotation.y -= 0.001;
          if(cameraauto < -0.3) cameraautoflag = 1;
        }
        else if(cameraautoflag == 1){
          cameraauto += 0.001;
          camerastick.rotation.y += 0.001;
          if(cameraauto > 0) cameraautoflag = 0;
        }
      }
    }

    function keyframe(t) {
                
        var s = ((t - ts) % T) / T;

        for (var i = 1; i < keys.length; i++) {
          if (keys[i][0] > s) break;
        }

        var ii = i - 1;
        if(i === 6)i = 0;

        var a = (s - keys[ii][0]) / (keys[ii + 1][0] - keys[ii][0]);

        var one = ts+T;
    

        intkey=[ 
                    keys[ii][1].bodyRotate * (1 - a) + keys[ii + 1][1].bodyRotate * a,
                    keys[ii][1].bodyHeight * (1 - a) + keys[ii + 1][1].bodyHeight * a,
                    keys[ii][1].bodyRotateY * (1 - a) + keys[ii + 1][1].bodyRotateY * a,
                    
                    keys[ii][1].rightHandX * (1 - a) + keys[ii + 1][1].rightHandX * a,
                    keys[ii][1].rightHandZ * (1 - a) + keys[ii + 1][1].rightHandZ * a,
                /////////////////////////////////////////////////////////////////////////////////
                    keys[ii][1].rightHand2X * (1 - a) + keys[ii + 1][1].rightHand2X * a,
                    keys[ii][1].rightHand2Z * (1 - a) + keys[ii + 1][1].rightHand2Z * a,
                
                    keys[ii][1].leftHandX * (1 - a) + keys[ii + 1][1].leftHandX * a,
                    keys[ii][1].leftHandZ * (1 - a) + keys[ii + 1][1].leftHandZ * a,
                ////////////////////////////////////////////////////////////////////////////////
                    keys[ii][1].leftHand2X * (1 - a) + keys[ii + 1][1].leftHand2X * a,
                    keys[ii][1].leftHand2Z * (1 - a) + keys[ii + 1][1].leftHand2Z * a,
            
                    keys[ii][1].rightLegX * (1 - a) + keys[ii + 1][1].rightLegX * a,
                    keys[ii][1].rightLegZ * (1 - a) + keys[ii + 1][1].rightLegZ * a,
                ////////////////////////////////////////////////////////////////////////////////
                    keys[ii][1].rightLeg2X * (1 - a) + keys[ii + 1][1].rightLeg2X * a,
                    keys[ii][1].rightLeg2Z * (1 - a) + keys[ii + 1][1].rightLeg2Z * a,
                
                    keys[ii][1].leftLegX * (1 - a) + keys[ii + 1][1].leftLegX * a,
                    keys[ii][1].leftLegZ * (1 - a) + keys[ii + 1][1].leftLegZ * a,
                ////////////////////////////////////////////////////////////////////////////////
                    keys[ii][1].leftLeg2X * (1 - a) + keys[ii + 1][1].leftLeg2X * a,
                    keys[ii][1].leftLeg2Z * (1 - a) + keys[ii + 1][1].leftLeg2Z * a,
                    keys[ii][1].head2 * (1 - a) + keys[ii + 1][1].head2 * a,
                    keys[ii][1].head3 * (1 - a) + keys[ii + 1][1].head3 * a		
        ];
                    
          
      }

        function backkeyframe(t2) {
                
                    var s2 = ((t2 - ts2) % T2) / T2;

                    for (var i2 = 1; i2 < backkeys.length; i2++) {
              if (backkeys[i2][0] > s2) break;
            }

                    //console.log(i2);

                    var ii2 = i2 - 1;
                    if(i2 === 6)i2 = 0;

                    var a2 = (s2 - backkeys[ii2][0]) / (backkeys[ii2 + 1][0] - backkeys[ii2][0]);
            
            /*var one2 = ts2+T2;
                  if(t2>one2){
                    backintkey=[backkeys[ii2][1].backbodyRotate = 0.2879,
                                backkeys[ii2][1].backbodyHeight =0.001,
                                backkeys[ii2][1].backbodyRotateY =1.1191,
                                backkeys[ii2][1].backrightHandX =-1.1864,
                                backkeys[ii2][1].backrightHandZ=-0.5852,
                                backkeys[ii2][1].backrightHand2X =-0.5834,
                                backkeys[ii2][1].backrightHand2Z =0.001,
                                backkeys[ii2][1].backleftHandX =-1.1864,
                                backkeys[ii2][1].backleftHandZ=0.5852,
                                backkeys[ii2][1].backleftHand2X =-0.5834,
                                backkeys[ii2][1].backleftHand2Z =0.001,
                                backkeys[ii2][1].backrightLegX =0.001,
                                backkeys[ii2][1].backrightLegZ =0.001,
                                backkeys[ii2][1].backrightLeg2X =0.001,
                                backkeys[ii2][1].backrightLeg2Z =0.001,
                                backkeys[ii2][1].backleftLegX =0.001,
                                backkeys[ii2][1].backleftLegZ =0.001,
                                backkeys[ii2][1].backleftLeg2X=0.001,
                                backkeys[ii2][1].backleftLeg2Z =0.001
                        ];
                    }*/
            

                  backintkey=[ 
                
                backkeys[ii2][1].backbodyRotate * (1 - a2) + backkeys[ii2 + 1][1].backbodyRotate * a2,
                backkeys[ii2][1].backbodyHeight * (1 - a2) + backkeys[ii2 + 1][1].backbodyHeight * a2,
                backkeys[ii2][1].backbodyRotateY * (1 - a2) + backkeys[ii2 + 1][1].backbodyRotateY * a2,
                
                backkeys[ii2][1].backrightHandX * (1 - a2) + backkeys[ii2 + 1][1].backrightHandX * a2,
                backkeys[ii2][1].backrightHandZ * (1 - a2) + backkeys[ii2 + 1][1].backrightHandZ * a2,
              /////////////////////////////////////////////////////////////////////////////////
                backkeys[ii2][1].backrightHand2X * (1 - a2) + backkeys[ii2 + 1][1].backrightHand2X * a2,
                backkeys[ii2][1].backrightHand2Z * (1 - a2) + backkeys[ii2 + 1][1].backrightHand2Z * a2,
              
                backkeys[ii2][1].backleftHandX * (1 - a2) + backkeys[ii2 + 1][1].backleftHandX * a2,
                backkeys[ii2][1].backleftHandZ * (1 - a2) + backkeys[ii2 + 1][1].backleftHandZ * a2,
              ////////////////////////////////////////////////////////////////////////////////
                backkeys[ii2][1].backleftHand2X * (1 - a2) + backkeys[ii2 + 1][1].backleftHand2X * a2,
                backkeys[ii2][1].backleftHand2Z * (1 - a2) + backkeys[ii2 + 1][1].backleftHand2Z * a2,
              
                backkeys[ii2][1].backrightLegX * (1 - a2) + backkeys[ii2 + 1][1].backrightLegX * a2,
                backkeys[ii2][1].backrightLegZ * (1 - a2) + backkeys[ii2 + 1][1].backrightLegZ * a2,
              ////////////////////////////////////////////////////////////////////////////////
                backkeys[ii2][1].backrightLeg2X * (1 - a2) + backkeys[ii2 + 1][1].backrightLeg2X * a2,
                backkeys[ii2][1].backrightLeg2Z * (1 - a2) + backkeys[ii2 + 1][1].backrightLeg2Z * a2,
              
                backkeys[ii2][1].backleftLegX * (1 - a2) + backkeys[ii2 + 1][1].backleftLegX * a2,
                backkeys[ii2][1].backleftLegZ * (1 - a2) + backkeys[ii2 + 1][1].backleftLegZ * a2,
              ////////////////////////////////////////////////////////////////////////////////
                backkeys[ii2][1].backleftLeg2X * (1 - a2) + backkeys[ii2 + 1][1].backleftLeg2X * a2,
                backkeys[ii2][1].backleftLeg2Z * (1 - a2) + backkeys[ii2 + 1][1].backleftLeg2Z * a2,

                backkeys[ii2][1].backhead2 * (1 - a2) +  backkeys[ii2 + 1][1].backhead2 * a2,
						    backkeys[ii2][1].backhead3 * (1 - a2) + backkeys[ii2 + 1][1].backhead3 * a2
            
              ];
            }


          function jckeyframe(t3) {
                  
                      var s3 = ((t3 - ts3) % T3) / T3;

                      for (var i3 = 1; i3 < jckeys.length; i3++) {
                        if (jckeys[i3][0] > s3) break;
                     }

                      var ii3 = i3 - 1;
                      if(i3 === 6)i3 = 0;

                      var a3 = (s3 - jckeys[ii3][0]) / (jckeys[ii3 + 1][0] - jckeys[ii3][0]);

                      var one3 = ts3+T3;
                      if(t3>one3){
                        jcintkey=[jckeys[ii3][1].jcbodyRotate = 0.4200,
                            jckeys[ii3][1].jcbodyHeight =0.001,
                            jckeys[ii3][1].jcbodyRotateY =1.1191,
                            jckeys[ii3][1].jcrightHandX =-1.1864,
                            jckeys[ii3][1].jcrightHand2X =-0.7834,
                            jckeys[ii3][1].jcrightHandZ=-0.5852,                           
                            jckeys[ii3][1].jcrightHand2Z =0.901,
                            jckeys[ii3][1].jcleftHandX =-1.1864,
                            jckeys[ii3][1].jcleftHand2X =-0.5834,
                            jckeys[ii3][1].jcleftHandZ=0.5852,                           
                            jckeys[ii3][1].jcleftHand2Z =-0.901,
                            jckeys[ii3][1].jcrightLegX =0.001,
                            jckeys[ii3][1].jcrightLeg2X =0.001,
                            jckeys[ii3][1].jcrightLegZ =0.001,                  
                            jckeys[ii3][1].jcrightLeg2Z =0.001,
                            jckeys[ii3][1].jcleftLegX =0.001,
                            jckeys[ii3][1].jcleftLeg2X=0.001,
                            jckeys[ii3][1].jcleftLegZ =0.001,                           
                            jckeys[ii3][1].jcleftLeg2Z =0.001,
                            jckeys[ii3][1].jchead2 =1.7645
                        ];
                      }
                      else{
                        jcintkey=[ 
                                    jckeys[ii3][1].jcbodyRotate * (1 - a3) + jckeys[ii3 + 1][1].jcbodyRotate * a3,
                                    jckeys[ii3][1].jcbodyHeight * (1 - a3) + jckeys[ii3 + 1][1].jcbodyHeight * a3,
                                    jckeys[ii3][1].jcbodyRotateY * (1 - a3) + jckeys[ii3 + 1][1].jcbodyRotateY * a3,
                                    
                                    jckeys[ii3][1].jcrightHandX * (1 - a3) + jckeys[ii3 + 1][1].jcrightHandX * a3,
                                    jckeys[ii3][1].jcrightHandZ * (1 - a3) + jckeys[ii3 + 1][1].jcrightHandZ * a3,
                                /////////////////////////////////////////////////////////////////////////////////
                                    jckeys[ii3][1].jcrightHand2X * (1 - a3) + jckeys[ii3 + 1][1].jcrightHand2X * a3,
                                    jckeys[ii3][1].jcrightHand2Z * (1 - a3) + jckeys[ii3 + 1][1].jcrightHand2Z * a3,
                                
                                    jckeys[ii3][1].jcleftHandX * (1 - a3) + jckeys[ii3 + 1][1].jcleftHandX * a3,
                                    jckeys[ii3][1].jcleftHandZ * (1 - a3) + jckeys[ii3 + 1][1].jcleftHandZ * a3,
                                ////////////////////////////////////////////////////////////////////////////////
                                    jckeys[ii3][1].jcleftHand2X * (1 - a3) + jckeys[ii3 + 1][1].jcleftHand2X * a3,
                                    jckeys[ii3][1].jcleftHand2Z * (1 - a3) + jckeys[ii3 + 1][1].jcleftHand2Z * a3,
                            
                                    jckeys[ii3][1].jcrightLegX * (1 - a3) + jckeys[ii3 + 1][1].jcrightLegX * a3,
                                    jckeys[ii3][1].jcrightLegZ * (1 - a3) + jckeys[ii3 + 1][1].jcrightLegZ * a3,
                                ////////////////////////////////////////////////////////////////////////////////
                                    jckeys[ii3][1].jcrightLeg2X * (1 - a3) + jckeys[ii3 + 1][1].jcrightLeg2X * a3,
                                    jckeys[ii3][1].jcrightLeg2Z * (1 - a3) + jckeys[ii3 + 1][1].jcrightLeg2Z * a3,
                                
                                    jckeys[ii3][1].jcleftLegX * (1 - a3) + jckeys[ii3 + 1][1].jcleftLegX * a3,
                                    jckeys[ii3][1].jcleftLegZ * (1 - a3) + jckeys[ii3 + 1][1].jcleftLegZ * a3,
                                ////////////////////////////////////////////////////////////////////////////////
                                    jckeys[ii3][1].jcleftLeg2X * (1 - a3) + jckeys[ii3 + 1][1].jcleftLeg2X * a3,
                                    jckeys[ii3][1].jcleftLeg2Z * (1 - a3) + jckeys[ii3 + 1][1].jcleftLeg2Z * a3,

                                    jckeys[ii3][1].jchead2 * (1 - a3) + jckeys[ii3 + 1][1].jchead2 * a3		
                        ];
                      }
            
              }        

    function onDocumentKeyDown(event) {
	  var keyCode = event.which;
    ////////////// I/O
	  if (keyCode == 73) {
      condict=1;
    }
    else if (keyCode == 79){
      condict=2;
    }
    else if(keyCode == 17 && controling == 0){
      if(standup == 0 && playerpositionbox.position.z <= 40){
        standup = 1;
        controling = 1;
        controlpressed();
      }
      else if(standup == 1){
        standup = 0;
        controling = 1;
        controlpressed();
      }
    }
    else if(keyCode == 17 && controling == 1){
      if(standup == 0) standup = 1;
      else standup = 0;
    }
    if (keyCode == 69) {
      if(isranged == 1 && iscanceled == 0 && stop == 0){
        camera.getWorldDirection(returndegree);
        playerstate = 1;
        keyboarding = 1;
        startflag = 0;
        headflag = 0;
        setTimeout(headlook,20);
        stop=1;
        if(gamestart == 0) playerstate1timeout();
        canceltext.position.set(-5, -7, 100);
        progressclock.start();
      }
      else if(stop == 1){
        stop = 0;
        iscanceled = 1;
        headflag = 1;
        setTimeout(headlook,20);
        canceltext.position.set(200, 0, 100);
        keyboarding = 0;
        setTimeout(canceled,3000);
        progressclock.stop();
      } 
    }
    if(keyCode == 90){
      camera.getWorldDirection(test);
      console.log("x = "+test.x);
      console.log("z = "+test.z);
    }
	}



      /*
      x = -0.5340506459704344 z = -0.845452486860475
      x = -0.7729437447247708 z = -0.6344745601604909

      x = -0.42240402177452135 z = -0.9064076579490653
      x = -0.7777610775195809  z = -0.6285600260083206
      */


    function update(dt) {
      
      keyboard.update();
      if(stop==0){
        if ( keyboard.pressed("A") ) {
          playerstate = 2;
          camera.getWorldDirection(test);
          camera.position.x += test.z;
          camera.position.z -= test.x;
          playerpositionbox.position.x += test.z;
          playerpositionbox.position.z -= test.x;


          if(standup == 0 && controling == 0 && camera.position.x <= 30 && camera.position.x >= -30) canentertable = 1;
          else canentertable = 0;

          if(canentertable == 1){ 
            if(camera.position.z > 45) undertable = 1;
            else undertable = 0;
            if(camera.position.z > 80){
              camera.position.z = 80;
              playerpositionbox.position.z = 80;
            }   
          }
          else undertable = 0;

          if(camera.position.z > 40 && canentertable == 0){
            camera.position.z = 40;
            playerpositionbox.position.z = 40;
          } 

          if(canentertable == 1 && camera.position.z > 40){
            if(camera.position.x > 29){
              camera.position.x = 29;
              playerpositionbox.position.x = 29;
            }
            else if(camera.position.x < -29){
              camera.position.x = -29;
              playerpositionbox.position.x = -29;
            }
          }




          if(camera.position.x > 80.01){
            camera.position.x = 80;
            playerpositionbox.position.x = 80;
          }
          if(camera.position.x < -80.01){
            camera.position.x = -80;
            playerpositionbox.position.x = -80;
          }
          if(camera.position.x <= 50 && camera.position.x >= -50){
            if(camera.position.z < -45) camera.position.z = -45; 
            if(playerpositionbox.position.z < -45) playerpositionbox.position.z = -45;     
          }
          if(camera.position.x >= 50 && camera.position.x <= 70){
              var tmp = -45 + (camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x >= 70 && camera.position.x <= 80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }
          if(camera.position.x <= -50 && camera.position.x >= -70){
              var tmp = -45 + (-camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x <= -70 && camera.position.x >= -80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }

          
          
          
        }

        else if ( keyboard.pressed("D") ){
          playerstate = 2;
          camera.getWorldDirection(test);
          camera.position.x -= test.z;
          camera.position.z += test.x;
          playerpositionbox.position.x -= test.z;
          playerpositionbox.position.z += test.x;

          if(standup == 0 && controling == 0 && camera.position.x <= 30 && camera.position.x >= -30) canentertable = 1;
          else canentertable = 0;

          if(canentertable == 1){ 
            if(camera.position.z > 45) undertable = 1;
            else undertable = 0;
            if(camera.position.z > 80){
              camera.position.z = 80;
              playerpositionbox.position.z = 80;
            }   
          }
          else undertable = 0;

          if(camera.position.z > 40 && canentertable == 0){
            camera.position.z = 40;
            playerpositionbox.position.z = 40;
          } 

          if(canentertable == 1 && camera.position.z > 40){
            if(camera.position.x > 29){
              camera.position.x = 29;
              playerpositionbox.position.x = 29;
            }
            else if(camera.position.x < -29){
              camera.position.x = -29;
              playerpositionbox.position.x = -29;
            }
          }



          if(camera.position.x > 80.01){
            camera.position.x = 80;
            playerpositionbox.position.x = 80;
          }
          if(camera.position.x < -80.01){
            camera.position.x = -80;
            playerpositionbox.position.x = -80;
          }
          if(camera.position.x <= 50 && camera.position.x >= -50){
            if(camera.position.z < -45) camera.position.z = -45; 
            if(playerpositionbox.position.z < -45) playerpositionbox.position.z = -45;     
          }
          if(camera.position.x >= 50 && camera.position.x <= 70){
              var tmp = -45 + (camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x >= 70 && camera.position.x <= 80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }
          if(camera.position.x <= -50 && camera.position.x >= -70){
              var tmp = -45 + (-camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x <= -70 && camera.position.x >= -80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }

        }
        else if ( keyboard.pressed("W") ){
          playerstate = 2;
          camera.getWorldDirection(test);
          camera.position.x += test.x;
          camera.position.z += test.z;
          playerpositionbox.position.x += test.x;
          playerpositionbox.position.z += test.z;

          if(standup == 0 && controling == 0 && camera.position.x <= 30 && camera.position.x >= -30) canentertable = 1;
          else canentertable = 0;

          if(canentertable == 1){ 
            if(camera.position.z > 45) undertable = 1;
            else undertable = 0;
            if(camera.position.z > 80){
              camera.position.z = 80;
              playerpositionbox.position.z = 80;
            }   
          }
          else undertable = 0;

          if(camera.position.z > 40 && canentertable == 0){
            camera.position.z = 40;
            playerpositionbox.position.z = 40;
          } 

          if(canentertable == 1 && camera.position.z > 40){
            if(camera.position.x > 29){
              camera.position.x = 29;
              playerpositionbox.position.x = 29;
            }
            else if(camera.position.x < -29){
              camera.position.x = -29;
              playerpositionbox.position.x = -29;
            }
          }

          if(camera.position.x > 80.01){
            camera.position.x = 80;
            playerpositionbox.position.x = 80;
          }
          if(camera.position.x < -80.01){
            camera.position.x = -80;
            playerpositionbox.position.x = -80;
          }
          if(camera.position.x <= 50 && camera.position.x >= -50){
            if(camera.position.z < -45) camera.position.z = -45; 
            if(playerpositionbox.position.z < -45) playerpositionbox.position.z = -45;     
          }
          if(camera.position.x >= 50 && camera.position.x <= 70){
              var tmp = -45 + (camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x >= 70 && camera.position.x <= 80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }
          if(camera.position.x <= -50 && camera.position.x >= -70){
              var tmp = -45 + (-camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x <= -70 && camera.position.x >= -80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }

          
          
        }
        else if ( keyboard.pressed("S") ){
          playerstate = 2;
          camera.getWorldDirection(test);
          camera.position.x -= test.x;
          camera.position.z -= test.z;
          playerpositionbox.position.x -= test.x;
          playerpositionbox.position.z -= test.z;


          if(standup == 0 && controling == 0 && camera.position.x <= 30 && camera.position.x >= -30) canentertable = 1;
          else canentertable = 0;

          if(canentertable == 1){ 
            if(camera.position.z > 45) undertable = 1;
            else undertable = 0;
            if(camera.position.z > 80){
              camera.position.z = 80;
              playerpositionbox.position.z = 80;
            }   
          }
          else undertable = 0;

          if(camera.position.z > 40 && canentertable == 0){
            camera.position.z = 40;
            playerpositionbox.position.z = 40;
          } 

          if(canentertable == 1 && camera.position.z > 40){
            if(camera.position.x > 29){
              camera.position.x = 29;
              playerpositionbox.position.x = 29;
            }
            else if(camera.position.x < -29){
              camera.position.x = -29;
              playerpositionbox.position.x = -29;
            }
          }



          if(camera.position.x > 80.01){
            camera.position.x = 80;
            playerpositionbox.position.x = 80;
          }
          if(camera.position.x < -80.01){
            camera.position.x = -80;
            playerpositionbox.position.x = -80;
          }
          if(camera.position.x <= 50 && camera.position.x >= -50){
            if(camera.position.z < -45) camera.position.z = -45; 
            if(playerpositionbox.position.z < -45) playerpositionbox.position.z = -45;     
          }
          if(camera.position.x >= 50 && camera.position.x <= 70){
              var tmp = -45 + (camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x >= 70 && camera.position.x <= 80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }
          if(camera.position.x <= -50 && camera.position.x >= -70){
              var tmp = -45 + (-camera.position.x - 50) * 1.8;
              if(camera.position.z < tmp) camera.position.z = tmp;
              if(playerpositionbox.position.z < tmp) playerpositionbox.position.z = tmp;
          }
          if(camera.position.x <= -70 && camera.position.x >= -80){
              if(camera.position.z < -9) camera.position.z = -9;
              if(playerpositionbox.position.z < -9) playerpositionbox.position.z = -9;
          }

          }
        }
      }

      












    function windowflashing() {

      if (lightstate3 == 1) {

        if (Time.elapsedTime % 3 < 1) {
          light3.distance = 50;
        } else if (Time.elapsedTime % 5 > 1 && Time.elapsedTime % 5 < 1.2) {
          light3.distance = 40;
        } else if (Time.elapsedTime % 5 > 1.2 && Time.elapsedTime % 5 < 1.3) {
          light3.distance = 50;
        } else if (Time.elapsedTime % 5 > 1.3 && Time.elapsedTime % 5 < 1.5) {
          light3.distance = 35;
        } else if (Time.elapsedTime % 5 > 1.5 && Time.elapsedTime % 5 < 2) {
          light3.distance = 50;
        } else if (Time.elapsedTime % 5 > 2 && Time.elapsedTime % 5 < 2.3) {
          light3.distance = 40;
        } else if (Time.elapsedTime % 5 > 2.3 && Time.elapsedTime % 5 < 2.5) {
          light3.distance = 50;
        } else if (Time.elapsedTime % 5 > 2.5 && Time.elapsedTime % 5 < 2.7) {
          light3.distance = 40;
        } else {
          light3.distance = 50;
        }
      } else light3.distance = 1;

    }

    function rightflashing() {

      if (lightstate1 == 1) {

        light11.distance = 65;

        if (Time.elapsedTime % 3 < 1) {
          light1.distance = 65;
        } else if (Time.elapsedTime % 5 > 1 && Time.elapsedTime % 5 < 1.2) {
          light1.distance = 45;
          light11.distance = 65;
        } else if (Time.elapsedTime % 5 > 1.2 && Time.elapsedTime % 5 < 1.3) {
          light1.distance = 65;
          light11.distance = 55;
        } else if (Time.elapsedTime % 5 > 1.3 && Time.elapsedTime % 5 < 1.5) {
          light1.distance = 35;
          light11.distance = 65;
        } else if (Time.elapsedTime % 5 > 1.5 && Time.elapsedTime % 5 < 2) {
          light1.distance = 65;
          light11.distance = 55;
        } else if (Time.elapsedTime % 5 > 2 && Time.elapsedTime % 5 < 2.3) {
          light1.distance = 45;
          light11.distance = 65;
        } else if (Time.elapsedTime % 5 > 2.3 && Time.elapsedTime % 5 < 2.5) {
          light1.distance = 65;
        } else if (Time.elapsedTime % 5 > 2.5 && Time.elapsedTime % 5 < 2.7) {
          light1.distance = 45;
        } else {
          light1.distance = 65;
        }
      } else {
        light1.distance = 1;
        light11.distance = 1;
      }

    }

    function leftflashing() {

      if (lightstate2 == 1) {

        light21.distance = 65;

        if (Time.elapsedTime % 3 < 1) {
          light2.distance = 65;
        } else if (Time.elapsedTime % 5 > 1 && Time.elapsedTime % 5 < 1.2) {
          light2.distance = 45;
          light21.distance = 65;
        } else if (Time.elapsedTime % 5 > 1.2 && Time.elapsedTime % 5 < 1.3) {
          light2.distance = 65;
          light21.distance = 55;
        } else if (Time.elapsedTime % 5 > 1.3 && Time.elapsedTime % 5 < 1.5) {
          light2.distance = 35;
          light21.distance = 65;
        } else if (Time.elapsedTime % 5 > 1.5 && Time.elapsedTime % 5 < 2) {
          light2.distance = 65;
          light21.distance = 55;
        } else if (Time.elapsedTime % 5 > 2 && Time.elapsedTime % 5 < 2.3) {
          light2.distance = 45;
          light21.distance = 65;
        } else if (Time.elapsedTime % 5 > 2.3 && Time.elapsedTime % 5 < 2.5) {
          light2.distance = 65;
        } else if (Time.elapsedTime % 5 > 2.5 && Time.elapsedTime % 5 < 2.7) {
          light2.distance = 45;
        } else {
          light2.distance = 65;
        }
      } else {
        light2.distance = 1;
        light21.distance = 1;
      }
    }


    function maketable() {

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/S1ilknr.png');
      else var texture = new THREE.TextureLoader().load('tex/white.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });

      if(Islocal != 1) var texture2 = new THREE.TextureLoader().load('https://i.imgur.com/S1ilknr.png');
      else var texture2 = new THREE.TextureLoader().load('tex/black.png');

      var texMat2 = new THREE.MeshPhongMaterial({
        map: texture2
      });


      var material = new THREE.MeshPhongMaterial({
        color: 0xffffff,
        side: THREE.DoubleSide
      });

      var geometry = new THREE.BoxGeometry(80, 40, 10 );
      var monitor = new THREE.Mesh(geometry, texMat);
      monitor.position.set(0, 55, -95);
      scene.add(monitor);
      
      
      var geometry = new THREE.BoxGeometry(35, 25, 5 );
      var monitor2 = new THREE.Mesh(geometry, texMat2);
      monitor2.position.set(0, 25.7, -81.5);
      monitor2.rotation.x -= (Math.PI/4 + 0.135);
      scene.add(monitor2);

      
      var geometry = new THREE.BoxGeometry(30, 20, 5 );
      var monitor3 = new THREE.Mesh(geometry, texMat);
      monitor3.position.set(-70, 45, -75);
      monitor3.rotation.y += Math.PI/4 ;
      scene.add(monitor3);


      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/S1ilknr.png');
      else var texture = new THREE.TextureLoader().load('tex/progressline2.png');

      var texMat = new THREE.MeshBasicMaterial({
        map: texture
      });

      var geometry = new THREE.BoxGeometry(29, 19, 5 );
      progressline = new THREE.Mesh(geometry, texMat);
      scene.add(progressline);
      progressline.position.z -= 0.1;
      monitor3.add(progressline);
      
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/pZgBo3R.jpg');
      else var texture = new THREE.TextureLoader().load('tex/controlpanel01.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      if(Islocal != 1) var texture2 = new THREE.TextureLoader().load('https://i.imgur.com/Wvoy1mm.jpg');
      var texture2 = new THREE.TextureLoader().load('tex/controlpanel02.jpg');

      var texMat2 = new THREE.MeshPhongMaterial({
        map: texture2
      });
      
      
      
      var geometry = new THREE.Geometry();

      geometry = new THREE.Geometry();
      geometry.vertices.push(
        new THREE.Vector3(-50,0,0),
        new THREE.Vector3(-50,0,-20),
        new THREE.Vector3(-50,35,-20),
        new THREE.Vector3(-50,20,0),
        new THREE.Vector3(50,0,0),
        new THREE.Vector3(50,0,-20),
        new THREE.Vector3(50,35,-20),
        new THREE.Vector3(50,20,0)
      );
      geometry.faces.push(
        new THREE.Face3(0,2,1),
        new THREE.Face3(0,3,2),
        new THREE.Face3(0,4,3),
        new THREE.Face3(4,7,3),
        new THREE.Face3(4,6,7),
        new THREE.Face3(4,5,6),
        new THREE.Face3(3,7,2),
        new THREE.Face3(7,6,2),
        new THREE.Face3(1,6,5),
        new THREE.Face3(6,1,2),
        new THREE.Face3(1,4,0),
        new THREE.Face3(5,4,1)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.15,0), new THREE.Vector2(0.8, 0), new THREE.Vector2(0.15,0.5)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.8,0), new THREE.Vector2(0.8, 0.5), new THREE.Vector2(0.15,0.5)]);
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.15,0.5), new THREE.Vector2(0.8, 0.5), new THREE.Vector2(0.15,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.8,0.5), new THREE.Vector2(0.8, 1), new THREE.Vector2(0.15,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();

      
      var table = new THREE.Mesh(geometry, texMat);
      table.position.set(0, 0, -70);
      scene.add(table);

      var Rtable = new THREE.Mesh(geometry, texMat);
      Rtable.position.set(0, 0, -70);
      sceneRTT.add(Rtable);


      geometry = new THREE.Geometry();
      
      
      geometry.vertices.push(
        new THREE.Vector3(-80,0,-30),
        new THREE.Vector3(-80,0,-50),
        new THREE.Vector3(-80,35,-50),
        new THREE.Vector3(-80,20,-30),
        new THREE.Vector3(-50,0,-70),
        new THREE.Vector3(-50,0,-90),
        new THREE.Vector3(-50,35,-90),
        new THREE.Vector3(-50,20,-70)
      );
      geometry.faces.push(
        new THREE.Face3(0,2,1),
        new THREE.Face3(0,3,2),
        new THREE.Face3(0,4,3),
        new THREE.Face3(4,7,3),
        new THREE.Face3(4,6,7),
        new THREE.Face3(4,5,6),
        new THREE.Face3(3,7,2),
        new THREE.Face3(7,6,2),
        new THREE.Face3(1,6,5),
        new THREE.Face3(6,1,2),
        new THREE.Face3(1,4,0),
        new THREE.Face3(5,4,1)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.3,0), new THREE.Vector2(0.7, 0), new THREE.Vector2(0.3,0.5)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.7,0), new THREE.Vector2(0.7, 0.5), new THREE.Vector2(0.3,0.5)]);
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.3,0.5), new THREE.Vector2(0.7, 0.5), new THREE.Vector2(0.3,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.7,0.5), new THREE.Vector2(0.7, 1), new THREE.Vector2(0.3,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();
      
      var table2 = new THREE.Mesh(geometry, texMat);
      scene.add(table2);

      var Rtable2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rtable2);

      geometry = new THREE.Geometry();


      geometry.vertices.push(
        new THREE.Vector3(50,0,-70),
        new THREE.Vector3(50,0,-90),
        new THREE.Vector3(50,35,-90),
        new THREE.Vector3(50,20,-70),
        new THREE.Vector3(80,0,-30),
        new THREE.Vector3(80,0,-50),
        new THREE.Vector3(80,35,-50),
        new THREE.Vector3(80,20,-30)
      );
      geometry.faces.push(
        new THREE.Face3(0,2,1),
        new THREE.Face3(0,3,2),
        new THREE.Face3(0,4,3),
        new THREE.Face3(4,7,3),
        new THREE.Face3(4,6,7),
        new THREE.Face3(4,5,6),
        new THREE.Face3(3,7,2),
        new THREE.Face3(7,6,2),
        new THREE.Face3(1,6,5),
        new THREE.Face3(6,1,2),
        new THREE.Face3(1,4,0),
        new THREE.Face3(5,4,1)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.25,0), new THREE.Vector2(0.7, 0), new THREE.Vector2(0.25,0.5)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.7,0), new THREE.Vector2(0.7, 0.5), new THREE.Vector2(0.25,0.5)]);
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.25,0.5), new THREE.Vector2(0.7, 0.5), new THREE.Vector2(0.25,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.7,0.5), new THREE.Vector2(0.7, 1), new THREE.Vector2(0.25,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      
      
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();
      
      
      var table3 = new THREE.Mesh(geometry, texMat2);
      scene.add(table3);

      var Rtable3 = new THREE.Mesh(geometry, texMat2);
      sceneRTT.add(Rtable3);
      
      geometry = new THREE.Geometry();


      geometry.vertices.push(
        new THREE.Vector3(80,0,-30 - 0.01),
        new THREE.Vector3(80,0,-50),
        new THREE.Vector3(80,35,-50),
        new THREE.Vector3(80,20,-30 - 0.01),
        new THREE.Vector3(100,0,-30 - 0.01),
        new THREE.Vector3(100,0,-50),
        new THREE.Vector3(100,35,-50),
        new THREE.Vector3(100,20,-30 - 0.01)
      );
      geometry.faces.push(
        new THREE.Face3(0,2,1),
        new THREE.Face3(0,3,2),
        new THREE.Face3(0,4,3),
        new THREE.Face3(4,7,3),
        new THREE.Face3(4,6,7),
        new THREE.Face3(4,5,6),
        new THREE.Face3(3,7,2),
        new THREE.Face3(7,6,2),
        new THREE.Face3(1,6,5),
        new THREE.Face3(6,1,2),
        new THREE.Face3(1,4,0),
        new THREE.Face3(5,4,1)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.5,0), new THREE.Vector2(0.7, 0), new THREE.Vector2(0.5,0.5)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.7,0), new THREE.Vector2(0.7, 0.5), new THREE.Vector2(0.5,0.5)]);
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.5,0.5), new THREE.Vector2(0.7, 0.5), new THREE.Vector2(0.5,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.7,0.5), new THREE.Vector2(0.7, 1), new THREE.Vector2(0.5,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      
      
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();
      
      
      var table4 = new THREE.Mesh(geometry, texMat2);
      scene.add(table4);

      var Rtable4 = new THREE.Mesh(geometry, texMat2);
      sceneRTT.add(Rtable4);
      
      
      geometry = new THREE.Geometry();


      geometry.vertices.push(
        new THREE.Vector3(-100,0,-30 - 0.01),
        new THREE.Vector3(-100,0,-50),
        new THREE.Vector3(-100,35,-50),
        new THREE.Vector3(-100,20,-30 - 0.01),
        new THREE.Vector3(-80,0,-30 - 0.01),
        new THREE.Vector3(-80,0,-50),
        new THREE.Vector3(-80,35,-50),
        new THREE.Vector3(-80,20,-30 - 0.01)
      );
      geometry.faces.push(
        new THREE.Face3(0,2,1),
        new THREE.Face3(0,3,2),
        new THREE.Face3(0,4,3),
        new THREE.Face3(4,7,3),
        new THREE.Face3(4,6,7),
        new THREE.Face3(4,5,6),
        new THREE.Face3(3,7,2),
        new THREE.Face3(7,6,2),
        new THREE.Face3(1,6,5),
        new THREE.Face3(6,1,2),
        new THREE.Face3(1,4,0),
        new THREE.Face3(5,4,1)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.25,0), new THREE.Vector2(0.5, 0), new THREE.Vector2(0.25,0.5)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.5,0), new THREE.Vector2(0.5, 0.5), new THREE.Vector2(0.25,0.5)]);
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.25,0.5), new THREE.Vector2(0.5, 0.5), new THREE.Vector2(0.25,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.5,0.5), new THREE.Vector2(0.5, 1), new THREE.Vector2(0.25,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0,0), new THREE.Vector2(1, 0), new THREE.Vector2(0,1)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(1,0), new THREE.Vector2(1, 1), new THREE.Vector2(0,1)]);
      
      
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();
      
      
      var table5 = new THREE.Mesh(geometry, texMat);
      scene.add(table5);
      
      var Rtable5 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rtable5);
      
      
      geometry = new THREE.Geometry();


      geometry.vertices.push(
        new THREE.Vector3(-50,35,-90),
        new THREE.Vector3(-80,35,-50),
        new THREE.Vector3(-100,35,-50),
        new THREE.Vector3(-100,35,-90)
      );
      geometry.faces.push(
        new THREE.Face3(0,2,1),
        new THREE.Face3(0,3,2)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.5,0.5), new THREE.Vector2(0.2, 0.2), new THREE.Vector2(0.3,0.2)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.5,0.5), new THREE.Vector2(0.2, 0.5), new THREE.Vector2(0.2,0.2)]);
      
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();
      
      
      var table6 = new THREE.Mesh(geometry, texMat);
      scene.add(table6);

      var Rtable6 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rtable6);
      
      
      geometry = new THREE.Geometry();


      geometry.vertices.push(
        new THREE.Vector3(50,35,-90),
        new THREE.Vector3(80,35,-50),
        new THREE.Vector3(100,35,-50),
        new THREE.Vector3(100,35,-90)
      );
      geometry.faces.push(
        new THREE.Face3(0,1,2),
        new THREE.Face3(0,2,3)
      );
      
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.2,0.5), new THREE.Vector2(0.3, 0.2), new THREE.Vector2(0.5,0.2)]);
      geometry.faceVertexUvs[0].push([new THREE.Vector2(0.2,0.5), new THREE.Vector2(0.5, 0.2), new THREE.Vector2(0.5,0.5)]);
      
      
      geometry.computeBoundingSphere();
      geometry.computeFaceNormals();
      geometry.computeVertexNormals();
      
      
      var table7 = new THREE.Mesh(geometry, texMat);
      scene.add(table7);

      var Rtable7 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rtable7);





    }

    function makewall(Dsize, wallheight) {
      /*
      var texture = new THREE.TextureLoader().load('https://i.imgur.com/z9pJWLV.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      var geometry = new THREE.BoxGeometry(5.1, 120, 200);
      var rightwall = new THREE.Mesh(geometry, texMat);
      scene.add(rightwall);
      rightwall.position.set(100, 60, 0);
      */
      var geometry = new THREE.BoxGeometry(5, wallheight ,90);
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/nwTSw4l.png');
      else var texture = new THREE.TextureLoader().load('tex/wall03.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var rightwall = new THREE.Mesh(geometry, texMat);
      rightwall.position.set(100, wallheight / 2 - 10, 55);
      scene.add(rightwall);

      var Rrightwall = new THREE.Mesh(geometry, texMat);
      Rrightwall.position.set(100, wallheight / 2 - 10, 55);
      sceneRTT.add(Rrightwall);

      
      var geometry = new THREE.BoxGeometry(5, wallheight ,90);
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/gIqf5Lb.png');
      else var texture = new THREE.TextureLoader().load('tex/wall04.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var leftwall = new THREE.Mesh(geometry, texMat);
      leftwall.position.set(-100, wallheight / 2 - 10, 55);
      scene.add(leftwall);

      var Rleftwall = new THREE.Mesh(geometry, texMat);
      Rleftwall.position.set(-100, wallheight / 2 - 10, 55);
      sceneRTT.add(Rleftwall);


      
      var geometry = new THREE.BoxGeometry(5, wallheight, 100 - Dsize + 10);
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/2nQfXeF.png');
      else var texture = new THREE.TextureLoader().load('tex/wall05.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var rightwall2 = new THREE.Mesh(geometry, texMat);
      rightwall2.position.set(100, wallheight / 2 - 10, -100 + (100 - Dsize) / 2 + 5);
      scene.add(rightwall2);

      var Rrightwall2 = new THREE.Mesh(geometry, texMat);
      Rrightwall2.position.set(100, wallheight / 2 - 10, -100 + (100 - Dsize) / 2 + 5);
      sceneRTT.add(Rrightwall2);


      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/7FI95WC.png');
      else var texture = new THREE.TextureLoader().load('tex/wall06.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var leftwall2 = new THREE.Mesh(geometry, texMat);
      leftwall2.position.set(-100, wallheight / 2 - 10, -100 + (100 - Dsize) / 2 + 5);
      scene.add(leftwall2);

      var Rleftwall2 = new THREE.Mesh(geometry, texMat);
      Rleftwall2.position.set(-100, wallheight / 2 - 10, -100 + (100 - Dsize) / 2 + 5);
      sceneRTT.add(Rleftwall2);


      ///////////////////////////door//////////////////////////
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/awWOSCI.jpg');
      else var texture = new THREE.TextureLoader().load('tex/door.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });


      var geometry = new THREE.BoxGeometry(4.9, wallheight, Dsize);
      rightdoor = new THREE.Mesh(geometry, texMat);
      rightdoor.position.set(100, wallheight / 2, -1 * Dsize / 2);
      scene.add(rightdoor);
      leftdoor = new THREE.Mesh(geometry, texMat);
      leftdoor.position.set(-100, wallheight / 2, -1 * Dsize / 2);
      scene.add(leftdoor);

      Rrightdoor = new THREE.Mesh(geometry, texMat);
      Rrightdoor.position.set(100, wallheight / 2, -1 * Dsize / 2);
      sceneRTT.add(Rrightdoor);
      Rleftdoor = new THREE.Mesh(geometry, texMat);
      Rleftdoor.position.set(-100, wallheight / 2, -1 * Dsize / 2);
      sceneRTT.add(Rleftdoor);

    }
    ///////////////////////////////////////////////////////////////////
    function makewindow(wallheight, windowsize) {
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/pzdqvl6.png');
      else var texture = new THREE.TextureLoader().load('tex/vent.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });

      var geometry = new THREE.BoxGeometry(windowsize, windowsize, 5);
      windowdoor = new THREE.Mesh(geometry, texMat);
      windowdoor.position.set(0, wallheight + windowsize / 2, 100 - 0.01)
      scene.add(windowdoor);

      Rwindowdoor = new THREE.Mesh(geometry, texMat);
      Rwindowdoor.position.set(0, wallheight + windowsize / 2, 100 - 0.01)
      sceneRTT.add(Rwindowdoor);


      ///////////////front walls///////////////////
      var geometry = new THREE.BoxGeometry(200, windowsize + 20, 5);
      var material = new THREE.MeshPhongMaterial({
        color: 0x5c4332,
        side: THREE.DoubleSide
      });
      //front
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/w20eRrs.png');
      else var texture = new THREE.TextureLoader().load('tex/wall07.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var walls1 = new THREE.Mesh(geometry, texMat);
      walls1.position.set(0, wallheight + windowsize / 2, -100);
      scene.add(walls1);

      var Rwalls1 = new THREE.Mesh(geometry, texMat);
      Rwalls1.position.set(0, wallheight + windowsize / 2, -100);
      sceneRTT.add(Rwalls1);

      ///////////////right and left walls///////////////////
      var geometry = new THREE.BoxGeometry(5, windowsize + 20, 200);
      //right
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/6rpZyxp.png');
      else var texture = new THREE.TextureLoader().load('tex/wall08.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });

      var walls2 = new THREE.Mesh(geometry, texMat);
      walls2.position.set(100, wallheight + windowsize / 2, 0);
      scene.add(walls2);

      var Rwalls2 = new THREE.Mesh(geometry, texMat);
      Rwalls2.position.set(100, wallheight + windowsize / 2, 0);
      sceneRTT.add(Rwalls2);

      //left
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/CaIo9vS.png');
      else var texture = new THREE.TextureLoader().load('tex/wall09.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var walls3 = new THREE.Mesh(geometry, texMat);
      walls3.position.set(-100, wallheight + windowsize / 2, 0);
      scene.add(walls3);

      var Rwalls3 = new THREE.Mesh(geometry, texMat);
      Rwalls3.position.set(-100, wallheight + windowsize / 2, 0);
      sceneRTT.add(Rwalls3);


      ///////////////right and left walls///////////////////
      var geometry = new THREE.BoxGeometry((200 - windowsize) / 2, windowsize, 5);
      //back left
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/BWZ4az3.png');
      else var texture = new THREE.TextureLoader().load('tex/wall10.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var walls4 = new THREE.Mesh(geometry, texMat);
      walls4.position.set(windowsize / 2 + (200 - windowsize) / 2 / 2, wallheight + windowsize / 2, 100);
      scene.add(walls4);

      var Rwalls4 = new THREE.Mesh(geometry, texMat);
      Rwalls4.position.set(windowsize / 2 + (200 - windowsize) / 2 / 2, wallheight + windowsize / 2, 100);
      sceneRTT.add(Rwalls4);

      //back right
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/1aG8ivb.png');
      else var texture = new THREE.TextureLoader().load('tex/wall11.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var walls5 = new THREE.Mesh(geometry, texMat);
      walls5.position.set(-(windowsize / 2 + (200 - windowsize) / 2 / 2), wallheight + windowsize / 2, 100);
      scene.add(walls5);

      var Rwalls5 = new THREE.Mesh(geometry, texMat);
      Rwalls5.position.set(-(windowsize / 2 + (200 - windowsize) / 2 / 2), wallheight + windowsize / 2, 100);
      sceneRTT.add(Rwalls5);


      var geometry = new THREE.BoxGeometry(2, windowsize, 80);

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/ZUWRF8R.jpg');
      else var texture = new THREE.TextureLoader().load('tex/ventinside.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });

      var windows1 = new THREE.Mesh(geometry, texMat);
      windows1.position.set(windowsize / 2 - 1, wallheight + windowsize / 2, 100 + 40 - 2.5)
      scene.add(windows1);

      var Rwindows1 = new THREE.Mesh(geometry, texMat);
      Rwindows1.position.set(windowsize / 2 - 1, wallheight + windowsize / 2, 100 + 40 - 2.5)
      sceneRTT.add(Rwindows1);


      var windows2 = new THREE.Mesh(geometry, texMat);
      windows2.position.set(-windowsize / 2 + 1, wallheight + windowsize / 2, 100 + 40 - 2.5)
      scene.add(windows2);

      var Rwindows2 = new THREE.Mesh(geometry, texMat);
      Rwindows2.position.set(-windowsize / 2 + 1, wallheight + windowsize / 2, 100 + 40 - 2.5)
      sceneRTT.add(Rwindows2);

      var geometry = new THREE.BoxGeometry(windowsize - 4, 2, 40);

      var windows3 = new THREE.Mesh(geometry, texMat);
      windows3.position.set(0, wallheight + windowsize / 2 + windowsize / 2 - 1, 100 + 20 - 2.5)
      scene.add(windows3);

      var Rwindows3 = new THREE.Mesh(geometry, texMat);
      Rwindows3.position.set(0, wallheight + windowsize / 2 + windowsize / 2 - 1, 100 + 20 - 2.5)
      sceneRTT.add(Rwindows3);

      var geometry = new THREE.BoxGeometry(windowsize - 4, 2, 80);

      var windows4 = new THREE.Mesh(geometry, texMat);
      windows4.position.set(0, wallheight + windowsize / 2 - windowsize / 2 + 1, 100 + 40 - 2.5)
      scene.add(windows4);

      var Rwindows4 = new THREE.Mesh(geometry, texMat);
      Rwindows4.position.set(0, wallheight + windowsize / 2 - windowsize / 2 + 1, 100 + 40 - 2.5)
      sceneRTT.add(Rwindows4);

      var geometry = new THREE.BoxGeometry(40, 80, 2);

      var windows5 = new THREE.Mesh(geometry, texMat);
      windows5.position.set(0, wallheight + windowsize / 2 - windowsize / 2 + 40, 100 + 80 - 2.5)
      scene.add(windows5);

      var Rwindows5 = new THREE.Mesh(geometry, texMat);
      Rwindows5.position.set(0, wallheight + windowsize / 2 - windowsize / 2 + 40, 100 + 80 - 2.5)
      sceneRTT.add(Rwindows5);

      var geometry = new THREE.BoxGeometry(2, 40, 40);

      var windows6 = new THREE.Mesh(geometry, texMat);
      windows6.position.set(20 - 1, wallheight + windowsize / 2 - windowsize / 2 + 60, 100 + 60 - 2.5)
      scene.add(windows6);

      var Rwindows6 = new THREE.Mesh(geometry, texMat);
      Rwindows6.position.set(20 - 1, wallheight + windowsize / 2 - windowsize / 2 + 60, 100 + 60 - 2.5)
      sceneRTT.add(Rwindows6);

      var windows7 = new THREE.Mesh(geometry, texMat);
      windows7.position.set(-20 + 1, wallheight + windowsize / 2 - windowsize / 2 + 60, 100 + 60 - 2.5)
      scene.add(windows7);

      var Rwindows7 = new THREE.Mesh(geometry, texMat);
      Rwindows7.position.set(-20 + 1, wallheight + windowsize / 2 - windowsize / 2 + 60, 100 + 60 - 2.5)
      sceneRTT.add(Rwindows7);


      var windowlightbox = new THREE.Mesh(new THREE.BoxGeometry(8, 3, 25), new THREE.MeshPhongMaterial({
        color: 0xffffff
      }))
      windowlightbox.position.set(0, wallheight + windowsize / 2 + windowsize / 2 - 3, 100 + 25 / 2 + 5)
      scene.add(windowlightbox);

      var Rwindowlightbox = new THREE.Mesh(new THREE.BoxGeometry(8, 3, 25), new THREE.MeshPhongMaterial({
        color: 0xffffff
      }))
      Rwindowlightbox.position.set(0, wallheight + windowsize / 2 + windowsize / 2 - 3, 100 + 25 / 2 + 5)
      sceneRTT.add(Rwindowlightbox);

    }

    function openrightdoor() {
      for (var i = 0; i < wallheight;) {
        rightdoor.position.y += 0.01;
        i = i + 0.01;
      }
    }

    function closerightdoor() {
      for (var i = 0; i < wallheight;) {
        rightdoor.position.y -= 0.01;
        i = i + 0.01;
      }
    }

    function openleftdoor() {
      for (var i = 0; i < wallheight;) {
        leftdoor.position.y += 0.01;
        i = i + 0.01;
      }
    }

    function closeleftdoor() {
      for (var i = 0; i < wallheight;) {
        leftdoor.position.y -= 0.01;
        i = i + 0.01;
      }
    }

    function openwindowdoor() {
      for (var i = 0; i < windowsize;) {
        windowdoor.position.y += 0.01;
        i = i + 0.01;
      }
    }

    function closewindowdoor() {
      for (var i = 0; i < windowsize;) {
        windowdoor.position.y -= 0.01;
        i = i + 0.01;
      }
    }

    function onDocumentMouseMove(event) {

      event.preventDefault();
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      //mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      
      if (mouse.x > 0.3 && viewpoint == 1) rotationy = (mouse.x - 0.3) * 2;
      else if (mouse.x < -0.3 && viewpoint == 1) rotationy = (mouse.x + 0.3) * 2;
      else rotationy = 0;
      

    }

    function makebuttoms(wallheight, doorsize) {
      /// set door buttom 
      var geometry = new THREE.BoxGeometry(2, 5, 5);
      var material = new THREE.MeshPhongMaterial({
        color: 0xff0000,
        side: THREE.DoubleSide
      });
      var rightdoorbuttom = new THREE.Mesh(geometry, material);
      scene.add(rightdoorbuttom);
      rightdoorbuttom.position.set(30, 30, -82);
      rightdoorbuttom.rotation.y += Math.PI/2;
      rightdoorbuttom.rotation.x -= 0.92;
      rightdoorpickables.push(rightdoorbuttom);
      var leftdoorbuttom = new THREE.Mesh(geometry, material);
      scene.add(leftdoorbuttom);
      leftdoorbuttom.position.set(-30, 30,-82);
      leftdoorbuttom.rotation.y += Math.PI/2;
      leftdoorbuttom.rotation.x -= 0.92;
      leftdoorpickables.push(leftdoorbuttom);
      //// door buttom
      document.addEventListener('mousedown', rightsidedoor, false);
      document.addEventListener('mousedown', leftsidedoor, false);


      //window door buttom
      var geometry = new THREE.BoxGeometry(5, 5, 2);
      var windowdoorbuttom = new THREE.Mesh(geometry, material);
      scene.add(windowdoorbuttom);
      windowdoorbuttom.position.set(-25, wallheight + 10, 100 - 5);
      windowdoorpickables.push(windowdoorbuttom);

      document.addEventListener('mousedown', windowsidedoor, false);

      /// set light buttom
      var geometry = new THREE.BoxGeometry(2, 5, 5);
      var material = new THREE.MeshPhongMaterial({
        color: 0xf5f5f5,
        side: THREE.DoubleSide
      });
      var rightlightbuttom = new THREE.Mesh(geometry, material);
      scene.add(rightlightbuttom);
      rightlightbuttom.position.set(30, 24, -74);
      rightlightbuttom.rotation.y += Math.PI/2;
      rightlightbuttom.rotation.x -= 0.92;
      rightlightpickables.push(rightlightbuttom);
      var leftlightbuttom = new THREE.Mesh(geometry, material);
      scene.add(leftlightbuttom);
      leftlightbuttom.position.set(-30, 24, -74);
      leftlightbuttom.rotation.y += Math.PI/2;
      leftlightbuttom.rotation.x -= 0.92;
      leftlightpickables.push(leftlightbuttom);

      //// light buttom
      document.addEventListener('mousedown', rightsidelight, false);
      document.addEventListener('mousedown', leftsidelight, false);



      //window light buttom
      var geometry = new THREE.BoxGeometry(5, 5, 2);
      var windowlightbuttom = new THREE.Mesh(geometry, material);
      scene.add(windowlightbuttom);
      windowlightbuttom.position.set(-25, wallheight + 2.5, 100 - 5);
      windowlightpickables.push(windowlightbuttom);

      document.addEventListener('mousedown', windowsidelight, false);

    }

    function rightsidedoor(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(rightdoorpickables, false);
      if (intersects.length > 0) {
        if (rightwallstate == 0) {
          rightwallstate = 1;
        } else if (rightwallstate == 1) {
          rightwallstate = 0;
        }
      }
    }

    function leftsidedoor(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(leftdoorpickables, false);
      if (intersects.length > 0) {
        if (leftwallstate == 0) {
          leftwallstate = 1;
        } else if (leftwallstate == 1) {
          leftwallstate = 0;
        }
      }
    }

    function windowsidedoor(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(windowdoorpickables, false);
      if (intersects.length > 0) {
        if (windowdoorstate == 0) {
          windowdoorstate = 1;
        } else if (windowdoorstate == 1) {
          windowdoorstate = 0;
        }
      }
    }

    function rightsidelight(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(rightlightpickables, false);
      if (intersects.length > 0) {
        //rightlight();
        if (lightstate1 == 0) lightstate1 = 1;
        else if (lightstate1 == 1) lightstate1 = 0;
      }
    }

    function leftsidelight(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(leftlightpickables, false);
      if (intersects.length > 0) {
        //leftlight();
        if (lightstate2 == 0) lightstate2 = 1;
        else if (lightstate2 == 1) lightstate2 = 0;
      }
    }

    function windowsidelight(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(windowlightpickables, false);
      if (intersects.length > 0) {
        //windowlight();
        if (lightstate3 == 0) lightstate3 = 1;
        else if (lightstate3 == 1) lightstate3 = 0;
      }
    }

    function camerarotation(x) {

      var camerarotate = new THREE.Vector3();
      camera.getWorldDirection(camerarotate);
      //console.log('c.z = '+camerarotate.z+' x ='+x+' c.x = '+camerarotate.x);
        camera.rotation.y -= x / 50;
        playerpositionbox.rotation.y -= x/50;
      
      /*
      if (viewpoint != 1) rotationy = 0;
      else if (quickswitch == 0 && camerarotate.z < -0.2) camera.rotation.y -= x / 100;
      else if (camerarotate.z < -0.2) camera.rotation.y += x / 100;
      else if (camerarotate.z < -0.1 && x > 0 && camerarotate.x < 0) camera.rotation.y -= x / 100;
      else if (camerarotate.z < -0.1 && x < 0 && camerarotate.x > 0) camera.rotation.y -= x / 100;
      */
      /*x = -0.5340506459704344 z = -0.845452486860475
      x = -0.7729437447247708 z = -0.6344745601604909*/

      /*x = 0.37159548624151534 z = -0.9283947407245109
       x = -0.7603832221335 z = 0.6494746765639723*/
    }



    function makeoutside() {
      var loader = new THREE.TextureLoader();

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/DrvlmNW.jpg');
      else var texture = new THREE.TextureLoader().load('tex/upfloor.jpeg');

      texture.repeat.set(2, 2);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;

      var plane = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane.rotation.x = +Math.PI / 2;
      scene.add(plane);
      plane.position.set(-100,100.1,0);

      var plane2 = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane2.rotation.x = +Math.PI / 2;
      scene.add(plane2);
      plane2.position.set(-100,100.1,-200);

      var plane3 = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane3.rotation.x = +Math.PI / 2;
      scene.add(plane3);
      plane3.position.set(-100,100.1,-400);

      var plane4 = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane4.rotation.x = +Math.PI / 2;
      scene.add(plane4);
      plane4.position.set(100,100.1,0);

      var plane5 = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane5.rotation.x = +Math.PI / 2;
      scene.add(plane5);
      plane5.position.set(100,100.1,-200);

      var plane6 = new THREE.Mesh(new THREE.PlaneGeometry(205, 205),
        new THREE.MeshPhongMaterial({
          map: texture
      }))

      plane6.rotation.x = +Math.PI / 2;
      scene.add(plane6);
      plane6.position.set(100,100.1,-400);


      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/FM8caZz.jpg');
      else var texture = new THREE.TextureLoader().load('tex/outsidefloor.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });


      var geometry = new THREE.PlaneGeometry(405, 450, 32);
      var corridor = new THREE.Mesh(geometry, texMat);
      corridor.rotation.x = -Math.PI / 2;
      corridor.position.y = -0.1;
      corridor.position.z = -125;
      scene.add(corridor);

      var Rcorridor = new THREE.Mesh(geometry, texMat);
      Rcorridor.rotation.x = -Math.PI / 2;
      Rcorridor.position.y = -0.1;
      Rcorridor.position.z = -125;
      sceneRTT.add(Rcorridor);



      if(Islocal != 1) texture = loader.load('https://i.imgur.com/G634HPV.png');
      else texture = loader.load('tex/wall12.png');

      texture.repeat.set(1.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;

      var outwalls1 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 300),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls1.position.set(-200, 50, -50)
      scene.add(outwalls1);

      var Routwalls1 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 300),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls1.position.set(-200, 50, -50)
      sceneRTT.add(Routwalls1);




      var outwalls2 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 300),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls2.position.set(200, 50, -50)
      scene.add(outwalls2);

      var Routwalls2 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 300),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls2.position.set(200, 50, -50)
      sceneRTT.add(Routwalls2);


      
      if(Islocal != 1) var texture = loader.load('https://i.imgur.com/G634HPV.png');
      else texture = loader.load('tex/wall12.png');

      texture.repeat.set(1, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      
      var outwalls3 = new THREE.Mesh(new THREE.BoxGeometry(209.9, 100, 0),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls3.position.set(0, 50, -200)
      scene.add(outwalls3);

      var Routwalls3 = new THREE.Mesh(new THREE.BoxGeometry(209.9, 100, 0),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls3.position.set(0, 50, -200)
      sceneRTT.add(Routwalls3);

      
      if(Islocal != 1) var texture = loader.load('https://i.imgur.com/G634HPV.png');
      else texture = loader.load('tex/wall12.png');

      texture.repeat.set(0.75, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var outwalls4 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 155),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls4.position.set(-200, 50, -277.4)
      scene.add(outwalls4);

      var Routwalls4 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 155),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls4.position.set(-200, 50, -277.4)
      sceneRTT.add(Routwalls4);


      var outwalls5 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 155),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls5.position.set(200, 50, -277.4)
      scene.add(outwalls5);

      var Routwalls5 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 155),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls5.position.set(200, 50, -277.4)
      sceneRTT.add(Routwalls5);

      
      var outwalls7 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 150),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls7.position.set(-100, 50, -275)
      scene.add(outwalls7);

      var Routwalls7 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 150),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls7.position.set(-100, 50, -275)
      sceneRTT.add(Routwalls7);


      var outwalls8 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 150),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      outwalls8.position.set(100, 50, -275)
      scene.add(outwalls8);

      var Routwalls8 = new THREE.Mesh(new THREE.BoxGeometry(10, 100, 150),
        new THREE.MeshPhongMaterial({
          map: texture
        }))
      Routwalls8.position.set(100, 50, -275)
      sceneRTT.add(Routwalls8);

    }

    function makediningroom(){
      var loader = new THREE.TextureLoader();

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/mdXDao3.png');
      else var texture = new THREE.TextureLoader().load('tex/diningfloor.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(6, 18/5);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;

      
      var geometry = new THREE.PlaneGeometry(1000, 600);
      var diningfloor = new THREE.Mesh(geometry, texMat);
      diningfloor.rotation.x = -Math.PI / 2;
      diningfloor.position.y = -0.05;
      diningfloor.position.z = -650;
      scene.add(diningfloor);

      var Rdiningfloor = new THREE.Mesh(geometry, texMat);
      Rdiningfloor.rotation.x = -Math.PI / 2;
      Rdiningfloor.position.y = -0.05;
      Rdiningfloor.position.z = -650;
      sceneRTT.add(Rdiningfloor);

      
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(2, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(409.9, 100, 10);
      var frontwall1 = new THREE.Mesh(geometry, texMat);
      frontwall1.position.x = -400;
      frontwall1.position.y = 50;
      frontwall1.position.z = -350;
      scene.add(frontwall1);

      var Rfrontwall1 = new THREE.Mesh(geometry, texMat);
      Rfrontwall1.position.x = -400;
      Rfrontwall1.position.y = 50;
      Rfrontwall1.position.z = -350;
      sceneRTT.add(Rfrontwall1);

      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(1.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(309.9, 100, 10);
      var frontwall2 = new THREE.Mesh(geometry, texMat);
      frontwall2.position.x = 350;
      frontwall2.position.y = 50;
      frontwall2.position.z = -350;
      scene.add(frontwall2);

      var Rfrontwall2 = new THREE.Mesh(geometry, texMat);
      Rfrontwall2.position.x = 350;
      Rfrontwall2.position.y = 50;
      Rfrontwall2.position.z = -350;
      sceneRTT.add(Rfrontwall2);

      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(1, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(209.9, 100, 10);
      var frontwall3 = new THREE.Mesh(geometry, texMat);
      frontwall3.position.x = 0;
      frontwall3.position.y = 50;
      frontwall3.position.z = -350;
      scene.add(frontwall3);

      var Rfrontwall3 = new THREE.Mesh(geometry, texMat);
      Rfrontwall3.position.x = 0;
      Rfrontwall3.position.y = 50;
      Rfrontwall3.position.z = -350;
      sceneRTT.add(Rfrontwall3);

      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(1.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(300, 100, 10);
      var leftbackwall = new THREE.Mesh(geometry, texMat);
      leftbackwall.position.x =  -350;
      leftbackwall.position.y =  50;
      leftbackwall.position.z = -950;
      scene.add(leftbackwall);

      var Rleftbackwall = new THREE.Mesh(geometry, texMat);
      Rleftbackwall.position.x =  -350;
      Rleftbackwall.position.y =  50;
      Rleftbackwall.position.z = -950;
      sceneRTT.add(Rleftbackwall);

      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(2, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(400, 100, 10);
      var rightbackwall = new THREE.Mesh(geometry, texMat);
      rightbackwall.position.x =  300;
      rightbackwall.position.y =  50;
      rightbackwall.position.z = -950;
      scene.add(rightbackwall);

      var Rrightbackwall = new THREE.Mesh(geometry, texMat);
      Rrightbackwall.position.x =  300;
      Rrightbackwall.position.y =  50;
      Rrightbackwall.position.z = -950;
      sceneRTT.add(Rrightbackwall);

      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(3, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 600);
      var rightwall = new THREE.Mesh(geometry, texMat);
      rightwall.position.x = 500;
      rightwall.position.y = 50;
      rightwall.position.z = -650;
      scene.add(rightwall);

      var Rrightwall = new THREE.Mesh(geometry, texMat);
      Rrightwall.position.x = 500;
      Rrightwall.position.y = 50;
      Rrightwall.position.z = -650;
      sceneRTT.add(Rrightwall);

      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(0.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 100);
      var frontleftwall = new THREE.Mesh(geometry, texMat);
      frontleftwall.position.x = -500;
      frontleftwall.position.y = 50;
      frontleftwall.position.z = -600;
      scene.add(frontleftwall);

      var Rfrontleftwall = new THREE.Mesh(geometry, texMat);
      Rfrontleftwall.position.x = -500;
      Rfrontleftwall.position.y = 50;
      Rfrontleftwall.position.z = -600;
      sceneRTT.add(Rfrontleftwall);

      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(0.25, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 60);
      var middleleftwall = new THREE.Mesh(geometry, texMat);
      middleleftwall.position.x = -500;
      middleleftwall.position.y = 50;
      middleleftwall.position.z = -805;
      scene.add(middleleftwall);

      var Rmiddleleftwall = new THREE.Mesh(geometry, texMat);
      Rmiddleleftwall.position.x = -500;
      Rmiddleleftwall.position.y = 50;
      Rmiddleleftwall.position.z = -805;
      sceneRTT.add(Rmiddleleftwall);
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(0.25, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 50);
      var backleftwall = new THREE.Mesh(geometry, texMat);
      backleftwall.position.x = -500;
      backleftwall.position.y = 50;
      backleftwall.position.z = -925;
      scene.add(backleftwall);

      var Rbackleftwall = new THREE.Mesh(geometry, texMat);
      Rbackleftwall.position.x = -500;
      Rbackleftwall.position.y = 50;
      Rbackleftwall.position.z = -925;
      sceneRTT.add(Rbackleftwall);

      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(0.05, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.PlaneGeometry(10, 100);
      var backleftwallh = new THREE.Mesh(geometry, texMat);
      backleftwallh.position.x = -500;
      backleftwallh.position.y = 50;
      backleftwallh.position.z = -899.9;
      scene.add(backleftwallh);

      var Rbackleftwallh = new THREE.Mesh(geometry, texMat);
      Rbackleftwallh.position.x = -500;
      Rbackleftwallh.position.y = 50;
      Rbackleftwallh.position.z = -899.9;
      sceneRTT.add(Rbackleftwallh);

      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(0.05, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.PlaneGeometry(10, 100);
      var middleleftwall = new THREE.Mesh(geometry, texMat);
      middleleftwall.position.x = -500;
      middleleftwall.position.y = 50;
      middleleftwall.position.z = -835.1;
      middleleftwall.rotation.y = Math.PI;
      scene.add(middleleftwall);

      var Rmiddleleftwall = new THREE.Mesh(geometry, texMat);
      Rmiddleleftwall.position.x = -500;
      Rmiddleleftwall.position.y = 50;
      Rmiddleleftwall.position.z = -835.1;
      Rmiddleleftwall.rotation.y = Math.PI;
      sceneRTT.add(Rmiddleleftwall);

      
      
      
      tables(-325,-800,0);
      tables(-275,-800,0);
      tables(-225,-800,0);
      
      tables(-125,-800,0);
      tables(-75,-800,0);
      tables(-25,-800,0);
      
      tables(75,-800,0);
      tables(125,-800,0);
      tables(175,-800,0);
      
      tables(-325,-650,0);
      tables(-275,-650,0);
      tables(-225,-650,0);
      
      tables(-125,-650,0);
      tables(-75,-650,0);
      tables(-25,-650,0);
      
      tables(75,-650,0);
      tables(125,-650,0);
      tables(175,-650,0);
      
      
      tables(-275,-450,1);
      tables(-275,-500,1);
      tables(-275,-550,1);
      
      tables(-125,-500,0);
      tables(-75,-500,0);
      tables(-25,-500,0);
      
      tables(125,-450,1);
      tables(125,-500,1);
      tables(125,-550,1);

      counter(350,-875);
      restroom(400,-650);
      storeroom(-435,-550);
      
      kitchen(-650,-950);
      stage(-50,-969.9);
    }

    function stage(x,z){
      var loader = new THREE.TextureLoader();
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/0swWBqB.jpg');
      else var texture = new THREE.TextureLoader().load('tex/stage.jpg');
      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(6, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(200, 40, 40);
      var stage1 = new THREE.Mesh(geometry, texMat);
      scene.add(stage1);
      stage1.position.x = x;
      stage1.position.y = 20;
      stage1.position.z = z;

      var Rstage1 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstage1);
      Rstage1.position.x = x;
      Rstage1.position.y = 20;
      Rstage1.position.z = z;

      
      var geometry = new THREE.BoxGeometry(50, 10, 10);
      var leftstage1 = new THREE.Mesh(geometry, texMat);
      scene.add(leftstage1);
      leftstage1.position.x = -125;
      leftstage1.position.y = -15;
      leftstage1.position.z = 15;
      stage1.add(leftstage1);

      var Rleftstage1 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rleftstage1);
      Rleftstage1.position.x = -125;
      Rleftstage1.position.y = -15;
      Rleftstage1.position.z = 15;
      Rstage1.add(Rleftstage1);


      var rightstage1 = new THREE.Mesh(geometry, texMat);
      scene.add(rightstage1);
      rightstage1.position.x = 125;
      rightstage1.position.y = -15;
      rightstage1.position.z = 15;
      stage1.add(rightstage1);

      var Rrightstage1 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrightstage1);
      Rrightstage1.position.x = 125;
      Rrightstage1.position.y = -15;
      Rrightstage1.position.z = 15;
      Rstage1.add(Rrightstage1);

      
      var geometry = new THREE.BoxGeometry(50, 10, 10);
      var leftstage2 = new THREE.Mesh(geometry, texMat);
      scene.add(leftstage2);
      leftstage2.position.x = -125;
      leftstage2.position.y = -5;
      leftstage2.position.z = 5;
      stage1.add(leftstage2);

      var Rleftstage2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rleftstage2);
      Rleftstage2.position.x = -125;
      Rleftstage2.position.y = -5;
      Rleftstage2.position.z = 5;
      Rstage1.add(Rleftstage2);


      var rightstage2 = new THREE.Mesh(geometry, texMat);
      scene.add(rightstage2);
      rightstage2.position.x = 125;
      rightstage2.position.y = -5;
      rightstage2.position.z = 5;
      stage1.add(rightstage2);

      var Rrightstage2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrightstage2);
      Rrightstage2.position.x = 125;
      Rrightstage2.position.y = -5;
      Rrightstage2.position.z = 5;
      Rstage1.add(Rrightstage2);

      
      var geometry = new THREE.BoxGeometry(50, 10, 10);
      var leftstage3 = new THREE.Mesh(geometry, texMat);
      scene.add(leftstage3);
      leftstage3.position.x = -125;
      leftstage3.position.y = 5;
      leftstage3.position.z = -5;
      stage1.add(leftstage3);

      var Rleftstage3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rleftstage3);
      Rleftstage3.position.x = -125;
      Rleftstage3.position.y = 5;
      Rleftstage3.position.z = -5;
      Rstage1.add(Rleftstage3);


      var rightstage3 = new THREE.Mesh(geometry, texMat);
      scene.add(rightstage3);
      rightstage3.position.x = 125;
      rightstage3.position.y = 5;
      rightstage3.position.z = -5;
      stage1.add(rightstage3);

      var Rrightstage3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrightstage3);
      Rrightstage3.position.x = 125;
      Rrightstage3.position.y = 5;
      Rrightstage3.position.z = -5;
      Rstage1.add(Rrightstage3);

      
      var geometry = new THREE.BoxGeometry(50, 10, 10);
      var leftstage4 = new THREE.Mesh(geometry, texMat);
      scene.add(leftstage4);
      leftstage4.position.x = -125;
      leftstage4.position.y = 15;
      leftstage4.position.z = -15;
      stage1.add(leftstage4);
      
      var Rleftstage4 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rleftstage4);
      Rleftstage4.position.x = -125;
      Rleftstage4.position.y = 15;
      Rleftstage4.position.z = -15;
      Rstage1.add(Rleftstage4);


      var rightstage4 = new THREE.Mesh(geometry, texMat);
      scene.add(rightstage4);
      rightstage4.position.x = 125;
      rightstage4.position.y = 15;
      rightstage4.position.z = -15;
      stage1.add(rightstage4);

      var Rrightstage4 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrightstage4);
      Rrightstage4.position.x = 125;
      Rrightstage4.position.y = 15;
      Rrightstage4.position.z = -15;
      Rstage1.add(Rrightstage4);

      
      var geometry = new THREE.BoxGeometry(300, 40, 200);
      var stageflat = new THREE.Mesh(geometry, texMat);
      scene.add(stageflat);
      stageflat.position.z = -120;
      stage1.add(stageflat);

      var Rstageflat = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstageflat);
      Rstageflat.position.z = -120;
      Rstage1.add(Rstageflat);
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/0swWBqB.jpg');
      else var texture = new THREE.TextureLoader().load('tex/stage.jpg');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(6, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(300, 100, 10);
      var backwall = new THREE.Mesh(geometry, texMat);
      scene.add(backwall);
      backwall.position.z = -220;
      backwall.position.y = 30;
      stage1.add(backwall);

      var Rbackwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbackwall);
      Rbackwall.position.z = -220;
      Rbackwall.position.y = 30;
      Rstage1.add(Rbackwall);
      
      
      var geometry = new THREE.BoxGeometry(10, 100, 240);
      var leftwall = new THREE.Mesh(geometry, texMat);
      scene.add(leftwall);
      leftwall.position.z = -95;
      leftwall.position.y = 30;
      leftwall.position.x = -150;
      stage1.add(leftwall);

      var Rleftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rleftwall);
      Rleftwall.position.z = -95;
      Rleftwall.position.y = 30;
      Rleftwall.position.x = -150;
      Rstage1.add(Rleftwall);

      
      var rightwall = new THREE.Mesh(geometry, texMat);
      scene.add(rightwall);
      rightwall.position.z = -95;
      rightwall.position.y = 30;
      rightwall.position.x = 150;
      stage1.add(rightwall);

      var Rrightwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrightwall);
      Rrightwall.position.z = -95;
      Rrightwall.position.y = 30;
      Rrightwall.position.x = 150;
      Rstage1.add(Rrightwall);
    }

    function tables(x,z,R){
      var loader = new THREE.TextureLoader();

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var texture = new THREE.TextureLoader().load('tex/table01.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      if(Islocal != 1) var texture2 = new THREE.TextureLoader().load('https://i.imgur.com/Wvoy1mm.jpg');
      else var texture2 = new THREE.TextureLoader().load('tex/table02.jpg');

      var texMat2 = new THREE.MeshPhongMaterial({
        map: texture2
      });
      
      if(Islocal != 1) var texture3 = new THREE.TextureLoader().load('https://i.imgur.com/I9NueiU.jpg');
      else var texture3 = new THREE.TextureLoader().load('tex/table03.jpg');

      var texMat3 = new THREE.MeshPhongMaterial({
        map: texture3
      });
      
      //loader.setCrossOrigin('');
      if(Islocal != 1) var tex = loader.load('https://i.imgur.com/beiOFVd.png');
      else var tex = loader.load('tex/table01.png');
      if(Islocal != 1) var alpha2 = loader.load('https://i.imgur.com/KKaGud6.png');
      else var alpha2 = loader.load('tex/table04.png');
      if(Islocal != 1) var alpha = loader.load('https://i.imgur.com/gcqu2PW.png')
      else var alpha = loader.load('tex/table05.png');
      
      
      
      

      var geometry = new THREE.BoxGeometry(50, 3, 25);
      var table = new THREE.Mesh(geometry, texMat);
      table.position.y = 25;
      scene.add(table);

      var Rtable = new THREE.Mesh(geometry, texMat);
      Rtable.position.y = 25;
      sceneRTT.add(Rtable);

      
      var table1 = new THREE.Mesh(new THREE.PlaneGeometry(50, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add(table1);
      table.add(table1);
      table1.position.z = 12.51;
      table1.position.y = -8.5;  

      var Rtable1 = new THREE.Mesh(new THREE.PlaneGeometry(50, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      sceneRTT.add(Rtable1);
      Rtable.add(Rtable1);
      Rtable1.position.z = 12.51;
      Rtable1.position.y = -8.5;  

      
      var table2 = new THREE.Mesh(new THREE.PlaneGeometry(50, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add(table2);
      table.add(table2);
      table2.position.z = -12.51;
      table2.position.y = -8.5;  

      var Rtable2 = new THREE.Mesh(new THREE.PlaneGeometry(50, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      sceneRTT.add(Rtable2);
      Rtable.add(Rtable2);
      Rtable2.position.z = -12.51;
      Rtable2.position.y = -8.5;  

      
      var table3 = new THREE.Mesh(new THREE.PlaneGeometry(25.02, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha2,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add(table3);
      table.add(table3);
      table3.position.x = 25.01;
      table3.position.y = -8.5;  
      table3.rotation.y += Math.PI/2;

      var Rtable3 = new THREE.Mesh(new THREE.PlaneGeometry(25.02, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha2,
        transparent: true,
        side: THREE.DoubleSide
      }));

      sceneRTT.add(Rtable3);
      Rtable.add(Rtable3);
      Rtable3.position.x = 25.01;
      Rtable3.position.y = -8.5;  
      Rtable3.rotation.y += Math.PI/2;
      
      
      var table4 = new THREE.Mesh(new THREE.PlaneGeometry(25.02, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha2,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add(table4);
      table.add(table4);
      table4.position.x = -25.01;
      table4.position.y = -8.5;  
      table4.rotation.y += Math.PI/2;

      var Rtable4 = new THREE.Mesh(new THREE.PlaneGeometry(25.02, 20), new THREE.MeshPhongMaterial({
        map: tex,
        alphaMap:alpha2,
        transparent: true,
        side: THREE.DoubleSide
      }));

      sceneRTT.add(Rtable4);
      Rtable.add(Rtable4);
      Rtable4.position.x = -25.01;
      Rtable4.position.y = -8.5;  
      Rtable4.rotation.y += Math.PI/2;

      
      
      
      var geometry = new THREE.CylinderGeometry( 3, 3, 25, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -12.5;
      
      table.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -12.5;
      
      Rtable.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 3, 12, 4, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = - 22.5;
      
      table.add(cylinder);
      
      table.position.x = x;
      table.position.z = z;

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = - 22.5;
      
      Rtable.add(Rcylinder);
      
      Rtable.position.x = x;
      Rtable.position.z = z;

      
      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair1 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair1 );
      chair1.position.z = -25;
      chair1.position.x = -12.5;
      chair1.position.y = -8;
      table.add(chair1);

      var Rchair1 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair1 );
      Rchair1.position.z = -25;
      Rchair1.position.x = -12.5;
      Rchair1.position.y = -8;
      Rtable.add(Rchair1);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 20, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -10;
      chair1.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -10;
      Rchair1.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -15.5;
      chair1.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -15.5;
      Rchair1.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair2 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair2 );
      chair2.position.z = -25;
      chair2.position.x = 12.5;
      chair2.position.y = -8;
      table.add(chair2);

      var Rchair2 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair2 );
      Rchair2.position.z = -25;
      Rchair2.position.x = 12.5;
      Rchair2.position.y = -8;
      Rtable.add(Rchair2);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 20, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -10;
      chair2.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -10;
      Rchair2.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -15.5;
      chair2.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -15.5;
      Rchair2.add(Rcylinder);

      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair3 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair3 );
      chair3.position.z = 25;
      chair3.position.x = -12.5;
      chair3.position.y = -8;
      table.add(chair3);

      var Rchair3 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair3 );
      Rchair3.position.z = 25;
      Rchair3.position.x = -12.5;
      Rchair3.position.y = -8;
      Rtable.add(Rchair3);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 20, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -10;
      chair3.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -10;
      Rchair3.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -15.5;
      chair3.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -15.5;
      Rchair3.add(Rcylinder);

      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair4 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair4 );
      chair4.position.z = 25;
      chair4.position.x = 12.5;
      chair4.position.y = -8;
      table.add(chair4);

      var Rchair4 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair4 );
      Rchair4.position.z = 25;
      Rchair4.position.x = 12.5;
      Rchair4.position.y = -8;
      Rtable.add(Rchair4);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 20, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -10;
      chair4.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -10;
      Rchair4.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -15.5;
      chair4.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -15.5;
      Rchair4.add(Rcylinder);
      
      if(R == 1) table.rotation.y += Math.PI/2;
      if(R == 1) Rtable.rotation.y += Math.PI/2;
    }

    function counter(x,z){
      var loader = new THREE.TextureLoader();

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/O3szElw.jpg');
      else var texture = new THREE.TextureLoader().load('tex/counter01.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      if(Islocal != 1) var texture2 = new THREE.TextureLoader().load('https://i.imgur.com/Wvoy1mm.jpg');
      else var texture2 = new THREE.TextureLoader().load('tex/counter02.jpg');

      var texMat2 = new THREE.MeshPhongMaterial({
        map: texture2
      });
      
      if(Islocal != 1) var texture3 = new THREE.TextureLoader().load('https://i.imgur.com/I9NueiU.jpg');
      else var texture3 = new THREE.TextureLoader().load('tex/counter03.jpg');

      var texMat3 = new THREE.MeshPhongMaterial({
        map: texture3
      });

      var geometry = new THREE.BoxGeometry(15, 40, 150);
      var counter = new THREE.Mesh(geometry, texMat);
      scene.add(counter);
      counter.position.x = x;
      counter.position.z = z;
      counter.position.y = 20;

      var Rcounter = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rcounter);
      Rcounter.position.x = x;
      Rcounter.position.z = z;
      Rcounter.position.y = 20;

      
      var geometry = new THREE.BoxGeometry(15, 5, 150);
      var box = new THREE.Mesh(geometry, texMat);
      scene.add(box);
      counter.add(box);
      box.position.x = 15;
      box.position.y = 5;

      var Rbox = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbox);
      Rcounter.add(Rbox);
      Rbox.position.x = 15;
      Rbox.position.y = 5;
      
      
      var geometry = new THREE.BoxGeometry(130, 40, 15);
      var box = new THREE.Mesh(geometry, texMat);
      scene.add(box);
      counter.add(box);
      box.position.z = 82.5;
      box.position.x = 57.5;

      var Rbox = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbox);
      Rcounter.add(Rbox);
      Rbox.position.z = 82.5;
      Rbox.position.x = 57.5;
      
      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair1 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair1 );
      chair1.position.z = -25;
      chair1.position.x = 50;
      chair1.position.y = -3;
      counter.add(chair1);

      var Rchair1 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair1 );
      Rchair1.position.z = -25;
      Rchair1.position.x = 50;
      Rchair1.position.y = -3;
      Rcounter.add(Rchair1);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 20, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -10;
      chair1.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -10;
      Rchair1.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -15.5;
      chair1.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -15.5;
      Rchair1.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair2 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair2 );
      chair2.position.z = 25;
      chair2.position.x = 50;
      chair2.position.y = -3;
      counter.add(chair2);

      var Rchair2 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair2 );
      Rchair2.position.z = 25;
      Rchair2.position.x = 50;
      Rchair2.position.y = -3;
      Rcounter.add(Rchair2);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 20, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -10;
      chair2.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -10;
      Rchair2.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -15.5;
      chair2.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -15.5;
      Rchair2.add(Rcylinder);
    }

    function restroom(x,z){
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      var geometry = new THREE.BoxGeometry(209.9, 100, 10);
      var backwall = new THREE.Mesh(geometry, texMat);
      scene.add(backwall);
      backwall.position.y = 50;
      backwall.position.x = x;
      backwall.position.z = z;

      var Rbackwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbackwall);
      Rbackwall.position.y = 50;
      Rbackwall.position.x = x;
      Rbackwall.position.z = z;

      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 109.9);
      var fleftwall = new THREE.Mesh(geometry, texMat);
      scene.add(fleftwall);
      backwall.add(fleftwall);
      fleftwall.position.x = -100;
      fleftwall.position.z = 50;

      var Rfleftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rfleftwall);
      Rbackwall.add(Rfleftwall);
      Rfleftwall.position.x = -100;
      Rfleftwall.position.z = 50;

      
      var geometry = new THREE.BoxGeometry(10, 100, 109.9);
      var bleftwall = new THREE.Mesh(geometry, texMat);
      scene.add(bleftwall);
      backwall.add(bleftwall);
      bleftwall.position.x = -100;
      bleftwall.position.z = 250;

      var Rbleftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbleftwall);
      Rbackwall.add(Rbleftwall);
      Rbleftwall.position.x = -100;
      Rbleftwall.position.z = 250;

      
      var geometry = new THREE.BoxGeometry(10, 100, 109.9);
      var ileftwall = new THREE.Mesh(geometry, texMat);
      scene.add(ileftwall);
      backwall.add(ileftwall);
      ileftwall.position.x = -50;
      ileftwall.position.z = 150;

      var Rileftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rileftwall);
      Rbackwall.add(Rileftwall);
      Rileftwall.position.x = -50;
      Rileftwall.position.z = 150;
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.05, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      
      var geometry = new THREE.BoxGeometry(9.9, 100);
      var fleftwallh = new THREE.Mesh(geometry, texMat);
      scene.add(fleftwallh);
      backwall.add(fleftwallh);
      fleftwallh.position.x = -100;
      fleftwallh.position.z = 104.5;

      var Rfleftwallh = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rfleftwallh);
      Rbackwall.add(Rfleftwallh);
      Rfleftwallh.position.x = -100;
      Rfleftwallh.position.z = 104.5;

      
      var geometry = new THREE.BoxGeometry(9.9, 100);
      var bleftwallh = new THREE.Mesh(geometry, texMat);
      scene.add(bleftwallh);
      backwall.add(bleftwallh);
      bleftwallh.position.x = -100;
      bleftwallh.position.z = 195.5;

      var Rbleftwallh = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbleftwallh);
      Rbackwall.add(Rbleftwallh);
      Rbleftwallh.position.x = -100;
      Rbleftwallh.position.z = 195.5;

      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.15, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(40, 100);
      var fdoorwall = new THREE.Mesh(geometry, texMat);
      scene.add(fdoorwall);
      backwall.add(fdoorwall);
      fdoorwall.position.x = -75;
      fdoorwall.position.z = 95.6;

      var Rfdoorwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rfdoorwall);
      Rbackwall.add(Rfdoorwall);
      Rfdoorwall.position.x = -75;
      Rfdoorwall.position.z = 95.6;

      
      var geometry = new THREE.BoxGeometry(40, 100);
      var fdoorwall = new THREE.Mesh(geometry, texMat);
      scene.add(fdoorwall);
      backwall.add(fdoorwall);
      fdoorwall.position.x = -75;
      fdoorwall.position.z = 203.6;

      var Rfdoorwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rfdoorwall);
      Rbackwall.add(Rfdoorwall);
      Rfdoorwall.position.x = -75;
      Rfdoorwall.position.z = 203.6;

      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/skdK9KX.png');
      else var texture = new THREE.TextureLoader().load('tex/restroom01.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(40, 80);
      var rdm = new THREE.Mesh(geometry, texMat);
      scene.add(rdm);
      backwall.add(rdm);
      rdm.position.x = -75;
      rdm.position.y = -10;
      rdm.position.z = 203.3;

      var Rrdm = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrdm);
      Rbackwall.add(Rrdm);
      Rrdm.position.x = -75;
      Rrdm.position.y = -10;
      Rrdm.position.z = 203.3;
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/MUaGcp3.png');
      else var texture = new THREE.TextureLoader().load('tex/restroom02.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(40, 80);
      var rdf = new THREE.Mesh(geometry, texMat);
      scene.add(rdf);
      backwall.add(rdf);
      rdf.position.x = -75;
      rdf.position.y = -10;
      rdf.position.z = 96.08;

      var Rrdf = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrdf);
      Rbackwall.add(Rrdf);
      Rrdf.position.x = -75;
      Rrdf.position.y = -10;
      Rrdf.position.z = 96.08;
      
      
      
      makesink(280,-625);
      makesink(280,-575);
      
      makesink(280,-430);
      makesink(280,-380);
      
    }

    function makesink(x,z){
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/FM8caZz.jpg');
      else var texture = new THREE.TextureLoader().load('tex/sink01.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(20, 25, 45 );
      var sink = new THREE.Mesh(geometry, texMat);
      scene.add(sink);
      sink.position.x = x;
      sink.position.y = 12.5;
      sink.position.z = z;

      var Rsink = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rsink);
      Rsink.position.x = x;
      Rsink.position.y = 12.5;
      Rsink.position.z = z;

      
      var geometry = new THREE.BoxGeometry(20, 30, 3 );
      var box = new THREE.Mesh(geometry, texMat);
      scene.add(box);
      sink.add(box);
      box.position.y = 2.5;
      box.position.z = 24;

      var Rbox = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbox);
      Rsink.add(Rbox);
      Rbox.position.y = 2.5;
      Rbox.position.z = 24;

      
      var geometry = new THREE.BoxGeometry(20, 30, 3 );
      var box = new THREE.Mesh(geometry, texMat);
      scene.add(box);
      sink.add(box);
      box.position.y = 2.5;
      box.position.z = -24;

      var Rbox = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbox);
      Rsink.add(Rbox);
      Rbox.position.y = 2.5;
      Rbox.position.z = -24;

      
      var geometry = new THREE.BoxGeometry(3, 30, 50 );
      var box = new THREE.Mesh(geometry, texMat);
      scene.add(box);
      sink.add(box);
      box.position.y = 2.49;
      box.position.x = -8.51;

      var Rbox = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbox);
      Rsink.add(Rbox);
      Rbox.position.y = 2.49;
      Rbox.position.x = -8.51;

      
      var geometry = new THREE.BoxGeometry(8, 30, 50.9 );
      var box = new THREE.Mesh(geometry, texMat);
      scene.add(box);
      sink.add(box);
      box.position.y = 2.51;
      box.position.x = 11.01;

      var Rbox = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbox);
      Rsink.add(Rbox);
      Rbox.position.y = 2.51;
      Rbox.position.x = 11.01;

      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/KcLkzzZ.jpg');
      else var texture = new THREE.TextureLoader().load('tex/sink02.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      
      var geometry = new THREE.TorusGeometry( 5, 1, 16, 100, 3.2 );
      var torus = new THREE.Mesh( geometry, texMat );
      scene.add( torus );
      torus.position.y = 25;
      torus.position.x = 5;
      sink.add(torus);

      var Rtorus = new THREE.Mesh( geometry, texMat );
      sceneRTT.add( Rtorus );
      Rtorus.position.y = 25;
      Rtorus.position.x = 5;
      Rsink.add(Rtorus);

      
      var geometry = new THREE.CylinderGeometry( 1, 1, 10, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat );
      scene.add( cylinder );
      cylinder.position.y = 20;
      cylinder.position.x = 10;
      sink.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = 20;
      Rcylinder.position.x = 10;
      Rsink.add(Rcylinder);
    }

    function storeroom(x,z){
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.7, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      
      var geometry = new THREE.BoxGeometry(130, 100, 20);
      var storewall = new THREE.Mesh(geometry, texMat);
      scene.add(storewall);
      storewall.position.y = 50;
      storewall.position.x = x;
      storewall.position.z = z;

      var Rstorewall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstorewall);
      Rstorewall.position.y = 50;
      Rstorewall.position.x = x;
      Rstorewall.position.z = z;
      
      
      var geometry = new THREE.BoxGeometry(10, 100, 130);
      var storewall2 = new THREE.Mesh(geometry, texMat);
      scene.add(storewall2);
      storewall.add(storewall2);
      storewall2.position.x = 65;
      storewall2.position.z = 135;

      var Rstorewall2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstorewall2);
      Rstorewall.add(Rstorewall2);
      Rstorewall2.position.x = 65;
      Rstorewall2.position.z = 135;
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.1, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 24.9);
      var storewall3 = new THREE.Mesh(geometry, texMat);
      scene.add(storewall3);
      storewall.add(storewall3);
      storewall3.position.x = 65;
      storewall3.position.z = 2.5;

      var Rstorewall3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstorewall3);
      Rstorewall.add(Rstorewall3);
      Rstorewall3.position.x = 65;
      Rstorewall3.position.z = 2.5;
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(1, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 200);
      var leftstorewall = new THREE.Mesh(geometry, texMat);
      scene.add(leftstorewall);
      storewall.add(leftstorewall);
      leftstorewall.position.x = -165;
      leftstorewall.position.z = 100;

      var Rleftstorewall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rleftstorewall);
      Rstorewall.add(Rleftstorewall);
      Rleftstorewall.position.x = -165;
      Rleftstorewall.position.z = 100;
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.1, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.PlaneGeometry(10, 100);
      var storewall2h = new THREE.Mesh(geometry, texMat);
      scene.add(storewall2h);
      storewall2.add(storewall2h);
      storewall2h.position.z = -65.1;
      storewall2h.rotation.y += Math.PI;

      var Rstorewall2h = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstorewall2h);
      Rstorewall2.add(Rstorewall2h);
      Rstorewall2h.position.z = -65.1;
      Rstorewall2h.rotation.y += Math.PI;
      
      /*
      var texture = new THREE.TextureLoader().load('https://i.imgur.com/eNW4WXs.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(5, 100, 55);
      var storedoor = new THREE.Mesh(geometry, texMat);
      scene.add(storedoor);
      storewall.add(storedoor);
      storedoor.position.x = 40;
      storedoor.position.z = 24.5;
      storedoor.rotation.y -= 1.3;
      
      
      var texture = new THREE.TextureLoader().load('https://i.imgur.com/eNW4WXs.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.01, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.PlaneGeometry(5, 100);
      var storedoorh = new THREE.Mesh(geometry, texMat);
      scene.add(storedoorh);
      storedoor.add(storedoorh);
      storedoorh.position.z = 27.52;
      
      var geometry = new THREE.PlaneGeometry(5, 100);
      var storedoorh2 = new THREE.Mesh(geometry, texMat);
      scene.add(storedoorh2);
      storedoor.add(storedoorh2);
      storedoorh2.position.z = -27.52;
      storedoorh2.rotation.y += Math.PI; 
      */
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/mdXDao3.png');
      else var texture = new THREE.TextureLoader().load('tex/diningfloor.png');


      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(3/5, 6/5);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;

      
      var geometry = new THREE.PlaneGeometry(110, 200);
      var storefloor = new THREE.Mesh(geometry, texMat);
      scene.add(storefloor);
      storefloor.rotation.x = -Math.PI / 2;
      storefloor.position.x = -105.1;
      storefloor.position.y = -50;
      storefloor.position.z = 100;
      
      storewall.add(storefloor);

      var Rstorefloor = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstorefloor);
      Rstorefloor.rotation.x = -Math.PI / 2;
      Rstorefloor.position.x = -105.1;
      Rstorefloor.position.y = -50;
      Rstorefloor.position.z = 100;
      
      Rstorewall.add(Rstorefloor);

      storeroomtables(-400,-368);
      storeroomtables(-450,-368);
      
    }

    function storeroomtables(x,z){
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var texture = new THREE.TextureLoader().load('tex/table01.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      if(Islocal != 1) var texture2 = new THREE.TextureLoader().load('https://i.imgur.com/Wvoy1mm.jpg');
      else var texture2 = new THREE.TextureLoader().load('tex/table02.jpg');

      var texMat2 = new THREE.MeshPhongMaterial({
        map: texture2
      });
      
      if(Islocal != 1) var texture3 = new THREE.TextureLoader().load('https://i.imgur.com/I9NueiU.jpg');
      else var texture3 = new THREE.TextureLoader().load('tex/table03.jpg');

      var texMat3 = new THREE.MeshPhongMaterial({
        map: texture3
      });
      
      
      

      var geometry = new THREE.BoxGeometry(50, 3, 25);
      var table = new THREE.Mesh(geometry, texMat);
      scene.add(table);
      table.position.y = 25;

      var Rtable = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rtable);
      Rtable.position.y = 25;
      
      
      
      var geometry = new THREE.CylinderGeometry( 3, 3, 25, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -12.5;
      
      table.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -12.5;
      
      Rtable.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 3, 12, 4, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = - 23;
      
      table.add(cylinder);
      
      table.position.x = x;
      table.position.z = z;

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = - 23;
      
      Rtable.add(Rcylinder);
      
      Rtable.position.x = x;
      Rtable.position.z = z;
      
      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair1 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair1 );
      chair1.position.z = -25;
      chair1.position.x = -12.5;
      chair1.position.y = -8;
      table.add(chair1);

      var Rchair1 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair1 );
      Rchair1.position.z = -25;
      Rchair1.position.x = -12.5;
      Rchair1.position.y = -8;
      Rtable.add(Rchair1);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 15, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -7.5;
      chair1.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -7.5;
      Rchair1.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -16;
      chair1.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -16;
      Rchair1.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair2 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair2 );
      chair2.position.z = -25;
      chair2.position.x = 12.5;
      chair2.position.y = -8;
      table.add(chair2);

      var Rchair2 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair2 );
      Rchair2.position.z = -25;
      Rchair2.position.x = 12.5;
      Rchair2.position.y = -8;
      Rtable.add(Rchair2);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 15, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -7.5;
      chair2.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -7.5;
      Rchair2.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -16;
      chair2.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -16;
      Rchair2.add(Rcylinder);

      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair3 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair3 );
      chair3.position.z = -45;
      chair3.position.x = -12.5;
      chair3.position.y = -8;
      table.add(chair3);

      var Rchair3 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair3 );
      Rchair3.position.z = -45;
      Rchair3.position.x = -12.5;
      Rchair3.position.y = -8;
      Rtable.add(Rchair3);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 15, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -7.5;
      chair3.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -7.5;
      Rchair3.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -16;
      chair3.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -16;
      Rchair3.add(Rcylinder);

      
      var geometry = new THREE.CylinderGeometry( 8, 8, 3, 32 );
      var chair4 = new THREE.Mesh( geometry, texMat3 );
      scene.add( chair4 );
      chair4.position.z = -45;
      chair4.position.x = 12.5;
      chair4.position.y = -8;
      table.add(chair4);

      var Rchair4 = new THREE.Mesh( geometry, texMat3 );
      sceneRTT.add( Rchair4 );
      Rchair4.position.z = -45;
      Rchair4.position.x = 12.5;
      Rchair4.position.y = -8;
      Rtable.add(Rchair4);

      
      var geometry = new THREE.CylinderGeometry( 1.5, 1.5, 15, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -7.5;
      chair4.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -7.5;
      Rchair4.add(Rcylinder);
      
      
      var geometry = new THREE.CylinderGeometry( 1.5, 5, 2, 32 );
      var cylinder = new THREE.Mesh( geometry, texMat2 );
      scene.add( cylinder );
      cylinder.position.y = -16;
      chair4.add(cylinder);

      var Rcylinder = new THREE.Mesh( geometry, texMat2 );
      sceneRTT.add( Rcylinder );
      Rcylinder.position.y = -16;
      Rchair4.add(Rcylinder);
      
    }

    function kitchen(x,z){

      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(1.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(300, 100, 10);
      var backwall = new THREE.Mesh(geometry, texMat);
      scene.add(backwall);
      backwall.position.z = z;
      backwall.position.y = 50;
      backwall.position.x = x;

      var Rbackwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbackwall);
      Rbackwall.position.z = z;
      Rbackwall.position.y = 50;
      Rbackwall.position.x = x;
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(1.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(300, 100, 20);
      var frontwall = new THREE.Mesh(geometry, texMat);
      scene.add(frontwall);
      frontwall.position.z = 400;
      backwall.add(frontwall);

      var Rfrontwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rfrontwall);
      Rfrontwall.position.z = 400;
      Rbackwall.add(Rfrontwall);
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');
      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(1.5, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 300);
      var frontleftwall = new THREE.Mesh(geometry, texMat);
      scene.add(frontleftwall);
      frontleftwall.position.z = 250;
      frontleftwall.position.x = -150;
      backwall.add(frontleftwall);

      var Rfrontleftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rfrontleftwall);
      Rfrontleftwall.position.z = 250;
      Rfrontleftwall.position.x = -150;
      Rbackwall.add(Rfrontleftwall);
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/As3Bhdi.png');
      else var texture = new THREE.TextureLoader().load('tex/wall13.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(10, 60, 40);
      var middleleftwall = new THREE.Mesh(geometry, texMat);
      scene.add(middleleftwall);
      middleleftwall.position.z = 80;
      middleleftwall.position.y = -20;
      middleleftwall.position.x = -150;
      backwall.add(middleleftwall);
      
      var Rmiddleleftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rmiddleleftwall);
      Rmiddleleftwall.position.z = 80;
      Rmiddleleftwall.position.y = -20;
      Rmiddleleftwall.position.x = -150;
      Rbackwall.add(Rmiddleleftwall);
      
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/G634HPV.png');
      else var texture = new THREE.TextureLoader().load('tex/wall12.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      texture.repeat.set(0.3, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 100, 60);
      var backleftwall = new THREE.Mesh(geometry, texMat);
      scene.add(backleftwall);
      backleftwall.position.z = 30;
      backleftwall.position.x = -150;
      backwall.add(backleftwall);

      var Rbackleftwall = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rbackleftwall);
      Rbackleftwall.position.z = 30;
      Rbackleftwall.position.x = -150;
      Rbackwall.add(Rbackleftwall);
      
      
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/ZUWRF8R.jpg');
      else var texture = new THREE.TextureLoader().load('tex/ventinside.jpg');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      var geometry = new THREE.BoxGeometry(80, 2, 40);
      var windows1 = new THREE.Mesh(geometry, texMat);
      scene.add(windows1);
      windows1.position.y = 50;
      windows1.position.z = 80;
      windows1.position.x = -185;
      backwall.add(windows1);

      var Rwindows1 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rwindows1);
      Rwindows1.position.y = 50;
      Rwindows1.position.z = 80;
      Rwindows1.position.x = -185;
      Rbackwall.add(Rwindows1);

      
      var geometry = new THREE.BoxGeometry(80, 2, 40);
      var windows2 = new THREE.Mesh(geometry, texMat);
      scene.add(windows2);
      windows2.position.y = 10;
      windows2.position.z = 80;
      windows2.position.x = -185;
      backwall.add(windows2);

      var Rwindows2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rwindows2);
      Rwindows2.position.y = 10;
      Rwindows2.position.z = 80;
      Rwindows2.position.x = -185;
      Rbackwall.add(Rwindows2);
      
      
      var geometry = new THREE.BoxGeometry(80, 38, 2);
      var windows3 = new THREE.Mesh(geometry, texMat);
      scene.add(windows3);
      windows3.position.y = 30;
      windows3.position.z = 61;
      windows3.position.x = -185;
      backwall.add(windows3);

      var Rwindows3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rwindows3);
      Rwindows3.position.y = 30;
      Rwindows3.position.z = 61;
      Rwindows3.position.x = -185;
      Rbackwall.add(Rwindows3);
      
      
      var geometry = new THREE.BoxGeometry(80, 38, 2);
      var windows4 = new THREE.Mesh(geometry, texMat);
      scene.add(windows4);
      windows4.position.y = 30;
      windows4.position.z = 99;
      windows4.position.x = -185;
      backwall.add(windows4);

      var Rwindows4 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rwindows4);
      Rwindows4.position.y = 30;
      Rwindows4.position.z = 99;
      Rwindows4.position.x = -185;
      Rbackwall.add(Rwindows4);
      


      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/mdXDao3.png');
      else var texture = new THREE.TextureLoader().load('tex/diningfloor.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(9/5, 12/5);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;

      
      var geometry = new THREE.PlaneGeometry(300, 400);
      var kitchenfloor = new THREE.Mesh(geometry, texMat);
      scene.add(kitchenfloor);
      backwall.add(kitchenfloor);
      kitchenfloor.rotation.x = -Math.PI / 2;
      kitchenfloor.position.y = -50;
      kitchenfloor.position.z = 192;

      var Rkitchenfloor = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rkitchenfloor);
      Rbackwall.add(Rkitchenfloor);
      Rkitchenfloor.rotation.x = -Math.PI / 2;
      Rkitchenfloor.position.y = -50;
      Rkitchenfloor.position.z = 192;
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/kPmETQG.png');
      else var texture = new THREE.TextureLoader().load('tex/wall14.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      texture.repeat.set(0.625, 1);
      texture.wrapS = THREE.RepeatWrapping;
      texture.wrapT = THREE.RepeatWrapping;
      
      var geometry = new THREE.BoxGeometry(10, 42, 125);
      var counter = new THREE.Mesh(geometry, texMat);
      scene.add(counter);
      counter.position.z = 237.5;
      counter.position.y = -29.5;
      counter.position.x = 150;
      backwall.add(counter);

      var Rcounter = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rcounter);
      Rcounter.position.z = 237.5;
      Rcounter.position.y = -29.5;
      Rcounter.position.x = 150;
      Rbackwall.add(Rcounter);
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/vDGQV3k.jpg');
      else var texture = new THREE.TextureLoader().load('tex/kitchen01.jpg');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(20, 5, 125);
      var counter2 = new THREE.Mesh(geometry, texMat);
      scene.add(counter2);
      counter2.position.z = 237.5;
      counter2.position.y = -6;
      counter2.position.x = 150;
      backwall.add(counter2);

      var Rcounter2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rcounter2);
      Rcounter2.position.z = 237.5;
      Rcounter2.position.y = -6;
      Rcounter2.position.x = 150;
      Rbackwall.add(Rcounter2);
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/6rpZyxp.png');
      else var texture = new THREE.TextureLoader().load('tex/wall15.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(10, 20, 125);
      var counter3 = new THREE.Mesh(geometry, texMat);
      scene.add(counter3);
      counter3.position.z = 237.5;
      counter3.position.y = 40;
      counter3.position.x = 150;
      backwall.add(counter3);

      var Rcounter3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rcounter3);
      Rcounter3.position.z = 237.5;
      Rcounter3.position.y = 40;
      Rcounter3.position.x = 150;
      Rbackwall.add(Rcounter3);
      
      
      stove(-775,-760);
      stove(-775,-680);
      stove(-775,-600);
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/pzdqvl6.png');
      else var texture = new THREE.TextureLoader().load('tex/vent.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(40, 40, 5);
      var vent = new THREE.Mesh(geometry, texMat);
      scene.add(vent);
      vent.position.z = 18.3;
      vent.position.y = -32;
      vent.position.x = -120;
      backwall.add(vent);
      vent.rotation.x = -0.6;

      var Rvent = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rvent);
      Rvent.position.z = 18.3;
      Rvent.position.y = -32;
      Rvent.position.x = -120;
      Rbackwall.add(Rvent);
      Rvent.rotation.x = -0.6;
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/jQtGxCr.png');
      else var texture = new THREE.TextureLoader().load('tex/vent02.png');

      texMat = new THREE.MeshPhongMaterial({
        map: texture
      });
      
      var geometry = new THREE.PlaneGeometry(5, 40);
      var venth = new THREE.Mesh(geometry, texMat);
      scene.add(venth);
      venth.rotation.y = Math.PI/2;
      venth.position.x = 20.1;
      vent.add(venth);

      var Rventh = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rventh);
      Rventh.rotation.y = Math.PI/2;
      Rventh.position.x = 20.1;
      Rvent.add(Rventh);

      
      var venth2 = new THREE.Mesh(geometry, texMat);
      scene.add(venth2);
      venth2.rotation.y = -Math.PI/2;
      venth2.position.x = -20.1;
      vent.add(venth2);

      var Rventh2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rventh2);
      Rventh2.rotation.y = -Math.PI/2;
      Rventh2.position.x = -20.1;
      Rvent.add(Rventh2);

      
      var geometry = new THREE.PlaneGeometry(40, 5);
      var venth3 = new THREE.Mesh(geometry, texMat);
      scene.add(venth3);
      venth3.rotation.x = -Math.PI/2;
      venth3.position.y = 20.1;
      vent.add(venth3);

      var Rventh3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rventh3);
      Rventh3.rotation.x = -Math.PI/2;
      Rventh3.position.y = 20.1;
      Rvent.add(Rventh3);
      
      
      var venth4 = new THREE.Mesh(geometry, texMat);
      scene.add(venth4);
      venth4.rotation.x = Math.PI/2;
      venth4.position.y = -20.1;
      vent.add(venth4);

      var Rventh4 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rventh4);
      Rventh4.rotation.x = Math.PI/2;
      Rventh4.position.y = -20.1;
      Rvent.add(Rventh4);
      
      kitchentable(-620,-680);

    }

    function stove(x,z){
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/698O6a8.jpg');
      else var texture = new THREE.TextureLoader().load('tex/stove01.jpg');

      var texMat = new THREE.MeshLambertMaterial({
        map: texture
      });
      
      var geometry = new THREE.BoxGeometry(40, 50, 80);
      var stove = new THREE.Mesh(geometry, texMat);
      scene.add(stove);
      stove.position.z = z;
      stove.position.y = 20;
      stove.position.x = x;
      stove.rotation.z = Math.PI/2;

      var Rstove = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstove);
      Rstove.position.z = z;
      Rstove.position.y = 20;
      Rstove.position.x = x;
      Rstove.rotation.z = Math.PI/2;
      
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/s8I2ouP.jpg');
      else var texture = new THREE.TextureLoader().load('tex/stove02.jpg');

      texMat = new THREE.MeshLambertMaterial({
        map: texture
      });
      
      var geometry = new THREE.PlaneGeometry(40, 50);
      var stoveh = new THREE.Mesh(geometry, texMat);
      scene.add(stoveh);
      stoveh.position.z = 40.1;
      stove.add(stoveh);

      var Rstoveh = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstoveh);
      Rstoveh.position.z = 40.1;
      Rstove.add(Rstoveh);

      
      var stoveh2 = new THREE.Mesh(geometry, texMat);
      scene.add(stoveh2);
      stoveh2.position.z = -40.1;
      stoveh2.rotation.y = Math.PI;
      stove.add(stoveh2);

      var Rstoveh2 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstoveh2);
      Rstoveh2.position.z = -40.1;
      Rstoveh2.rotation.y = Math.PI;
      Rstove.add(Rstoveh2);

      
      var geometry = new THREE.PlaneGeometry(40, 80);
      var stoveh3 = new THREE.Mesh(geometry, texMat);
      scene.add(stoveh3);
      stoveh3.position.y = -25.1;
      stoveh3.rotation.x = Math.PI/2;
      stove.add(stoveh3);

      var Rstoveh3 = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rstoveh3);
      Rstoveh3.position.y = -25.1;
      Rstoveh3.rotation.x = Math.PI/2;
      Rstove.add(Rstoveh3);
      
      
      var geometry = new THREE.BoxGeometry(50, 5, 80);
      var rangehood = new THREE.Mesh(geometry, texMat);
      scene.add(rangehood);
      rangehood.position.x = 56;
      rangehood.rotation.z = Math.PI/2;
      stove.add(rangehood);

      var Rrangehood = new THREE.Mesh(geometry, texMat);
      sceneRTT.add(Rrangehood);
      Rrangehood.position.x = 56;
      Rrangehood.rotation.z = Math.PI/2;
      Rstove.add(Rrangehood);
      
      if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/Wvoy1mm.jpg');
      else var texture = new THREE.TextureLoader().load('tex/table02.jpg');

      texMat = new THREE.MeshLambertMaterial({
        map: texture
      });
      
      var geometry = new THREE.TorusBufferGeometry( 15, 8, 16, 100, 1.5 );
      var rangehood2 = new THREE.Mesh( geometry, texMat );
      scene.add( rangehood2 );
      stove.add(rangehood2);
      rangehood2.position.x = 56;
      rangehood2.position.y = 25;
      rangehood2.rotation.x = Math.PI;

      var Rrangehood2 = new THREE.Mesh( geometry, texMat );
      sceneRTT.add( Rrangehood2 );
      Rstove.add(Rrangehood2);
      Rrangehood2.position.x = 56;
      Rrangehood2.position.y = 25;
      Rrangehood2.rotation.x = Math.PI;
    }

    function kitchentable(x,z){
          if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/Wvoy1mm.jpg');
        else var texture = new THREE.TextureLoader().load('tex/table02.jpg');

        var texMat = new THREE.MeshPhongMaterial({
          map: texture
        });
        
        var geometry = new THREE.BoxGeometry(140, 5, 100);
        var ktable = new THREE.Mesh(geometry, texMat);
        scene.add(ktable);
        ktable.rotation.y = Math.PI/2;
        ktable.position.z = z;
        ktable.position.x = x;
        ktable.position.y = 40;

        var Rktable = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rktable);
        Rktable.rotation.y = Math.PI/2;
        Rktable.position.z = z;
        Rktable.position.x = x;
        Rktable.position.y = 40;
        
        if(Islocal != 1) texture = new THREE.TextureLoader().load('https://i.imgur.com/VuUCXhj.jpg');
        else var texture = new THREE.TextureLoader().load('tex/kitchen02.jpg');

        texMat = new THREE.MeshPhongMaterial({
          map: texture
        });
        
        
        var geometry = new THREE.BoxGeometry(8, 40, 8);
        var ktable1 = new THREE.Mesh(geometry, texMat);
        scene.add(ktable1);
        ktable1.position.z = -40;
        ktable1.position.x = 60;
        ktable1.position.y = -20;
        ktable.add(ktable1);

        var Rktable1 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rktable1);
        Rktable1.position.z = -40;
        Rktable1.position.x = 60;
        Rktable1.position.y = -20;
        Rktable.add(Rktable1);

        
        var ktable2 = new THREE.Mesh(geometry, texMat);
        scene.add(ktable2);
        ktable2.position.z = 40;
        ktable2.position.x = 60;
        ktable2.position.y = -20;
        ktable.add(ktable2);

        var Rktable2 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rktable2);
        Rktable2.position.z = 40;
        Rktable2.position.x = 60;
        Rktable2.position.y = -20;
        Rktable.add(Rktable2);

        
        var ktable3 = new THREE.Mesh(geometry, texMat);
        scene.add(ktable3);
        ktable3.position.z = 40;
        ktable3.position.x = -60;
        ktable3.position.y = -20;
        ktable.add(ktable3);

        var Rktable3 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rktable3);
        Rktable3.position.z = 40;
        Rktable3.position.x = -60;
        Rktable3.position.y = -20;
        Rktable.add(Rktable3);

        
        var ktable4 = new THREE.Mesh(geometry, texMat);
        scene.add(ktable4);
        ktable4.position.z = -40;
        ktable4.position.x = -60;
        ktable4.position.y = -20;
        ktable.add(ktable4);

        var Rktable4 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rktable4);
        Rktable4.position.z = -40;
        Rktable4.position.x = -60;
        Rktable4.position.y = -20;
        Rktable.add(Rktable4);
      }
      

      function makeboxes(){
        if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/a8bRyAF.png');
        else var texture = new THREE.TextureLoader().load('tex/boxtex.png');

        var texMat = new THREE.MeshPhongMaterial({
          map: texture
        });

        var geometry = new THREE.BoxGeometry(20,20,20);
        
        //////right side
        
        var box = new THREE.Mesh(geometry, texMat);
        scene.add(box);
        box.position.set(180,10,10);
        box.rotation.y += 0.35;
        var box2 = new THREE.Mesh(geometry, texMat);
        scene.add(box2);
        box2.position.set(175,10,-15);
        box2.rotation.y -= 0.65;
        var box3 = new THREE.Mesh(geometry, texMat);
        scene.add(box3);
        box3.position.set(183,30,-5);
        box3.rotation.y -= 0.25;
        
        var box4 = new THREE.Mesh(geometry, texMat);
        scene.add(box4);
        box4.position.set(130,10,-95);
        box4.rotation.y -= 0.25;
        var box5 = new THREE.Mesh(geometry, texMat);
        scene.add(box5);
        box5.position.set(118,10,-70);
        box5.rotation.y -= 0.75;
        var box6 = new THREE.Mesh(geometry, texMat);
        scene.add(box6);
        box6.position.set(119,30,-83);
        box6.rotation.y -= 0.55;



        var Rbox = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox);
        Rbox.position.set(180,10,10);
        Rbox.rotation.y += 0.35;
        var Rbox2 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox2);
        Rbox2.position.set(175,10,-15);
        Rbox2.rotation.y -= 0.65;
        var Rbox3 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox3);
        Rbox3.position.set(183,30,-5);
        Rbox3.rotation.y -= 0.25;
        
        var Rbox4 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox4);
        Rbox4.position.set(130,10,-95);
        Rbox4.rotation.y -= 0.25;
        var Rbox5 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox5);
        Rbox5.position.set(118,10,-70);
        Rbox5.rotation.y -= 0.75;
        var Rbox6 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox6);
        Rbox6.position.set(119,30,-83);
        Rbox6.rotation.y -= 0.55;
        
        
        ////left side
        
        var box21 = new THREE.Mesh(geometry, texMat);
        scene.add(box21);
        box21.position.set(-180,10,10);
        box21.rotation.y += 0.35;
        var box22 = new THREE.Mesh(geometry, texMat);
        scene.add(box22);
        box22.position.set(-177,10,-15);
        box22.rotation.y += 0.01;
        var box23 = new THREE.Mesh(geometry, texMat);
        scene.add(box23);
        box23.position.set(-179,30,-17);
        box23.rotation.y -= 0.35;
        
        
        var box24 = new THREE.Mesh(geometry, texMat);
        scene.add(box24);
        box24.position.set(-118,10,-90);
        box24.rotation.y += 0.35;
        var box25 = new THREE.Mesh(geometry, texMat);
        scene.add(box25);
        box25.position.set(-118,30,-90);
        box25.rotation.y -= 0.25;


        var Rbox21 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox21);
        Rbox21.position.set(-180,10,10);
        Rbox21.rotation.y += 0.35;
        var Rbox22 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox22);
        Rbox22.position.set(-177,10,-15);
        Rbox22.rotation.y += 0.01;
        var Rbox23 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox23);
        Rbox23.position.set(-179,30,-17);
        Rbox23.rotation.y -= 0.35;
        
        
        var Rbox24 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox24);
        Rbox24.position.set(-118,10,-90);
        Rbox24.rotation.y += 0.35;
        var Rbox25 = new THREE.Mesh(geometry, texMat);
        sceneRTT.add(Rbox25);
        Rbox25.position.set(-118,30,-90);
        Rbox25.rotation.y -= 0.25;
        
      }

      function makemap(){

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/MAP6.png');

      var map = new THREE.Mesh(new THREE.PlaneGeometry(34, 24), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      map.position.set(0, 28, -80);
      map.rotation.x -= (Math.PI/4 + 0.135);
      scene.add(map);

      var l = 5/6;
      var l2 = 7.3/6;

      var geometry = new THREE.PlaneGeometry(2.9*l2, 2*l);
      var material = new THREE.MeshBasicMaterial( {color: 0xffe900, side: THREE.DoubleSide} );
      mapaction = new THREE.Mesh( geometry, material );
      scene.add( mapaction );
      map.add(mapaction);
      mapaction.position.set(1005, 2.5, 0.1);



    if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
    else var tex = new THREE.TextureLoader().load('tex/table01.png');
    if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
    else var alpha = new THREE.TextureLoader().load('tex/cam1.png');

    var cambuttom1 = new THREE.Mesh(new THREE.PlaneGeometry(2.9*l2, 2*l), new THREE.MeshBasicMaterial({
      map: tex,
      alphaMap:alpha,
      transparent: true,
      side: THREE.DoubleSide
    }));

    scene.add( cambuttom1 );
    map.add(cambuttom1);
    cambuttom1.position.set(5.95*l2, 2.5*l, 0.1);
    //cambuttom1.position.set(5.95*l2, 29, -80);
    //cambuttom1.rotation.x -= (Math.PI/4 + 0.135);

    cam1pickables.push(cambuttom1);
    document.addEventListener('mousedown', mapbuttom1, false);

    if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
    else var tex = new THREE.TextureLoader().load('tex/table01.png');
    if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
    else var alpha = new THREE.TextureLoader().load('tex/cam2.png');


    var cambuttom2 = new THREE.Mesh(new THREE.PlaneGeometry(2.9*l2, 2*l), new THREE.MeshBasicMaterial({
      map: tex,
      alphaMap:alpha,
      transparent: true,
      side: THREE.DoubleSide
    }));

    scene.add( cambuttom2 );
    map.add(cambuttom2);
    cambuttom2.position.set(-0.95*l2, 5.67*l, 0.1);

    cam2pickables.push(cambuttom2);
    document.addEventListener('mousedown', mapbuttom2, false);


    if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
    else var tex = new THREE.TextureLoader().load('tex/table01.png');
    if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
    else var alpha = new THREE.TextureLoader().load('tex/cam3.png');

    var cambuttom3 = new THREE.Mesh(new THREE.PlaneGeometry(2.9*l2, 2*l), new THREE.MeshBasicMaterial({
      map: tex,
      alphaMap:alpha,
      transparent: true,
      side: THREE.DoubleSide
    }));

    scene.add( cambuttom3 );
    map.add(cambuttom3);
    cambuttom3.position.set(-6.25*l2 - 0.55, -4.45*l + 0.62, 0.1);

    cam3pickables.push(cambuttom3);
    document.addEventListener('mousedown', mapbuttom3, false);

    if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
    else var tex = new THREE.TextureLoader().load('tex/table01.png');
    if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
    else var alpha = new THREE.TextureLoader().load('tex/cam4.png');

    var cambuttom4 = new THREE.Mesh(new THREE.PlaneGeometry(2.9*l2, 2*l), new THREE.MeshBasicMaterial({
      map: tex,
      alphaMap:alpha,
      transparent: true,
      side: THREE.DoubleSide
    }));

      scene.add( cambuttom4 );
      map.add(cambuttom4);
      cambuttom4.position.set(-9.9*l2, 1.55*l + 0.4, 0.1);

      cam4pickables.push(cambuttom4);
      document.addEventListener('mousedown', mapbuttom4, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/cam5.png');

      var cambuttom5 = new THREE.Mesh(new THREE.PlaneGeometry(2.9*l2, 2*l), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( cambuttom5 );
      map.add(cambuttom5);
      cambuttom5.position.set(1.7*l2, -3.6*l, 0.1);

      cam5pickables.push(cambuttom5);
      document.addEventListener('mousedown', mapbuttom5, false);


  
    }



    function mapbuttom1(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(cam1pickables, false);
      if (intersects.length > 0) {
        camera2.position.y = 0;
        cameraauto = 0;
        sceneRTT.remove(camerabox);
        sceneRTT.remove(camerastick);

        CAM = 1;
        var l = 5/6;
        var l2 = 7.3/6;
        mapaction.position.set(5.95*l2, 2.5*l, 0.05);
        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerabox = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerabox );

        camerabox.add(camera2);
        camerabox.rotation.order ="YXZ"
        camerabox.rotation.y -= Math.PI/2;
        camerabox.rotation.x -= 0.5;
        


        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerastick = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerastick );

        camerastick.add(camerabox);

        monitors.play();
        camerastick.position.set(20,100,-680);

      }
      
      }


      function mapbuttom2(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(cam2pickables, false);
      if (intersects.length > 0) {
        camera2.position.y = 0;
        cameraauto = 0;
        sceneRTT.remove(camerabox);
        sceneRTT.remove(camerastick);
        
        CAM = 2;
        var l = 5/6;
        var l2 = 7.3/6;
        mapaction.position.set(-0.95*l2, 5.67*l, 0.05);
        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerabox = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerabox );

        camerabox.add(camera2);
        camerabox.rotation.order ="YXZ"
        camerabox.rotation.y -= 1;
        camerabox.rotation.x -= 0.5;
        


        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerastick = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerastick );

        camerastick.add(camerabox);

        monitors.play();
        camerastick.position.set(-320,100,-770);
      

      }
      
      }



      function mapbuttom3(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(cam3pickables, false);
      if (intersects.length > 0) {
        camera2.position.y = 0;
        cameraauto = 0;
        sceneRTT.remove(camerabox);
        sceneRTT.remove(camerastick);

        CAM = 3;
        var l = 5/6;
        var l2 = 7.3/6;
        mapaction.position.set(-6.25*l2 - 0.55, -4.45*l + 0.62, 0.05);
        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerabox = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerabox );

        camerabox.add(camera2);
        camerabox.rotation.order ="YXZ"
        camerabox.rotation.y += Math.PI/2;
        camerabox.rotation.x -= 0.7;
        


        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerastick = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerastick );

        camerastick.add(camerabox);

        monitors.play();
        camerastick.position.set(-370,100,-390);

      }
      
      }



      function mapbuttom4(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(cam4pickables, false);
      if (intersects.length > 0) {
        camera2.position.y = 0;
        cameraauto = 0;
        sceneRTT.remove(camerabox);
        sceneRTT.remove(camerastick);

        CAM = 4;
        var l = 5/6;
        var l2 = 7.3/6;
        mapaction.position.set(-9.9*l2, 1.55*l + 0.4, 0.05);
        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerabox = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerabox );

        camerabox.add(camera2);
        camerabox.rotation.order ="YXZ"
        camerabox.rotation.y += 1.2;
        camerabox.rotation.x -= 0.5;
        


        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerastick = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerastick );

        camerastick.add(camerabox);

        monitors.play();
        camerastick.position.set(-520,100,-610);

      }
      
      }



      function mapbuttom5(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(cam5pickables, false);
      if (intersects.length > 0) {
        camera2.position.y = 0;
        cameraauto = 0;
        sceneRTT.remove(camerabox);
        sceneRTT.remove(camerastick);

        CAM = 5;
        var l = 5/6;
        var l2 = 7.3/6;
        mapaction.position.set(1.7*l2, -3.6*l, 0.05);
        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerabox = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerabox );

        camerabox.add(camera2);
        camerabox.rotation.order ="YXZ"
        camerabox.rotation.y += 1.2;
        camerabox.rotation.x -= 0.5;
        


        var geometry = new THREE.BoxGeometry( 1, 1, 1 );
        var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
        camerastick = new THREE.Mesh( geometry, material );
        sceneRTT.add( camerastick );

        camerastick.add(camerabox);

        monitors.play();
        camerastick.position.set(-100,100,-370);

      }
      
      }

      function makeArm() {
      let loader = new THREE.TextureLoader();
      loader.crossOrigin = '';
      let matArray = [];
      matArray.push(new THREE.MeshLambertMaterial({
        map: loader.load('tex/arm1.png') // 1
      }));
      matArray.push(new THREE.MeshLambertMaterial({
        map: loader.load('tex/arm2.png') // 1
      }));
      matArray.push(new THREE.MeshLambertMaterial({
        map: loader.load('tex/arm3.png') // 1
      }));
      matArray.push(new THREE.MeshLambertMaterial({
        map: loader.load('tex/arm3.png') // 1
      }));
      matArray.push(new THREE.MeshLambertMaterial({
        map: loader.load('tex/arm3.png') // 1
      }));
      matArray.push(new THREE.MeshLambertMaterial({
        map: loader.load('tex/arm4.png') // 1
      }));



      var group = new THREE.Group();
      var body = new THREE.Mesh (new THREE.BoxGeometry(3.82*5, 1.24*5, 1.24*5), matArray);
      
      group.add (body);
      body.position.x = 3.82*5/2;
      //group.add (new THREE.AxesHelper (k));
      return group;


    }

    function canceled(){
      iscanceled = 0;
      startflag = 1;
    }

    function numflagev(){
      numflag = 0;
      numaction2.position.set(-1600, 0, 2.55);
    }

    function playerstate1timeout(){
        Progressnow = 0;
        progressclock = new THREE.Clock();
            var loader = new THREE.FontLoader();
            loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
              if(Math.floor(progressclock.getElapsedTime() * 10 / 36) < 10) var text = "    " + Math.floor(progressclock.getElapsedTime() * 10 / 36) + "%";
              else var text = '0%';
                var geometry = new THREE.TextGeometry(text, {
                  font: font,
                  size: 4,
                  height: 2.8,
                  curveSegments: 12
                });
                      

            var material = new THREE.MeshBasicMaterial({color: 0x3db851, side: THREE.DoubleSide});
            progresstext1 = new THREE.Mesh( geometry, material );
            scene.add( progresstext1 );
            progresstext1.position.set(-75, 49, -70);
            progresstext1.rotation.y += Math.PI/4;
            })

            loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){

            var text = '';   //14 is full
            var geometry = new THREE.TextGeometry(text, {
              font: font,
              size: 3.9,
              height: 2.8,
              curveSegments: 12
            });
                  

            var material = new THREE.MeshBasicMaterial({color: 0x3db851, side: THREE.DoubleSide});
            progresstext2 = new THREE.Mesh( geometry, material );
            scene.add( progresstext2 );
            progresstext2.position.set(-78.2, 43, -66.8);
            progresstext2.rotation.y += Math.PI/4;
            })


            loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){

            var text = '';   
            var geometry = new THREE.TextGeometry(text, {
              font: font,
              size: 3.9,
              height: 2.8,
              curveSegments: 12
            });
                  

            var material = new THREE.MeshBasicMaterial({color: 0xfc0303, side: THREE.DoubleSide});
            progresstext3 = new THREE.Mesh( geometry, material );
            scene.add( progresstext3 );
            progresstext3.position.set(-75, 37, -70);
            progresstext3.rotation.y += Math.PI/4;
            })



          progressline.position.z += 0.2;
          gamestart = 1;
      
        
    }

    function controlpressed(){
      if(standup == 0){
        camera.position.y -= 0.4;
        playerpositionbox.position.y -= 0.4;
        if(camera.position.y > 20) setTimeout(controlpressed,5);
        else controling = 0;
      }
      else if(standup == 1){
        camera.position.y += 0.4;
        playerpositionbox.position.y += 0.4;
        if(camera.position.y < 40) setTimeout(controlpressed,5);
        else controling = 0;
      }
    }


    function nineshit(){
      
      if(Islocal != 1) var texture = new THREE.TextureLoader().load('https://i.imgur.com/S1ilknr.png');
      else var texture = new THREE.TextureLoader().load('tex/black.png');

      var texMat = new THREE.MeshPhongMaterial({
        map: texture
      });


      var material = new THREE.MeshPhongMaterial({
        color: 0xffffff,
        side: THREE.DoubleSide
      });
      
      var geometry = new THREE.BoxGeometry(13.5, 18, 5 );
      var table = new THREE.Mesh(geometry, texMat);
      table.rotation.order = 'YXZ';
      table.position.set(-62, 26, -67);
      table.rotation.y = Math.PI/4 + 0.15;
      table.rotation.x = -Math.PI/4 + 0.1;
      scene.add(table);

      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xffe900, side: THREE.DoubleSide} );
      numaction = new THREE.Mesh( geometry, material );
      scene.add( numaction );
      table.add(numaction);
      numaction.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xffdc7a, side: THREE.DoubleSide} );
      numaction2 = new THREE.Mesh( geometry, material );
      scene.add( numaction2 );
      table.add(numaction2);
      numaction2.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action0 = new THREE.Mesh( geometry, material );
      scene.add( num30action0 );
      table.add(num30action0);
      num30action0.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action1 = new THREE.Mesh( geometry, material );
      scene.add( num30action1 );
      table.add(num30action1);
      num30action1.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action2 = new THREE.Mesh( geometry, material );
      scene.add( num30action2 );
      table.add(num30action2);
      num30action2.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action3 = new THREE.Mesh( geometry, material );
      scene.add( num30action3 );
      table.add(num30action3);
      num30action3.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action4 = new THREE.Mesh( geometry, material );
      scene.add( num30action4 );
      table.add(num30action4);
      num30action4.position.set(1005, 2.5, 0.1);



      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action5 = new THREE.Mesh( geometry, material );
      scene.add( num30action5 );
      table.add(num30action5);
      num30action5.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action6 = new THREE.Mesh( geometry, material );
      scene.add( num30action6 );
      table.add(num30action6);
      num30action6.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action7 = new THREE.Mesh( geometry, material );
      scene.add( num30action7 );
      table.add(num30action7);
      num30action7.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action8 = new THREE.Mesh( geometry, material );
      scene.add( num30action8 );
      table.add(num30action8);
      num30action8.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0x3aed2d, side: THREE.DoubleSide} );
      num30action9 = new THREE.Mesh( geometry, material );
      scene.add( num30action9 );
      table.add(num30action9);
      num30action9.position.set(1005, 2.5, 0.1);



      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction0 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction0 );
      table.add(num30erroraction0);
      num30erroraction0.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction1 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction1 );
      table.add(num30erroraction1);
      num30erroraction1.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction2 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction2 );
      table.add(num30erroraction2);
      num30erroraction2.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction3 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction3 );
      table.add(num30erroraction3);
      num30erroraction3.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction4 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction4 );
      table.add(num30erroraction4);
      num30erroraction4.position.set(1005, 2.5, 0.1);



      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction5 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction5 );
      table.add(num30erroraction5);
      num30erroraction5.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction6 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction6 );
      table.add(num30erroraction6);
      num30erroraction6.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction7 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction7 );
      table.add(num30erroraction7);
      num30erroraction7.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction8 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction8 );
      table.add(num30erroraction8);
      num30erroraction8.position.set(1005, 2.5, 0.1);


      var geometry = new THREE.PlaneGeometry(3.5, 3.5);
      var material = new THREE.MeshBasicMaterial( {color: 0xfc0303, side: THREE.DoubleSide} );
      num30erroraction9 = new THREE.Mesh( geometry, material );
      scene.add( num30erroraction9 );
      table.add(num30erroraction9);
      num30erroraction9.position.set(1005, 2.5, 0.1);

      



      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/1.png');

      var num1buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num1buttom );
      table.add(num1buttom);
      num1buttom.position.set(-4.5, -2.25, 2.6);

      num1pickables.push(num1buttom);
      document.addEventListener('mousedown', num1buttomev, false);


      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/2.png');

      var num2buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num2buttom );
      table.add(num2buttom);
      num2buttom.position.set(0, -2.25, 2.6);

      num2pickables.push(num2buttom);
      document.addEventListener('mousedown', num2buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/3.png');

      var num3buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num3buttom );
      table.add(num3buttom);
      num3buttom.position.set(4.5, -2.25, 2.6);

      num3pickables.push(num3buttom);
      document.addEventListener('mousedown', num3buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/4.png');

      var num4buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num4buttom );
      table.add(num4buttom);
      num4buttom.position.set(-4.5, 2.25, 2.6);

      num4pickables.push(num4buttom);
      document.addEventListener('mousedown', num4buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/5.png');

      var num5buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num5buttom );
      table.add(num5buttom);
      num5buttom.position.set(0, 2.25, 2.6);

      num5pickables.push(num5buttom);
      document.addEventListener('mousedown', num5buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/6.png');

      var num6buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num6buttom );
      table.add(num6buttom);
      num6buttom.position.set(4.5, 2.25, 2.6);

      num6pickables.push(num6buttom);
      document.addEventListener('mousedown', num6buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/7.png');

      var num7buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num7buttom );
      table.add(num7buttom);
      num7buttom.position.set(-4.5, 6.75, 2.6);

      num7pickables.push(num7buttom);
      document.addEventListener('mousedown', num7buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/8.png');

      var num8buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num8buttom );
      table.add(num8buttom);
      num8buttom.position.set(0, 6.75, 2.6);

      num8pickables.push(num8buttom);
      document.addEventListener('mousedown', num8buttomev, false);

      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/9.png');

      var num9buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num9buttom );
      table.add(num9buttom);
      num9buttom.position.set(4.5, 6.75, 2.6);

      num9pickables.push(num9buttom);
      document.addEventListener('mousedown', num9buttomev, false);


      if(Islocal != 1) var tex = new THREE.TextureLoader().load('https://i.imgur.com/beiOFVd.png');
      else var tex = new THREE.TextureLoader().load('tex/table01.png');
      if(Islocal != 1) var alpha = new THREE.TextureLoader().load('https://i.imgur.com/7t0jeMt.png')
      else var alpha = new THREE.TextureLoader().load('tex/0.png');

      var num0buttom = new THREE.Mesh(new THREE.PlaneGeometry(3.5, 3.5), new THREE.MeshBasicMaterial({
        map: tex,
        alphaMap:alpha,
        transparent: true,
        side: THREE.DoubleSide
      }));

      scene.add( num0buttom );
      table.add(num0buttom);
      num0buttom.position.set(0, -6.75, 2.6);

      num0pickables.push(num0buttom);
      document.addEventListener('mousedown', num0buttomev, false);





    }
/*
if(numflag == 1) numaction.position.set(-4.5, -2.25, 2.55);
          else if(numflag == 2) numaction.position.set(0, -2.25, 2.55);
          else if(numflag == 3) numaction.position.set(4.5, -2.25, 2.55);
          else if(numflag == 4) numaction.position.set(-4.5, 2.25, 2.55);
          else if(numflag == 5) numaction.position.set(0, 2.25, 2.55);
          else if(numflag == 6) numaction.position.set(4.5, 2.25, 2.55);
          else if(numflag == 7) numaction.position.set(-4.5, 6.75, 2.55);
          else if(numflag == 8) numaction.position.set(0, 6.75, 2.55);
          else if(numflag == 9) numaction.position.set(4.5, 6.75, 2.55);
          else if(numflag == 10) numaction.position.set(0, -6.75, 2.55);
        
*/

function errortext(){
  var loader = new THREE.FontLoader();
  loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
  var text = "ERROR"; 
            
  var geometry = new THREE.TextGeometry(text, {
    font: font,
    size: 3.9,
    height: 2.8,
    curveSegments: 12
  });
                  
  scene.remove(progresstext3);
  var material = new THREE.MeshBasicMaterial({color: 0xfc0303, side: THREE.DoubleSide});
  progresstext3 = new THREE.Mesh( geometry, material );
  scene.add( progresstext3 );
  progresstext3.position.set(-75, 37, -70);
  progresstext3.rotation.y += Math.PI/4;
  });
}


function errorev(){
  num30action0.position.set(1005, 2.5, 0.1);
  num30action1.position.set(1005, 2.5, 0.1);
  num30action2.position.set(1005, 2.5, 0.1);
  num30action3.position.set(1005, 2.5, 0.1);
  num30action4.position.set(1005, 2.5, 0.1);
  num30action5.position.set(1005, 2.5, 0.1);
  num30action6.position.set(1005, 2.5, 0.1);
  num30action7.position.set(1005, 2.5, 0.1);
  num30action8.position.set(1005, 2.5, 0.1);
  num30action9.position.set(1005, 2.5, 0.1);
  numcount = 0;
  num30erroraction1.position.set(-4.5, -2.25, 2.55);
  num30erroraction2.position.set(0, -2.25, 2.55);
  num30erroraction3.position.set(4.5, -2.25, 2.55);
  num30erroraction4.position.set(-4.5, 2.25, 2.55);
  num30erroraction5.position.set(0, 2.25, 2.55);
  num30erroraction6.position.set(4.5, 2.25, 2.55);
  num30erroraction7.position.set(-4.5, 6.75, 2.55);
  num30erroraction8.position.set(0, 6.75, 2.55);
  num30erroraction9.position.set(4.5, 6.75, 2.55);
  num30erroraction0.position.set(0, -6.75, 2.55);
  alert=1;
  error.play();
  setTimeout(errorevend,3000);
}

function errorevend(){
  num30erroraction0.position.set(1005, 2.5, 0.1);
  num30erroraction1.position.set(1005, 2.5, 0.1);
  num30erroraction2.position.set(1005, 2.5, 0.1);
  num30erroraction3.position.set(1005, 2.5, 0.1);
  num30erroraction4.position.set(1005, 2.5, 0.1);
  num30erroraction5.position.set(1005, 2.5, 0.1);
  num30erroraction6.position.set(1005, 2.5, 0.1);
  num30erroraction7.position.set(1005, 2.5, 0.1);
  num30erroraction8.position.set(1005, 2.5, 0.1);
  num30erroraction9.position.set(1005, 2.5, 0.1);
  numflag = 0;
  var loader = new THREE.FontLoader();
  loader.load('https://raw.githack.com/mrdoob/three.js/master/examples/fonts/droid/droid_sans_bold.typeface.json', function(font){
  var text = ""; 
            
  var geometry = new THREE.TextGeometry(text, {
    font: font,
    size: 3.9,
    height: 2.8,
    curveSegments: 12
  });
                  
  scene.remove(progresstext3);
  var material = new THREE.MeshBasicMaterial({color: 0xfc0303, side: THREE.DoubleSide});
  progresstext3 = new THREE.Mesh( geometry, material );
  scene.add( progresstext3 );
  progresstext3.position.set(-75, 37, -70);
  progresstext3.rotation.y += Math.PI/4;
  });
  progressclock.start();
}


    function num0buttomev(event) {
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

        // find intersections
        raycaster.setFromCamera(mouse, camera);
        var intersects = raycaster.intersectObjects(num0pickables, false);
        if (intersects.length > 0) {
          if(numflag == 10){
            progressclock.start();
            numflag = 0;
            numaction.position.set(-1600, 0, 2.55);
            button.play();
          }
          else if(numflag == 20){
            alert = 1;
            error.play();
          }
          else if(numflag == 30 && numstr[numcount] == 0){
            change.play();
            numcount++; 
            num30action0.position.set(0, -6.75, 2.55);
          }
          else if(numflag == 30){
            errortext();
            errorev();
          }

        }
        
        }


      function num1buttomev(event) {
        mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
        mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

        // find intersections
        raycaster.setFromCamera(mouse, camera);
        var intersects = raycaster.intersectObjects(num1pickables, false);
        if (intersects.length > 0) {
          if(numflag == 1){
            progressclock.start();
            numflag = 0;
            numaction.position.set(-1600, 0, 2.55);
            button.play();
          }
          else if(numflag == 11){
            alert = 1;
            error.play();
          }
          else if(numflag == 30 && numstr[numcount] == 1){
            numcount++;
            change.play();
            num30action1.position.set(-4.5, -2.25, 2.55);
          }
          else if(numflag == 30){
            errortext();
            errorev();
          }

        }
        
        }

      function num2buttomev(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(num2pickables, false);
      if (intersects.length > 0) {
        if(numflag == 2){
          progressclock.start();
          numflag = 0;
          numaction.position.set(-1600, 0, 2.55);
          button.play();
        }
        else if(numflag == 12){
          alert = 1;
          error.play();
        }
        else if(numflag == 30 && numstr[numcount] == 2){
            numcount ++;
            change.play();
            num30action2.position.set(0, -2.25, 2.55);
        }
        else if(numflag == 30){
          errortext();
            errorev();
        }

      }
      
      }

      function num3buttomev(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(num3pickables, false);
      if (intersects.length > 0) {
        if(numflag == 3){
          progressclock.start();
          numflag = 0;
          numaction.position.set(-1600, 0, 2.55);
          button.play();
        }
        else if(numflag == 13){
          alert = 1;
          error.play();
        }
        else if(numflag == 30 && numstr[numcount] == 3){
          numcount ++;
          change.play();
          num30action3.position.set(4.5, -2.25, 2.55);
        }
        else if(numflag == 30){
          errortext();
          errorev();
        }

      }
      
      }

      function num4buttomev(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(num4pickables, false);
      if (intersects.length > 0) {
        if(numflag == 4){
          progressclock.start();
          numflag = 0;
          numaction.position.set(-1600, 0, 2.55);
          button.play();
        }
        else if(numflag == 14){
          alert = 1;
          error.play();
        }
        else if(numflag == 30 && numstr[numcount] == 4){
          numcount ++;
          change.play();
          num30action4.position.set(-4.5, 2.25, 2.55);
        }
        else if(numflag == 30){
          errortext();
          errorev();
        }

      }
      
      }

      function num5buttomev(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(num5pickables, false);
      if (intersects.length > 0) {
        if(numflag == 5){
          progressclock.start();
          numflag = 0;
          numaction.position.set(-1600, 0, 2.55);
          button.play();
        }
        else if(numflag == 15){
          alert = 1;
          error.play();
        }
        else if(numflag == 30 && numstr[numcount] == 5){
          numcount ++;
          change.play();
          num30action5.position.set(0, 2.25, 2.55);
        }
        else if(numflag == 30){
          errortext();
          errorev();
        }

      }
      
      }

      function num6buttomev(event) {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

      // find intersections
      raycaster.setFromCamera(mouse, camera);
      var intersects = raycaster.intersectObjects(num6pickables, false);
      if (intersects.length > 0) {
        if(numflag == 6){
          progressclock.start();
          numflag = 0;
          numaction.position.set(-1600, 0, 2.55);
          button.play();
        }
        else if(numflag == 16){
          alert = 1;
          error.play();
        }
        else if(numflag == 30 && numstr[numcount] == 6){
          numcount ++;
          change.play();
          num30action6.position.set(4.5, 2.25, 2.55);
        }
        else if(numflag == 30){
          errortext();
          errorev();
        }

      }
      
      }

  function num7buttomev(event) {
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

  // find intersections
  raycaster.setFromCamera(mouse, camera);
  var intersects = raycaster.intersectObjects(num7pickables, false);
  if (intersects.length > 0) {
    if(numflag == 7){
      progressclock.start();
      numflag = 0;
      numaction.position.set(-1600, 0, 2.55);
      button.play();
    }
    else if(numflag == 17){
      alert = 1;
      error.play();
    }
    else if(numflag == 30 && numstr[numcount] == 7){
      numcount ++;
      change.play();
      num30action7.position.set(-4.5, 6.75, 2.55);
    }
    else if(numflag == 30){
      errortext();
      errorev();
    }

  }
  }
  function num8buttomev(event) {
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

  // find intersections
  raycaster.setFromCamera(mouse, camera);
  var intersects = raycaster.intersectObjects(num8pickables, false);
  if (intersects.length > 0) {
    if(numflag == 8){
      progressclock.start();
      numflag = 0;
      numaction.position.set(-1600, 0, 2.55);
      button.play();
    }
    else if(numflag == 18){
      alert = 1;
      error.play();
    }
    else if(numflag == 30 && numstr[numcount] == 8){
      numcount ++;
      change.play();
      num30action8.position.set(0, 6.75, 2.55);
    }
    else if(numflag == 30){
      errortext();
      errorev();
    }

  }
  
  }

  function num9buttomev(event) {
  mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
  mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;

  // find intersections
  raycaster.setFromCamera(mouse, camera);
  var intersects = raycaster.intersectObjects(num9pickables, false);
  if (intersects.length > 0) {
    if(numflag == 9){
      progressclock.start();
      numflag = 0;
      numaction.position.set(-1600, 0, 2.55);
      button.play();
    }
    else if(numflag == 19){
      alert = 1;
      error.play();
    }
    else if(numflag == 30 && numstr[numcount] == 9){
      numcount ++;
      change.play();
      num30action9.position.set(4.5, 6.75, 2.55);
    }
    else if(numflag == 30){
      errortext();
      errorev();
    }

  }
  
  }

  function makesteerbox(){
    var geometry = new THREE.CylinderGeometry( 40, 40, 25, 32 );
    var material = new THREE.MeshBasicMaterial( {color: 0xffffff} );
    ////////////////dinning
    ////num2
    obs[obsize++] = new Obstacle (new THREE.Vector3(-30, 0, -500), 50);
    obs[obsize++] = new Obstacle (new THREE.Vector3(-75, 0, -500), 50);
    obs[obsize++] = new Obstacle (new THREE.Vector3(-120, 0, -500), 50);

    ////num5
    obs[obsize++] = new Obstacle (new THREE.Vector3(-30, 0, -650), 50);
    obs[obsize++] = new Obstacle (new THREE.Vector3(-75, 0, -650), 50);
    obs[obsize++] = new Obstacle (new THREE.Vector3(-120, 0, -650), 50);


    ////num8
    obs[obsize++] = new Obstacle (new THREE.Vector3(-30, 0, -800), 50);
    obs[obsize++] = new Obstacle (new THREE.Vector3(-75, 0, -800), 50);
    obs[obsize++] = new Obstacle (new THREE.Vector3(-120, 0, -800), 50);


    ////num1
    obs[obsize++] = new Obstacle (new THREE.Vector3(-275, 0, -545), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(-275, 0, -500), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(-275, 0, -455), 50)


    ////num4
    obs[obsize++] = new Obstacle (new THREE.Vector3(-230, 0, -650), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(-275, 0, -650), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(-320, 0, -650), 50)


    ////num7
    obs[obsize++] = new Obstacle (new THREE.Vector3(-230, 0, -800), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(-275, 0, -800), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(-320, 0, -800), 50)


    ////num9
    obs[obsize++] = new Obstacle (new THREE.Vector3(170, 0, -800), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(125, 0, -800), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(80, 0, -800), 50)



    ////num6
    obs[obsize++] = new Obstacle (new THREE.Vector3(170, 0, -650), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(125, 0, -650), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(80, 0, -650), 50)

    ////num3
    obs[obsize++] = new Obstacle (new THREE.Vector3(125, 0, -545), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(125, 0, -500), 50)
    obs[obsize++] = new Obstacle (new THREE.Vector3(125, 0, -455), 50)



/*
    var geometry = new THREE.CylinderGeometry( 25, 25, 25, 32 );
    var material = new THREE.MeshBasicMaterial( {color: 0xffffff} );
    ///////////room to dinning
    var roomcircle1 = new THREE.Mesh( geometry, material );
    roomcircle1.position.set(100, 0, -350);
    scene.add(roomcircle1);
    var roomcircle2 = new THREE.Mesh( geometry, material );
    roomcircle2.position.set(100, 0, -320);
    scene.add(roomcircle2);
    var roomcircle3 = new THREE.Mesh( geometry, material );
    roomcircle3.position.set(100, 0, -290);
    scene.add(roomcircle3);
    var roomcircle4 = new THREE.Mesh( geometry, material );
    roomcircle4.position.set(100, 0, -260);
    scene.add(roomcircle4);
    var roomcircle5 = new THREE.Mesh( geometry, material );
    roomcircle5.position.set(100, 0, -230);
    scene.add(roomcircle5);
    var roomcircle6 = new THREE.Mesh( geometry, material );
    roomcircle6.position.set(100, 0, -200);
    scene.add(roomcircle6);


    var roomcircle7 = new THREE.Mesh( geometry, material );
    roomcircle7.position.set(-100, 0, -350);
    scene.add(roomcircle7);
    var roomcircle8 = new THREE.Mesh( geometry, material );
    roomcircle8.position.set(-100, 0, -320);
    scene.add(roomcircle8);
    var roomcircle9 = new THREE.Mesh( geometry, material );
    roomcircle9.position.set(-100, 0, -290);
    scene.add(roomcircle9);
    var roomcircle10 = new THREE.Mesh( geometry, material );
    roomcircle10.position.set(-100, 0, -260);
    scene.add(roomcircle10);
    var roomcircle11 = new THREE.Mesh( geometry, material );
    roomcircle11.position.set(-100, 0, -230);
    scene.add(roomcircle11);
    var roomcircle12 = new THREE.Mesh( geometry, material );
    roomcircle12.position.set(-100, 0, -200);
    scene.add(roomcircle12);

    */




  }



  function readModel (modelName, targetSize = 40, targetX, targetY, targetZ, rotationX, rotationY, rotationZ){
          var onProgress = function(xhr){
              if(xhr.lengthComputable){
                  var percentComplete = xhr.loaded / xhr.total * 100;
                  console.log(Math.round(percentComplete, 2) + '% downloaded');
              }
          };


          var onError = function () { };

          const manager = new THREE.LoadingManager();
          manager.addHandler( /\.dds$/i, new DDSLoader() );



          new MTLLoader( manager )
            .setPath('models/')
            .load( modelName+'.mtl',function(materials){
          materials.preload();
        
          new OBJLoader( manager )
            .setMaterials( materials )
            .setPath('models/')
            .load(modelName+'.obj',function(object){
              let theObject = unitize(object, targetSize);
              //theObject.name = 'OBJ'
              scene.add(theObject);
              //car.add(theObject);
              //Rcar.add(theObject);
              theObject.rotation.order = 'YXZ';
              theObject.position.set(targetX, targetY, targetZ);
              theObject.rotation.x += rotationX;
              theObject.rotation.y += rotationY;
              theObject.rotation.z += rotationZ;
        
            }, onProgress, onError);
        
          });


      }

      function RTTreadModel (modelName, targetSize = 40, targetX, targetY, targetZ, rotationX, rotationY, rotationZ){
          var onProgress = function(xhr){
              if(xhr.lengthComputable){
                  var percentComplete = xhr.loaded / xhr.total * 100;
                  console.log(Math.round(percentComplete, 2) + '% downloaded');
              }
          };


          var onError = function () { };

          const manager = new THREE.LoadingManager();
          manager.addHandler( /\.dds$/i, new DDSLoader() );



          new MTLLoader( manager )
            .setPath('models/')
            .load( modelName+'.mtl',function(materials){
          materials.preload();
        
          new OBJLoader( manager )
            .setMaterials( materials )
            .setPath('models/')
            .load(modelName+'.obj',function(object){
              let theObject = unitize(object, targetSize);
              //theObject.name = 'OBJ'
              sceneRTT.add(theObject);
              //car.add(theObject);
              //Rcar.add(theObject);
              theObject.position.set(targetX, targetY, targetZ);
              theObject.rotation.x += rotationX;
              theObject.rotation.y += rotationY;
              theObject.rotation.z += rotationZ;
        
            }, onProgress, onError);
        
          });


      }


      function unitize(object, targetSize){
          var box3 = new THREE.Box3();
          box3.setFromObject(object);
          var size = new THREE.Vector3();
          size.subVectors(box3.max, box3.min);
          var center = new THREE.Vector3();
          center.addVectors(box3.max, box3.min).multiplyScalar(0.5);

          var objSize = Math.max(size.x, size.y, size.z);
          var scaleSet = targetSize/objSize;

          var theObject = new THREE.Object3D();
          theObject.add(object);
          object.scale.set(scaleSet, scaleSet, scaleSet);
          object.position.set(-center.x*scaleSet, -center.y*scaleSet, -center.z*scaleSet);

          return theObject;
      }

          
      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      }
      
      function headlook(){
        camera.getWorldDirection(headvector);
        if(headvector.y > -0.3 && headflag == 0){
          camera.rotation.x += headvector.z*0.1;
          camera.rotation.z -= headvector.x*0.08;
          setTimeout(headlook,20);
        }

        if(headvector.y < -0.05 && headflag == 1){
          camera.rotation.x -= headvector.z*0.1;
          camera.rotation.z += headvector.x*0.08;
          setTimeout(headlook,20);
        }
        else if(headflag == 1){
          camera.lookAt(returndegree.x*1000,40,returndegree.z*1000);
        }
      }

</script>

  </body>

  </html>


    
    